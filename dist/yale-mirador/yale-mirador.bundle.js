window._YaleMiradorVersion="Yale-Mirador v0.8.2-0-g4492472 built Tue Nov 07 2017 14:59:34 GMT-0500 (EST)",function(t){function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var e={};n.m=t,n.c=e,n.i=function(t){return t},n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="/public/",n(n.s=54)}([function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}();n.default=function(){return i||(i=new a),i};var i=null,a=function(){function t(n){r(this,t),this.DEBUG=0,this.INFO=1,this.WARNING=2,this.ERROR=3,this._logLevel=n||this.INFO}return o(t,[{key:"setLogLevel",value:function(t){this._logLevel=t}},{key:"error",value:function(){for(var t,n=arguments.length,e=Array(n),r=0;r<n;r++)e[r]=arguments[r];(t=console).error.apply(t,["ERROR"].concat(e))}},{key:"warning",value:function(){if(this._logLevel<=this.WARNING){for(var t,n=arguments.length,e=Array(n),r=0;r<n;r++)e[r]=arguments[r];(t=console).warn.apply(t,["WARNING"].concat(e))}}},{key:"info",value:function(){if(this._logLevel<=this.INFO){for(var t,n=arguments.length,e=Array(n),r=0;r<n;r++)e[r]=arguments[r];(t=console).info.apply(t,["INFO"].concat(e))}}},{key:"debug",value:function(){if(this._logLevel<=this.DEBUG){for(var t,n=arguments.length,e=Array(n),r=0;r<n;r++)e[r]=arguments[r];(t=console).log.apply(t,["DEBUG"].concat(e))}}}]),t}()},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),e(50),e(51);var r=joosugi.AnnotationWrapper,o=joosugi.AnnotationExplorer,i=joosugiUI.AnnotationExplorerDialog,a=joosugi.AnnotationToc,u=joosugi.annotationUtil;n.Anno=r,n.AnnotationExplorer=o,n.AnnotationExplorerDialog=i,n.AnnotationToc=a,n.annoUtil=u},function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function o(t){try{var n=window[t],e="__storage_test__";return n.setItem(e,e),n.removeItem(e),!0}catch(t){return!1}}Object.defineProperty(n,"__esModule",{value:!0}),n.StateStore=void 0;var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}();n.default=function(){return c||(c=new s),c};var a=(0,function(t){return t&&t.__esModule?t:{default:t}}(e(0)).default)(),u=new Set(["annotationLayers","lastSelectedLayer","layerIndexMap","textDirection"]),s=n.StateStore=function(){function t(){r(this,t),this._settings={},this._state={},this._localStorageAvailable=o("localStorage")}return i(t,[{key:"init",value:function(t){this._settings=t}},{key:"getSetting",value:function(){for(var t=this._settings,n=arguments.length,e=Array(n),r=0;r<n;r++)e[r]=arguments[r];var o=!0,i=!1,a=void 0;try{for(var u,s=e[Symbol.iterator]();!(o=(u=s.next()).done);o=!0)if(void 0===(t=t[u.value]))return}catch(t){i=!0,a=t}finally{try{!o&&s.return&&s.return()}finally{if(i)throw a}}return t}},{key:"getTransient",value:function(t){return this._checkKey(t),this._settings[t]}},{key:"setTransient",value:function(t,n){this._checkKey(t),this._settings[t]=n}},{key:"getString",value:function(t){this._checkKey(t);var n=this._settings[t];return n||(n=this._localStorageAvailable?localStorage.getItem(t):null,this._settings[t]=n),n}},{key:"setString",value:function(t,n){this._checkKey(t),this._settings[t]=n,this._localStorageAvailable&&localStorage.setItem(t,n)}},{key:"getBoolean",value:function(t){return"true"===this.getString(t)}},{key:"setBoolean",value:function(t,n){this.setString(t,n?"true":"false")}},{key:"getObject",value:function(t){a.debug("StateStore#getObject",t),this._checkKey(t);var n=this.getString(t);return n?JSON.parse(n):null}},{key:"setObject",value:function(t,n){a.debug("StateStore#setObject",t,n),this._checkKey(t);var e=JSON.stringify(n);this.setString(t,e)}},{key:"_checkKey",value:function(t){if(!u.has(t))throw"ERROR Invalid key for StateStore "+t}}]),t}(),c=null},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function i(t){return f&&!t||(f=new l),f}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),u=r(e(0)),s=r(e(36)),c=r(e(5)),l=((0,u.default)(),function(){function t(){o(this,t),this._miradorProxiesMap={}}return a(t,[{key:"addMirador",value:function(t,n){var e=this._miradorProxiesMap[t];if(e)throw"MiradorProxyManager#addMirador duplicate ID "+t;return e=new s.default(n,t),this._miradorProxiesMap[t]=e,e}},{key:"getMiradorProxies",value:function(){return Object.values(this._miradorProxiesMap)}},{key:"getMiradorProxy",value:function(t){return this._miradorProxiesMap[t]||null}},{key:"getMiradorProxyByWindowId",value:function(t){var n=!0,e=!1,r=void 0;try{for(var o,i=Object.values(this._miradorProxiesMap)[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){var a=o.value;if(a.getWindowById(t))return a}}catch(t){e=!0,r=t}finally{try{!n&&i.return&&i.return()}finally{if(e)throw r}}return null}},{key:"getAllWindowProxies",value:function(){var t=[],n=!0,e=!1,r=void 0;try{for(var o,i=Object.values(this._miradorProxiesMap)[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){var a=o.value;t=t.concat(a.getWindowProxies())}}catch(t){e=!0,r=t}finally{try{!n&&i.return&&i.return()}finally{if(e)throw r}}return t}},{key:"getWindowProxyById",value:function(t){var n=this.getWindowById(t);return n?new c.default(n):null}},{key:"getWindowById",value:function(t){var n=null,e=!0,r=!1,o=void 0;try{for(var i,a=Object.values(this._miradorProxiesMap)[Symbol.iterator]();!(e=(i=a.next()).done);e=!0)if(n=i.value.getWindowById(t))return n}catch(t){r=!0,o=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw o}}return null}},{key:"getCurrentCanvasIdByWindowId",value:function(t){var n=this.getWindowProxyById(t);return n?n.getCurrentCanvasId():null}},{key:"anyId",value:function(){return Object.keys(this._miradorProxies)[0]}},{key:"subscribe",value:function(t,n){var e=!0,r=!1,o=void 0;try{for(var i,a=Object.values(this._miradorProxiesMap)[Symbol.iterator]();!(e=(i=a.next()).done);e=!0)i.value.subscribe(t,n)}catch(t){r=!0,o=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw o}}}}]),t}()),f=null;n.default=i,Mirador.getMiradorProxyManager=i},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t){return function(){var n=t.apply(this,arguments);return new Promise(function(t,e){function r(o,i){try{var a=n[o](i),u=a.value}catch(t){return void e(t)}if(!a.done)return Promise.resolve(u).then(function(t){r("next",t)},function(t){r("throw",t)});t(u)}return r("next")})}}function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.getApp=n.App=void 0;var a=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}();e(33);var u=e(1),s=r(e(8)),c=r(e(21)),l=(r(e(11)),r(e(12))),f=(r(e(22)),r(e(0))),d=r(e(9)),h=r(e(2)),v=r(e(34));e(52);var g=(0,f.default)(),p=null,y=null,m=null,_=n.App=function(){function t(){i(this,t),this._setupLogger(),this._state=(0,h.default)(),this.initHandlebars()}return a(t,[{key:"init",value:function(){var t=o(regeneratorRuntime.mark(function t(n){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return g.debug("App#init settings:",n),t.next=3,this.initState(n);case 3:return t.next=5,(0,l.default)();case 5:return this._preConfigureTinyMce(n.mirador.buildPath+"/"),this._setupAnnotationTocCache(),e=new v.default(n.ui.rootElementId),this._pageController=(0,d.default)(),this._pageController.init({grid:e,appSettings:n,appState:this._state}),t.abrupt("return",this);case 11:case"end":return t.stop()}},t,this)}));return function(n){return t.apply(this,arguments)}}()},{key:"initHandlebars",value:function(){Handlebars.registerHelper("t",function(t){return i18next.t(t)})}},{key:"initState",value:function(){var t=o(regeneratorRuntime.mark(function t(n){var e,r,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return g.debug("App#initState settings:",n),(e=this._state).init(n),r=this.getAnnotationExplorer(),t.next=6,r.getLayers();case 6:o=t.sent,e.setTransient("annotationLayers",o);case 8:case"end":return t.stop()}},t,this)}));return function(n){return t.apply(this,arguments)}}()},{key:"_setupLogger",value:function(){"#debug"===window.location.hash?g.setLogLevel(g.DEBUG):g.setLogLevel(g.INFO),u.annoUtil.setLogger(g)}},{key:"_preConfigureTinyMce",value:function(t){g.debug("App#preConfigureTinyMce buildPath:",t),tinymce.base=t+"/",tinymce.setup()}},{key:"_setupAnnotationTocCache",value:function(){var t=this._state.getSetting("annotations","tocSpec");this._annotationTocCache=t?new c.default({tocSpec:t,annotationExplorer:this.getAnnotationExplorer()}):null}},{key:"getAnnotationExplorer",value:function(){return y||(y=new u.AnnotationExplorer({dataSource:this.getAnnotationSource(),logger:g})),y}},{key:"getAnnotationSource",value:function(){if(!m){var t=this._state.getSetting("annotations","store");m=new s.default({prefix:t,state:this._state})}return m}},{key:"getAnnotationTocCache",value:function(){return this._annotationTocCache}}]),t}(),b=n.getApp=function(){return p||(p=new _),p};n.default=b},function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),i=((0,function(t){return t&&t.__esModule?t:{default:t}}(e(0)).default)(),function(){function t(n){r(this,t),this.window=n}return o(t,[{key:"getWindowId",value:function(){return this.window.id}},{key:"getManifest",value:function(){return this.window.manifest}},{key:"getCurrentCanvasId",value:function(){return this.window.canvasID}},{key:"getCurrentCanvas",value:function(){var t=this.getCanvases(),n=this.getCurrentCanvasId();return t.filter(function(t){return t["@id"]===n})[0]}},{key:"setCurrentCanvasId",value:function(t,n){this.window.setCurrentCanvasID(t,n)}},{key:"getImageView",value:function(){return this.window.focusModules.ImageView}},{key:"getEndPoint",value:function(){return this.window.endpoint}},{key:"getCanvases",value:function(){return this.window.manifest.getCanvases()}},{key:"getAnnotationsList",value:function(){return this.window.annotationsList}},{key:"getSvgOverlay",value:function(){var t=this.getDrawTool();return t?t.svgOverlay:null}},{key:"getDrawTool",value:function(){var t=this.getImageView();return t?t.annotationsLayer.drawTool:null}},{key:"getSidePanel",value:function(){return this.window.sidePanel}},{key:"getSidePanelTabContentElement",value:function(t){return this.getSidePanel().element.find(".tabContentArea > ."+t)}}]),t}());n.default=i},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={serverSettings:null,loggedIn:function(){return"true"==Cookies.get("loggedIn")},isEditor:function(){return"true"==Cookies.get("isEditor")}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(t){return t&&t.__esModule?t:{default:t}}(e(0));n.default={isMobileOrTablet:function(){return function(t){return!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))}(navigator.userAgent||navigator.vendor||window.opera)},getValues:function(t){var n=[];return jQuery.each(t,function(t,e){n.push(e)}),n},waitUntil:function(t,n,e,r){var o=this;if(void 0===e&&(e=100),void 0===r&&(r=1),r>5)return this.logger.debug("util.waitUntil max try num exceeded: giving up"),this.logger.debug("testFunc: "+t),void this.logger.debug("execFunc: "+n);t()?n():(this.logger.debug("util.waitUntil trial "+r+" failed. Retrying in "+2*e+" ms."),setTimeout(function(){o.waitUntil(t,n,2*e,r+1)},e))},directionClasses:["horizontal-lr","horizontal-rl","vertical-lr","vertical-rl"],setTextDirectionClass:function(t,n){this.directionClasses.includes(n)||((0,r.default)().debug("util.setTextDriectionClass no class provided, using horizontal-lr"),n="horizontal-lr");var e=!0,o=!1,i=void 0;try{for(var a,u=this.directionClasses[Symbol.iterator]();!(e=(a=u.next()).done);e=!0){var s=a.value;s===n?t.addClass(s):t.removeClass(s)}}catch(t){o=!0,i=t}finally{try{!e&&u.return&&u.return()}finally{if(o)throw i}}}}},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t){return function(){var n=t.apply(this,arguments);return new Promise(function(t,e){function r(o,i){try{var a=n[o](i),u=a.value}catch(t){return void e(t)}if(!a.done)return Promise.resolve(u).then(function(t){r("next",t)},function(t){r("throw",t)});t(u)}return r("next")})}}function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),u=(e(1),r(e(12))),s=r(e(4)),c=e(13),l=r(e(0)),f=r(e(10)),d=(r(e(9)),r(e(2)),(0,l.default)()),h=function(t){t.setRequestHeader("Authorization","Bearer "+Cookies.get("jwtToken"))},v=function(){function t(n){i(this,t),this._prefix=n.prefix,this._state=n.state,this._layers=null}return a(t,[{key:"getLayers",value:function(){var t=o(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(d.debug("AnnotationSource#getLayers"),n=null,!this._layers){t.next=7;break}d.debug("AnnotationSource#getLayers hit cache",this._layers),n=this._layers,t.next=11;break;case 7:return t.next=9,this._getRemoteLayers();case 9:n=t.sent,this._updateLayerIndex(n);case 11:return t.abrupt("return",n);case 12:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"_getRemoteLayers",value:function(){var t=this;return new Promise(function(n,e){var r=t._state.getSetting("auth","groupId"),o=t._prefix+"/layers";r&&(o+="?group_id="+r),d.debug("AnnotationSource#_getRemoteLayers url:",o),jQuery.ajax({url:o,type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",beforeSend:h,success:function(e,r,o){d.debug("AnnotationSource#getLayers layers: ",e),t._layers=e,n(e)},error:function(t,n,r){var i="AnnotationSource#getLayers error status code: "+t.status+", textStatus: "+n+", errorThrown: "+r+", URL: "+o;d.error(i),e(i)}})})}},{key:"_updateLayerIndex",value:function(t){if(d.debug("AnnotationSource#_updateLayerIndex"),!this._state.getTransient("layerIndexMap")){var n={},e=0;t.forEach(function(t){n[t["@id"]]=e,++e}),this._state.setTransient("layerIndexMap",e>0?n:null)}return t}},{key:"getAnnotations",value:function(){var t=o(regeneratorRuntime.mark(function t(n){var e,r,o,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.canvasId,r=n.layerId,t.next=4,(0,u.default)();case 4:return o=t.sent,i=null,t.next=8,(0,f.default)().show("Retrieving annotations...");case 8:if(!o){t.next=13;break}return t.next=11,o.getAnnotationsPerCanvas(e);case 11:i=t.sent,d.debug("AnnotationSource#getAnnotations from cache:",i);case 13:if(i){t.next=20;break}return t.next=16,this._getRemoteAnnotations(e);case 16:if(i=t.sent,!o){t.next=20;break}return t.next=20,o.setAnnotationsPerCanvas(e,i);case 20:return this._attachEndpoint(i),r&&(i=i.filter(function(t){return t.layerId===r})),(0,f.default)().hide(),t.abrupt("return",i);case 24:case"end":return t.stop()}},t,this)}));return function(n){return t.apply(this,arguments)}}()},{key:"_attachEndpoint",value:function(t){d.debug("AnnotationSource#_attachEndpoint annotations:",t);var n=(0,c.getEndpoint)(),e=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(e=(i=a.next()).done);e=!0)i.value.endpoint=n}catch(t){r=!0,o=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw o}}}},{key:"_detachEndpoint",value:function(t){d.debug("AnnotationSource#_detachEndpoint annotations:",t);var n=!0,e=!1,r=void 0;try{for(var o,i=t[Symbol.iterator]();!(n=(o=i.next()).done);n=!0)delete o.value.endpoint}catch(t){e=!0,r=t}finally{try{!n&&i.return&&i.return()}finally{if(e)throw r}}}},{key:"_getRemoteAnnotations",value:function(t){var n=this;return d.debug("AnnotationSource#_getRemoteAnnotations canvas: "+t),new Promise(function(e,r){var o=n._prefix+"/getAnnotationsViaList?canvas_id="+encodeURIComponent(t);d.debug("AnnotationSource#_getRemoteAnnotations url: ",o);jQuery.ajax({url:o,type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",beforeSend:h,success:function(r,o,i){d.debug("AnnotationSource#_getRemoteAnnotations data: ",r);try{var a=[],u=!0,s=!1,c=void 0;try{for(var l,f=r[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var h=l.value,v=h.annotation;v.layerId=h.layer_id,a.push(n._toMiradorAnnotation(v))}}catch(t){s=!0,c=t}finally{try{!u&&f.return&&f.return()}finally{if(s)throw c}}e(a)}catch(n){d.error("AnnotationSource#_getRemoteAnnotations error parsing data for canvas",t,"data:",r,"error:",n),e([])}},error:function(t,n,e){r("AnnotationSource#getAnnotations failed to get annotations from "+o)}})})}},{key:"createAnnotation",value:function(){var t=o(regeneratorRuntime.mark(function t(n){var e,r,i,a,l,f=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return d.debug("AnnotationSource#createAnnotation oaAnnotation:",n),t.next=3,(0,u.default)();case 3:return e=t.sent,r=n.layerId,i=this._toBackendAnnotation(n),a=this._prefix+"/annotations",l={layer_id:r,annotation:i},d.debug("AnnotationSource#createAnnotation payload:",l),t.abrupt("return",new Promise(function(t,n){jQuery.ajax({url:a,type:"POST",dataType:"json",data:JSON.stringify(l),contentType:"application/json; charset=utf-8",beforeSend:h,success:function(){var n=o(regeneratorRuntime.mark(function n(o){var i,a,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(d.debug("AnnotationSource#createAnnotation creation successful on the annotation server:",o),i=o,a=f._toMiradorAnnotation(i),a.layerId=r,a.endpoint=(0,c.getEndpoint)(),!e){n.next=8;break}return n.next=8,e.invalidateAllCanvases();case 8:(u=(0,s.default)().getAnnotationTocCache())&&u.invalidate(),t(a);case 11:case"end":return n.stop()}},n,f)}));return function(t){return n.apply(this,arguments)}}(),error:function(t,e,r){var o="Failed to create annotation: "+e+" "+t.status+" "+r;d.error(o),n(o)}})}));case 10:case"end":return t.stop()}},t,this)}));return function(n){return t.apply(this,arguments)}}()},{key:"updateAnnotation",value:function(){var t=o(regeneratorRuntime.mark(function t(n){var e,r,i,a,l=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,u.default)();case 2:return e=t.sent,r=this._toBackendAnnotation(n),i=this._prefix+"/annotations",a={layer_id:[n.layerId],annotation:r},d.debug("AnnotationSource#updateAnnotation payload:",a),t.abrupt("return",new Promise(function(t,r){jQuery.ajax({url:i,type:"PUT",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(a),beforeSend:h,success:function(){var r=o(regeneratorRuntime.mark(function r(o,i,a){var u,f;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(d.debug("AnnotationSource#updateAnnotation successful",o),u=l._toMiradorAnnotation(o),u.layerId=n.layerId,u.endpoint=(0,c.getEndpoint)(),!e){r.next=7;break}return r.next=7,e.invalidateAllCanvases();case 7:(f=(0,s.default)().getAnnotationTocCache())&&f.invalidate(),t(u);case 10:case"end":return r.stop()}},r,l)}));return function(t,n,e){return r.apply(this,arguments)}}(),error:function(t,n,e){var o="Failed to update annotation: "+n+" "+t.status+" "+e;r(o)}})}));case 8:case"end":return t.stop()}},t,this)}));return function(n){return t.apply(this,arguments)}}()},{key:"deleteAnnotation",value:function(){var t=o(regeneratorRuntime.mark(function t(n){var e,r,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return d.debug("AnnotationSource#deleteAnnotations annotationId:",n),t.next=3,(0,u.default)();case 3:return e=t.sent,r=this._prefix+"/"+n.replace(/^https?:\/\/.*?(\/.*)$/,"$1"),t.abrupt("return",new Promise(function(t,a){jQuery.ajax({url:r,type:"DELETE",dataType:"json",contentType:"application/json; charset=utf-8",beforeSend:h,success:function(){var n=o(regeneratorRuntime.mark(function n(r,o,a){var u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(d.debug("AnnotationSource#deleteAnnotation success data:",r),!e){n.next=4;break}return n.next=4,e.invalidateAllCanvases();case 4:(u=(0,s.default)().getAnnotationTocCache())&&u.invalidate(),t();case 7:case"end":return n.stop()}},n,i)}));return function(t,e,r){return n.apply(this,arguments)}}(),error:function(t,e,r){a("AnnotationSource#deleteAnnotation failed for annotationId: "+n)}})}));case 6:case"end":return t.stop()}},t,this)}));return function(n){return t.apply(this,arguments)}}()},{key:"updateAnnotationListOrder",value:function(){var t=o(regeneratorRuntime.mark(function t(n,e,r){var i,a,c,l=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,u.default)();case 2:return i=t.sent,a=this._prefix+"/resequenceList",c={canvas_id:n,layer_id:e,annotation_ids:r},t.abrupt("return",new Promise(function(t,n){jQuery.ajax({url:a,type:"PUT",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(c),beforeSend:h,success:function(){var n=o(regeneratorRuntime.mark(function n(e,r,o){var a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(d.debug("AnnotationSource#updateAnnotationListOrder successful",e),!i){n.next=4;break}return n.next=4,i.invalidateAllCanvases();case 4:(a=(0,s.default)().getAnnotationTocCache())&&a.invalidate(),t(e);case 7:case"end":return n.stop()}},n,l)}));return function(t,e,r){return n.apply(this,arguments)}}(),error:function(t,e,r){var o="AnnotationSource#updateAnnotation failed: "+e+" "+t.status+" "+r;d.error(o),n(o)}})}));case 6:case"end":return t.stop()}},t,this)}));return function(n,e,r){return t.apply(this,arguments)}}()},{key:"_toMiradorAnnotation",value:function(t){var n=jQuery.extend(!0,{},t),e=n.on;return e&&e.selector&&"oa:Choice"===e.selector["@type"]&&(e=[e]),n.on=e,n}},{key:"_toBackendAnnotation",value:function(t){delete t.endpoint,delete t.target,delete t.targetedBy;var n=jQuery.extend(!0,{},t),e=n.on;return e instanceof Array&&(1!==e.length&&d.error("AnnotationSource#__toBackendAnnotation unexpected target length",e.length),e=e[0]),n.target=e,n}}]),t}();n.default=v},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t){return function(){var n=t.apply(this,arguments);return new Promise(function(t,e){function r(o,i){try{var a=n[o](i),u=a.value}catch(t){return void e(t)}if(!a.done)return Promise.resolve(u).then(function(t){r("next",t)},function(t){r("throw",t)});t(u)}return r("next")})}}function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}();n.default=function(){return h||(h=new g),h};var u=e(1),s=r(e(4)),c=r(e(0)),l=(r(e(3)),r(e(35))),f=r(e(38)),d=r(e(6)),h=null,v=(0,c.default)(),g=function(){function t(){i(this,t)}return a(t,[{key:"init",value:function(t){v.debug("PageController#init options:",t),this._grid=t.grid,this._settings=t.appSettings,this._state=t.appState;var n=jQuery.extend(this._settings,{miradorId:Mirador.genUUID(),defaultSettings:Mirador.DEFAULT_SETTINGS,isEditor:d.default.isEditor()});this._miradorWrapper=this._createMirador(n),this._miradorProxy=this._miradorWrapper.getMiradorProxy(),this._miradorId=this._miradorProxy.getId(),this._tocSpec=this._state.getSetting("annotations","tocSpec"),this._annotationTocCache=(0,s.default)().getAnnotationTocCache(),this._annotationExplorer=(0,s.default)().getAnnotationExplorer(),this._bindEvents(n)}},{key:"getConfig",value:function(){return this.miradorWrapper.getConfig()}},{key:"_createMirador",value:function(t){try{return this._grid.addMiradorWindow(t.miradorId),new f.default({grid:this._grid,miradorOptions:t})}catch(t){var n="PageController#_createMirador "+t;throw v.error(n),n}}},{key:"_showAnnotation",value:function(){var t=o(regeneratorRuntime.mark(function t(n,e){var r,o,i,a,s,c,l,f,d;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return v.debug("PageController#showAnnotation windowId:",n,"annoId:"+e,"defaultLayer:",this._tocSpec?this._tocSpec.defaultLayer:null),r=this._grid,o=this._miradorProxy.getWindowProxyById(n),i=o.getCurrentCanvasId(),t.next=6,this._annotationExplorer.getAnnotations({canvasId:i});case 6:if(a=t.sent,s=a.filter(function(t){return t["@id"]===e})[0],c=s.layerId,!this._tocSpec||!this._tocSpec.defaultLayer){t.next=15;break}return t.next=12,this._getAnnotationByTagsAndLayer((0,u.Anno)(s).tags,this._tocSpec.defaultLayer,i);case 12:l=t.sent,c=this._tocSpec.defaultLayer,l?s=l:v.warning("PageController#_showAnnotation no annotation found for layer",c);case 15:if(f=r.getAnnotationWindowByLayer(c)){t.next=24;break}if(!s){t.next=23;break}return t.next=20,r.addAnnotationWindow({miradorId:this._miradorId,imageWindowId:n,layerId:c,annotationId:s["@id"]}).catch(function(t){v.error("PageController#_showAnnotation addAnnotationWindow failed <- "+t)});case 20:d=t.sent,t.next=24;break;case 23:v.error("PageController#_showAnnotation annotation not found in annotation window, annoId: "+s["@id"]);case 24:case"end":return t.stop()}},t,this)}));return function(n,e){return t.apply(this,arguments)}}()},{key:"_getAnnotationByTagsAndLayer",value:function(){var t=o(regeneratorRuntime.mark(function t(n,e,r){var o,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._annotationTocCache.getToc(r);case 2:if(o=t.sent,i=o.getNodeFromTags(n)){t.next=7;break}return v.warning("PageController#_getAnnotationByTagsAndLayer tocNode not found for tags",n),t.abrupt("return",null);case 7:return a=u.annoUtil.findAllAnnotationsForTocNode(i).filter(function(t){return t.layerId===e}),t.abrupt("return",a[0]);case 9:case"end":return t.stop()}},t,this)}));return function(n,e,r){return t.apply(this,arguments)}}()},{key:"_createAnnotationWindows",value:function(t,n){var e=(0,s.default)().getAnnotationExplorer().getAnnotationToc(),r=new l.default({miradorId:n.miradorId,imageWindowId:t,layerIds:n.layerIds,toc:e,tocTags:n.tocTags,annotationId:n.annotationId}).getWindowsConfig();v.debug("PageController#_createAnnotationWindows windowsConfig:",r),r&&(this._miradorProxy.publish("YM_DISPLAY_ON"),jQuery.publish("YM_ADD_WINDOWS",r))}},{key:"_processUrlOptions",value:function(t,n){var e=this;if(v.debug("PageController#_processUrlOptions imageWindowId:",t,"options:",n,"_urlOptionsProcessed:",this._urlOptionsProcessed),!this._urlOptionsProcessed){this._urlOptionsProcessed=!0;var r=this._state.getSetting("initialLayout","windows")[0],o=r?r.annotation:null;if((this._state.getSetting("mirador","annotationsOverlay","showByDefault")||o)&&this._miradorProxy.publish("YM_DISPLAY_ON"),o){var i=function r(o){v.debug("PageController#_processUrlOptions annotationsRendered"),e._zoomToAnnotation(n.annotationId,t),e._miradorProxy.unsubscribe("annotationsRendered."+t,r)};n.annotationId=o,this._miradorProxy.subscribe("annotationsRendered."+t,i)}this._createAnnotationWindows(t,n)}}},{key:"_findCanvasAnnotationsFromTargets",value:function(t,n,e){v.debug("PageController#_findCanvasAnnotationsFromTargets sourceAnnotation:",t,"allAnnotations:",n,"canvasId:",e);var r={},o=!0,i=!1,a=void 0;try{for(var s,c=n[Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var l=s.value;r[l["@id"]]=l}}catch(t){i=!0,a=t}finally{try{!o&&c.return&&c.return()}finally{if(i)throw a}}return u.annoUtil.findTransitiveTargetAnnotations(t,r).filter(function(t){var n=!0,r=!1,o=void 0;try{for(var i,a=(0,u.Anno)(t).targets[Symbol.iterator]();!(n=(i=a.next()).done);n=!0)if(i.value.full===e)return!0}catch(t){r=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}})}},{key:"_zoomToAnnotation",value:function(t,n){var e=this._miradorProxy.getWindowProxyById(n),r=e.getImageView(),o=e.getCurrentCanvasId(),i=e.getAnnotationsList(),a=i.filter(function(n){return n["@id"]===t});(a=this._findCanvasAnnotationsFromTargets(a[0],i,o)).length>0?(a.length>1&&v.error("PageController#_zoomToAnnotation",a.length,"duplicate annos:",a,"imageWindowId:",n),v.debug("PageController#_zoomToAnnotation canvas annos:",a),r.zoomToAnnotation(a[0]),r.panToAnnotation(a[0]),r.annotationsLayer.drawTool.updateHighlights(a[0])):v.error("PageController#_zoomToAnnotation annotation not found: annotationId:",t,"imageWindowId:",n)}},{key:"_bindEvents",value:function(t){var n=this;v.debug("PageController#_bindEvents options:",t);var e=this;jQuery(window).resize(function(){e._grid.resize()}),this._miradorProxy.subscribe("ANNOTATIONS_LIST_UPDATED",function(e,r){v.debug("PageController:SUB:ANNOTATIONS_LIST_UPDATED params:",r),n._miradorProxy.shouldIgnoreEvent("ANNOTATIONS_LIST_UPDATED")?n._miradorProxy.unmarkEventToBeIgnored("ANNOTATIONS_LIST_UPDATED"):n._processUrlOptions(r.windowId,t)}),this._miradorProxy.subscribe("YM_IMAGE_WINDOW_TOOLTIP_ANNO_CLICKED",function(){var t=o(regeneratorRuntime.mark(function t(e,r,o){var i,a,u,s,c,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(v.debug("PageController:SUB:YM_IMAGE_WINDOW_TOOLTIP_ANNO_CLICKED windowId: "+r+", annoId: "+o),i=n._miradorProxy.getWindowProxyById(r),a=i.getCurrentCanvasId(),u=i.getSidePanelTabContentElement("ym-annotation-toc"),s=u.data("AnnotationTableOfContent"),n._showAnnotation(r,o),!s){t.next=12;break}return t.next=9,n._annotationTocCache.getToc(a);case 9:c=t.sent,(l=c.annotations.filter(function(t){return t["@id"]===o})[0])&&s.scrollToTags(l.tocTags);case 12:case"end":return t.stop()}},t,n)}));return function(n,e,r){return t.apply(this,arguments)}}()),jQuery.subscribe("ANNOWIN_ANNOTATION_FOCUSED",function(t,e){v.debug("PageController has received event ANNOWIN_ANNOTATION_FOCUSED with options",e);var r=n._miradorProxy.getWindowProxyById(e.imageWindowId),o=r.getCurrentCanvasId(),i=r.getImageView(),a=r.getAnnotationsList(),s={};if(e.canvasId===r.getCurrentCanvasId()){var c=!0,l=!1,f=void 0;try{for(var d,h=a[Symbol.iterator]();!(c=(d=h.next()).done);c=!0){var g=d.value;s[g["@id"]]=g}}catch(t){l=!0,f=t}finally{try{!c&&h.return&&h.return()}finally{if(l)throw f}}var p=e.annotation;u.annoUtil.hasTargetOnCanvas(p)||(p=n._findCanvasAnnotationsFromTargets(p,a,o)[0]),p?(i.zoomToAnnotation(p),i.panToAnnotation(p),i.annotationsLayer.drawTool.updateHighlights(p)):v.error("PageController:SUB:ANNOWIN_ANNOTATION_FOCUSED annotation not found",e.annotation)}else i._annotationToBeFocused=e.annotation,r.setCurrentCanvasId(e.canvasId)}),jQuery.subscribe("YM_ANNOTATION_TOC_TAGS_SELECTED",function(){var t=o(regeneratorRuntime.mark(function t(e,r,o,i){var a,u,s,c,l,f,d,h,g,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return v.debug("PageController:SUB:YM_ANNOTATION_TOC_TAGS_SELECTED imageWindow:",r,"canvasId:",o,"tags:",i),a=n._grid,u=n._tocSpec.defaultLayer,s=a.getAnnotationWindowByLayer(u),t.prev=4,n._miradorProxy.publish("YM_DISPLAY_ON"),t.next=8,new Promise(function(t,n){setTimeout(function(){t()},0)});case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(4),v.error("PageController#SUB:YM_ANNOTATION_TOC_TAGS_SELECTED failed to enable annotation layer");case 13:for(c=n._grid.getAnnotationWindows(),l=!0,f=!1,d=void 0,t.prev=17,h=Object.values(c)[Symbol.iterator]();!(l=(g=h.next()).done);l=!0)(p=g.value).ignoreEvent("ANNOTATIONS_LIST_UPDATED",35e3);t.next=25;break;case 21:t.prev=21,t.t1=t.catch(17),f=!0,d=t.t1;case 25:t.prev=25,t.prev=26,!l&&h.return&&h.return();case 28:if(t.prev=28,!f){t.next=31;break}throw d;case 31:return t.finish(28);case 32:return t.finish(25);case 33:return t.next=35,n._miradorWrapper.zoomToTags(r,o,i).catch(function(t){v.error("PageController:SUB:YM_ANNOTATION_TOC_TAGS_SELECTED zoomToTags failed:",t)});case 35:if(s){t.next=39;break}return t.next=38,a.addAnnotationWindow({miradorId:n._miradorId,imageWindowId:r,layerId:u,tocTags:i}).catch(function(t){v.error("PageController#_showAnnotation addAnnotationWindow failed <- "+t)});case 38:s=t.sent;case 39:case"end":return t.stop()}},t,n,[[4,10],[17,21,25,33],[26,,28,32]])}));return function(n,e,r,o){return t.apply(this,arguments)}}())}}]),t}()},function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}();n.default=function(){return a||(a=new i),a};var i=function(){function t(){r(this,t),this.dimmer=this.addDimmer(),this.panel=this.addPanel()}return o(t,[{key:"addDimmer",value:function(){return jQuery("<div/>").addClass("ym-dimmer").appendTo(jQuery("body"))}},{key:"addPanel",value:function(){return jQuery("<div/>").attr("id","ym-modal-alert").addClass("ym-message-panel").appendTo(jQuery("body"))}},{key:"show",value:function(t){return this.dimmer.show(),this.panel.text(t),this.panel.show(),new Promise(function(t,n){setTimeout(function(){t()},50)})}},{key:"hide",value:function(){this.panel.hide(),this.dimmer.hide()}}]),t}(),a=null},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){console.error("ERROR:",t);var n=jQuery(r());if("FATAL"===t)throw t;for(var e=arguments.length,o=Array(e>1?e-1:0),i=1;i<e;i++)o[i-1]=arguments[i];o.push(t);var a=!0,u=!1,s=void 0;try{for(var c,l=o[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var f=c.value;n.append(jQuery("<p>"+f+"</p>"))}}catch(t){u=!0,s=t}finally{try{!a&&l.return&&l.return()}finally{if(u)throw s}}throw jQuery(document.body).empty().append(n),"FATAL"};var r=Handlebars.compile(['<div class="fatal_error">','  <div class="header">Error</div>',"</div>"].join(""))},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t){return function(){var n=t.apply(this,arguments);return new Promise(function(t,e){function r(o,i){try{var a=n[o](i),u=a.value}catch(t){return void e(t)}if(!a.done)return Promise.resolve(u).then(function(t){r("next",t)},function(t){r("throw",t)});t(u)}return r("next")})}}function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}();n.default=function(){return f?Promise.resolve(f):(f=new d).init()};e(1);var u=r(e(20)),s=r(e(19)),c=r(e(0)),l=(r(e(3)),(0,c.default)()),f=null,d=function(){function t(){i(this,t),this._dbCache=new u.default,this._memCache=new s.default,this._valid=!1,this._inMemoryCache={}}return a(t,[{key:"init",value:function(){var t=o(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._dbCache.isValid()){t.next=5;break}return t.next=3,this._dbCache.deleteDb();case 3:return t.next=5,this._dbCache.init();case 5:return t.abrupt("return",this);case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"getAnnotationsPerCanvas",value:function(){var t=o(regeneratorRuntime.mark(function t(n){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(l.debug("AnnotationCache#getAnnotationsPerCanvas",n),null===(e=this._memCache.getAnnotationsPerCanvas(n))){t.next=7;break}return l.debug("mem cache hit",n,e),t.abrupt("return",Promise.resolve(e));case 7:if(!this._dbCache.isValid()){t.next=15;break}return t.next=10,this._dbCache.getAnnotationsPerCanvas(n);case 10:return null!==(e=t.sent)&&(l.debug("db cache hit",n,e),this._memCache.setAnnotationsPerCanvas(n,e)),t.abrupt("return",Promise.resolve(e));case 15:return t.abrupt("return",Promise.resolve(null));case 16:case"end":return t.stop()}},t,this)}));return function(n){return t.apply(this,arguments)}}()},{key:"setAnnotationsPerCanvas",value:function(t,n){return l.debug("AnnotationCache#setAnnotationsPerCanvas canvas:",t,"data:",n),this._memCache.setAnnotationsPerCanvas(t,n),this._dbCache.isValid()?this._dbCache.setAnnotationsPerCanvas(t,n):Promise.resolve()}},{key:"invalidateAllCanvases",value:function(){if(l.debug("AnnotationCache#invalidateAllCanvases"),this._memCache.invalidateAllCanvases(),this._dbCache.isValid())return this._dbCache.invalidateAllCanvases()}},{key:"invalidateCanvasId",value:function(t){if(l.debug("AnnotationCache#invalidateCanvasId canvasId:",t),this._memCache.invalidateCanvasId(t),this._dbCache.isValid())return this._dbCache.invalidateCanvasId(t)}}]),t}()},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t){return function(){var n=t.apply(this,arguments);return new Promise(function(t,e){function r(o,i){try{var a=n[o](i),u=a.value}catch(t){return void e(t)}if(!a.done)return Promise.resolve(u).then(function(t){r("next",t)},function(t){r("throw",t)});t(u)}return r("next")})}}function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.getEndpoint=n.YaleEndpoint=void 0;var a=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),u=(r(e(8)),r(e(4))),s=r(e(48)),c=r(e(0)),l=(r(e(3)),r(e(10))),f=(r(e(9)),r(e(6))),d=(r(e(7)),(0,c.default)()),h=[],v=function(){function t(n){i(this,t),jQuery.extend(this,{annotationsList:[],prefix:null,dfd:null},n),this._explorer=(0,u.default)().getAnnotationExplorer(),h.push(this)}return a(t,[{key:"search",value:function(t){var n=this;d.debug("YaleEndpoint#search options:",t);var e=t.uri,r=(0,s.default)();this._explorer.getAnnotations({canvasId:e}).catch(function(t){throw"ERROR YaleEndpoint#search getAnnotations - "+t}).then(function(t){d.debug("YaleEndpoint#search annotations:",t),n.annotationsList=t;try{n.dfd.resolve(!0)}catch(t){d.error("YaleEndpoint#search dfd.resolve failed - ",t)}}).catch(function(t){d.error("YaleEndpoint#search failed - ",t),(0,l.default)().hide(),r.show("annotations")})}},{key:"create",value:function(t,n,e){this.userAuthorize("create",t)?this._create(t).catch(function(t){throw"YaleEndpoint#create _create failed - "+t}).then(function(t){d.debug("YaleEndpoint#create successful with anno: ",t),"function"==typeof n&&n(t)}).catch(function(t){d.error("ERROR YaleEndpoint#create successCallback failed"),e()}):((0,s.default)().show("authz_create"),"function"==typeof e&&e())}},{key:"_create",value:function(t){d.debug("YaleEndpoint#_create oaAnnotation:",t);var n=this;return this._explorer.createAnnotation(t).catch(function(t){throw"YaleEndpoint#_create createAnnotation failed - "+t}).then(function(t){return n.annotationsList.push(t),t})}},{key:"update",value:function(t,n,e){t["@id"];this.userAuthorize("update",t)?this._update(t).catch(function(t){var n="ERROR YaleEndpoint#update _update failed - "+t;d.error(n),e()}).then(function(t){"function"==typeof n&&n(t)}):((0,s.default)().show("authz_update"),"function"==typeof e&&e())}},{key:"_update",value:function(t){var n=this;d.debug("YaleEndpoint#_update oaAnnotation:",t);var e=this,r=t["@id"];return Promise.resolve().then(function(){return n._explorer.updateAnnotation(t)}).catch(function(t){throw"ERROR YaleEndpoint#_update updateAnnotation - "+t}).then(function(t){return jQuery.each(e.annotationsList,function(n,o){if(o["@id"]===r)return e.annotationsList[n]=t,!1}),t})}},{key:"deleteAnnotation",value:function(t,n,e){d.debug("YaleEndpoint#deleteAnnotation annotationId: "+t);this.userAuthorize("delete",null)?this._deleteAnnotation(t).then(function(){"function"==typeof n&&n()}).catch(function(t){d.error("YaleEndpoint#deleteAnnotation _deleteAnnotation failed:",t),e()}):(d.info("YaleEndpoint#delete user not authorized"),(0,s.default)().show("authz_update"),"function"==typeof e&&e())}},{key:"_deleteAnnotation",value:function(t){d.debug("YaleEndpoint#_deleteAnnotation annotationId:",t);var n=this;return this._explorer.deleteAnnotation(t).catch(function(t){throw"ERROR YaleEndpoint#_deleteAnnotation explorer.deleteAnnotation - "+t}).then(function(e){return n.annotationsList=jQuery.grep(n.annotationsList,function(n,e){return n["@id"]!==t}),e})}},{key:"getLayers",value:function(){var t=o(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return d.debug("YaleEndpoint#getLayers"),t.abrupt("return",this._explorer.getLayers());case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"updateOrder",value:function(t,n,e,r,o){d.debug("YaleEndpoint#updateOrder canvasId:",t,"layerId:",n,"annoIds:",e);this.userAuthorize("update",null)?this._updateOrder(t,n,e).catch(function(t){throw"YaleEndpoint#updateOrder _upadteOrder failed: "+t}).then(function(){"function"==typeof r&&r()}).catch(function(t){d.error("YaleEndpoint#updateOrder",t),o()}):(d.info("YaleEndpoint#updateOrder user not authorized"),(0,s.default)().show("authz_update"),"function"==typeof o&&o())}},{key:"_updateOrder",value:function(t,n,e){return this._explorer.updateAnnotationListOrder(t,n,e)}},{key:"userAuthorize",value:function(t,n){return"create"!==t&&"update"!==t&&"delete"!==t||f.default.isEditor()}},{key:"set",value:function(t,n,e){d.debug("YaleEndpoint#set prop:",t,", value:",n,", options:",e),e?this[e.parent][t]=n:this[t]=n}}]),t}();n.YaleEndpoint=v,n.getEndpoint=function(){return d.debug("getEndpoint _instances:",h.length,h),h[0]}},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t){return function(){var n=t.apply(this,arguments);return new Promise(function(t,e){function r(o,i){try{var a=n[o](i),u=a.value}catch(t){return void e(t)}if(!a.done)return Promise.resolve(u).then(function(t){r("next",t)},function(t){r("throw",t)});t(u)}return r("next")})}}function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),u=e(1),s=r(e(0)),c=r(e(3)),l=(r(e(9)),r(e(2))),f=r(e(15)),d=r(e(7)),h=(0,s.default)(),v=function(){function t(n){i(this,t),h.debug("AnnotationEditor#constructor options:",n),jQuery.extend(this,{windowId:null,miradorDriven:!1,annotation:null,id:null,parent:null,endpoint:null,targetAnnotation:null,saveCallback:null,cancelCallback:null},n),this._mode=n.mode,this._$anno=this.annotation?(0,u.Anno)(this.annotation):null,this._textDirectionClass=this._getTextDirectionClass(this._$anno),h.debug("AnnotationEditor#constructor _useVerticalRL:",this._useVerticalRL),this.init(),this.hide()}return a(t,[{key:"init",value:function(){this.miradorProxyManager=(0,c.default)(),this.endpoint=this.endpoint||this.miradorProxyManager.getWindowProxyById(this.windowId).getEndPoint(),this.id=this.id||Mirador.genUUID();var t=this.annotation?this._$anno.tags.join(" "):"";this.element=jQuery(g({miradorDriven:this.miradorDriven,tags:t})).attr("id",this.id),this.miradorDriven||this.reload(this.parent)}},{key:"reload",value:function(){var t=o(regeneratorRuntime.mark(function t(n){var e,r,o,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return h.debug("AnnotationEditor#reload parent:",n),n.prepend(this.element),e=this.element.find(".header"),r=e.find(".title"),this.textArea=this.element.find("textarea"),this.layerSelectorContainer=this.element.find(".layer_select"),this.layerSelector=new f.default({parent:this.layerSelectorContainer}),t.next=9,this.endpoint.getLayers();case 9:o=t.sent,this.layerSelector.init(o).then(function(){if("create"===i._mode){r.text("Create Annotation");var t=(0,l.default)().getString("lastSelectedLayer");i.layerSelector.val(t)}else r.text(""),i.annotation&&(i.textArea.val(i._$anno.bodyText),i.annotation.layerId&&i.layerSelector.val(i.annotation.layerId));i.initTinyMce(),i.bindEvents()}).catch(function(t){h.error("ERROR AnnotationEditor#reload layerSelector.init failed - "+t)});case 11:case"end":return t.stop()}},t,this)}));return function(n){return t.apply(this,arguments)}}()},{key:"initTinyMce",value:function(){var t=this;tinymce.init({selector:"#"+this.id+" textarea",plugins:"link paste image",menubar:!1,toolbar:"bold italic fontsizeselect | bullist numlist | link image | undo redo | removeformat | TB_RL",fontsize_formats:"10px 12px 14px 18px 24px",statusbar:!1,toolbar_items_size:"small",default_link_target:"_blank",past_as_text:!0,resize:!0,height:"140",theme_advanced_resizing:!0,theme_advanced_statusbar_location:"bottom",setup:function(n){n.on("init",function(t){this.getDoc().body.style.fontSize="12px",tinymce.execCommand("mceFocus",!1,t.target.id)}),n.on("focus",function(t){h.debug("TinyMCE on focus e:",t)}),n.addButton("TB_RL",{type:"listbox",tooltip:"Set text direction",icon:!1,onselect:function(n){t._textDirectionClass=this.value(),(0,l.default)().setString("textDirection",this.value())},values:[{text:"Horizontal LR",value:"horizontal-lr"},{text:"Horizontal RL",value:"horizontal-rl"},{text:"Vertical LR",value:"vertical-lr"},{text:"Vertical RL",value:"vertical-rl"}],value:t._textDirectionClass})}})}},{key:"show",value:function(t){h.debug("AnnotationEditor#show",t),t&&this.reload(jQuery(t)),this.element.show()}},{key:"hide",value:function(){this.element.hide()}},{key:"destroy",value:function(){this.element.remove()}},{key:"isDirty",value:function(){return this.getEditor().isDirty()}},{key:"getEditor",value:function(){return tinymce.get(this.textArea.attr("id"))}},{key:"getMode",value:function(){return this._mode}},{key:"getLoadedAnnotation",value:function(){return this._loadedAnnotation}},{key:"createAnnotation",value:function(t){var n=this.element.find(".tags_editor").val().trim(),e=this.getEditor().getContent(),r=[],o=[],i=[];n&&(r=n.split(/\s+/)),r&&r.length>0&&(o.push("oa:tagging"),jQuery.each(r,function(t,n){i.push({"@type":"oa:Tag",chars:n})})),o.push("oa:commenting"),i.push({"@type":"dctypes:Text",format:"text/html",chars:e,style:this._textDirectionClass});var a=this.layerSelector.val(),u={"@context":"http://iiif.io/api/presentation/2/context.json","@type":"oa:Annotation",motivation:o,resource:i,layerId:a};return t&&(u.on={"@type":"oa:Annotation",full:t["@id"]}),h.debug("AnnotationEditor#createAnnotation anno:",u),u}},{key:"loadAnnotation",value:function(t){this._mode="merge",this._loadedAnnotation=t;var n=(0,u.Anno)(t),e=n.bodyText;this.layerSelector.val(n.layerId),this.getEditor().setContent(e);var r=n.tags;r.length>0&&this.element.find(".tags_editor").val(r.join(" ")),this.getEditor().getBody().setAttribute("contenteditable",!1)}},{key:"updateAnnotation",value:function(t){h.debug("AnnotationEditor#updateAnnotation oaAnno:",t);var n=this.element.find(".tags_editor").val().trim(),e=this.getEditor().getContent(),r=[];n&&(r=n.split(/\s+/));t.motivation=jQuery.grep(t.motivation,function(t){return"oa:tagging"!==t}),t.resource=jQuery.grep(t.resource,function(t){return"oa:Tag"!==t["@type"]}),r.length>0&&(t.motivation.push("oa:tagging"),jQuery.each(r,function(n,e){t.resource.push({"@type":"oa:Tag",chars:e})}));var o=!0,i=!1,a=void 0;try{for(var u,s=t.resource[Symbol.iterator]();!(o=(u=s.next()).done);o=!0){var c=u.value;"dctypes:Text"===c["@type"]&&(c.chars=e,c.style=this._textDirectionClass)}}catch(t){i=!0,a=t}finally{try{!o&&s.return&&s.return()}finally{if(i)throw a}}var l=this.layerSelector.val();return t.layerId=l,t}},{key:"save",value:function(){var t=this,n=null;"create"==this._mode?(n=this.createAnnotation(this.targetAnnotation),this.endpoint.create(n,function(n){var e=n;"function"==typeof t.saveCallback&&t.saveCallback(e),t.destroy()},function(){h.error("AnnotationEditor#save endpoint.create failed for",n)})):(n=this.updateAnnotation(this.annotation),console.log("TTT UUU anno:",n),this.endpoint.update(n,function(n){if("function"==typeof t.saveCallback){var e=n,r=t.getEditor().getContent().trim();t.saveCallback(e,r)}t.destroy()},function(){h.error("AnnotationEditor#save endpoint.update failed for",n)}))}},{key:"validate",value:function(){h.debug("AnnotationEditor#validate target anno:",this.targetAnnotation);var t="";return"create"===this._mode&&(this.targetAnnotation||(t+="Target annotation is missing.\n")),this.layerSelector.val()||(t+="Layer is not selected.\n"),""===this.getEditor().getContent().trim()&&(t+="Please enter content.\n"),""===t||(alert(t),!1)}},{key:"bindEvents",value:function(){var t=this;this.element.find(".ym_save").click(function(n){n.preventDefault(),n.stopPropagation(),t.validate()&&t.save()}),this.element.find(".ym_cancel").click(function(n){n.preventDefault(),n.stopPropagation(),t.destroy(),"function"==typeof t.cancelCallback&&t.cancelCallback()}),this.element.find(".ym_vertical_inc").click(function(n){var e=t.getEditor().id+"_ifr",r=tinyMCE.DOM.get(e),o=parseInt(tinyMCE.DOM.getStyle(r,"height"),10);tinyMCE.DOM.setStyle(r,"height",o+75+"px")}),this.element.find(".ym_vertical_dec").click(function(n){var e=t.getEditor().id+"_ifr",r=tinyMCE.DOM.get(e),o=parseInt(tinyMCE.DOM.getStyle(r,"height"),10);tinyMCE.DOM.setStyle(r,"height",o-75+"px")})}},{key:"_getTextDirectionClass",value:function(t){var n="";return t&&(n=t.bodyStyle,h.debug("AnnotationEditor#_getTextDirectionClass class from anno:",n),d.default.directionClasses.includes(n))?n:(n=(0,l.default)().getString("textDirection"),h.debug("AnnotationEditor#_getTextDirectionClass default from state:",n),d.default.directionClasses.includes(n)?n:"horizontal-lr")}}]),t}();n.default=v;var g=Handlebars.compile(['<div class="ym_anno_editor">','  <div class="header">','    <span class="layer_select"></span>',"  </div>","  <textarea></textarea>",'  <input class="tags_editor" placeholder="{{t "addTagsHere"}}" {{#if tags}}value="{{tags}}"{{/if}}/>',"  {{#unless miradorDriven}}",'    <div class="bottom_row">','        <button class="ym_save">Save</button>','        <button class="ym_cancel">Cancel</button>','      <div class="ym_float_right">','        <i class="large caret up icon ym_vertical_dec"></i>','        <i class="large caret down icon ym_vertical_inc"></i>',"      </div>","    </div>","  {{/unless}}","</div>"].join(""))},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),a=r(e(0)),u=r(e(2)),s=r(e(16)),c=r(e(6)),l=function(){function t(n){o(this,t),jQuery.extend(this,{selector:null,parent:null,changeCallback:null,initialLayerId:null},n),this.logger=(0,a.default)(),this.appState=(0,u.default)()}return i(t,[{key:"init",value:function(t){this.logger.debug("LayerSelector#init layers:",t,"initialLayerId:",this.initialLayerId);var n=c.default.isEditor(),e=this.appState.getSetting("ui","annotationWindow","hiddenLayers")||[];return!n&&e.length>0&&(t=t.filter(function(t){return!e.includes(t["@id"])})),this._isLoaded=!1,this.selector=new s.default({appendTo:this.parent}),this.bindEvents(),this.reload(t)}},{key:"reload",value:function(t){this.logger.debug("LayerSelector#reload");var n=this,e=this.appState.getTransient("layerIndexMap");e||this.logger.error("LayerSelector#reload cannot retrieve layerIndexMap"),this.selector.empty();var r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var s=a.value,c=s["@id"],l=e?e[c]:0,f="number"==typeof l?"layer_"+l%10:void 0;n.selector.addItem({label:s.label,value:c,colorClass:f})}}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return new Promise(function(r,o){if(t.length>0){var i=n.initialLayerId||t[0]["@id"],a=e?e[i]:0;n.selector.val(i,!0),n.selector.setColorClass("layer_"+a%10),n._isLoaded=!0}r(n)})}},{key:"val",value:function(t,n){this.logger.debug("LayerSelector#val",t,n);var e=this.selector.val(t,n);return void 0!==t&&(this.logger.debug("val:",t),(0,u.default)().setString("lastSelectedLayer",t)),e}},{key:"isLoaded",value:function(){return this._isLoaded}},{key:"bindEvents",value:function(){var t=this;this.selector.changeCallback=function(n,e){t.logger.debug("LayerSelector#bindEvents changeCallback");var r=t.appState.getTransient("layerIndexMap"),o=r?r[n]:0;t.selector.setColorClass("layer_"+o%10),(0,u.default)().setString("lastSelectedLayer",n),"function"==typeof t.changeCallback&&t.changeCallback(n,e)}}}]),t}();n.default=l},function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),i=(0,function(t){return t&&t.__esModule?t:{default:t}}(e(0)).default)(),a=function(){function t(n){r(this,t),jQuery.extend(this,{appendTo:null,changeCallback:null},n),this.init()}return o(t,[{key:"init",value:function(){var t=this;this.element=jQuery(u()),this.appendTo.append(this.element),this.element.dropdown({direction:"downward",onChange:function(n,e){i.debug("Selector#init onChange ",n,e,t._skipNotify),"function"!=typeof t.changeCallback||t._skipNotify||t.changeCallback(n,e),t._skipNotify=!1},action:function(n,e){t.element.dropdown("set selected",e),t.element.dropdown("hide")}}),this.values=[]}},{key:"setItems",value:function(t){i.debug("Selector#setItems itemsConfig:",t);var n=this.element.find(".menu");n.empty(),this._setItems(t,n)}},{key:"_setItems",value:function(t,n){var e=this;jQuery.each(t,function(t,r){if(r.children.length>0){e.addItem({label:r.label,value:r.value,parent:n});var o=e.addMenuItem(r.label,r.value,n);e._setItems(r.children,o)}else e.addItem({label:r.label,value:r.value,parent:n})})}},{key:"addMenuItem",value:function(t,n,e){var r=jQuery("<div/>").addClass("item").attr("data-text",t).attr("data-value",n).text(t),o=jQuery("<div/>").addClass("menu").css("overflow","hidden");return r.append(jQuery('<i class="dropdown icon"></i>')),r.append(o),e.append(r),o}},{key:"addItem",value:function(t){var n=jQuery(s({label:t.label,colorClass:t.colorClass})).attr("data-text",t.label).attr("data-value",t.value);(t.parent||this.element.find(".menu")).append(n),this.values.push(t.value)}},{key:"empty",value:function(){this.element.find(".menu").empty()}},{key:"val",value:function(t,n){i.debug("Selector#val",t,n);var e=this.element;return this._skipNotify=n||!1,e.dropdown("refresh"),void 0===t?e.dropdown("get value"):e.dropdown("get item",t)?(e.dropdown("set selected",t),t):(e.dropdown("set selected",this.values[0]),this.values[0])}},{key:"setColorClass",value:function(t){this._oldClass&&this.element.removeClass(this._oldClass),this.element.addClass(t),this._oldClass=t}},{key:"destroy",value:function(){this.element.remove()}}]),t}();n.default=a;var u=Handlebars.compile(['<div class="basic tiny ui button ym_button dropdown">','  <input name="selection" type="hidden" />','  <div class="default text"></div>','  <i class="ym dropdown icon"></i>','  <div class="menu">',"  </div>","</div>"].join("")),s=Handlebars.compile(['<div class="item">',"  {{#if colorClass}}",'    <span class="icon_span"><i class="circle icon {{colorClass}}"></i></span>',"  {{/if}}",'  <span class="label">{{label}}</span>',"</div>"].join(""))},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=r(e(4)),i=r(e(11));window.YaleMirador={getApp:o.default,fatalError:i.default}},function(t,n,e){(function(t){var n;!function t(e,r,o){function i(u,s){if(!r[u]){if(!e[u]){if(!s&&("function"==typeof n&&n))return n(u,!0);if(a)return a(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[u]={exports:{}};e[u][0].call(l.exports,function(t){var n=e[u][1][t];return i(n||t)},l,l.exports,t,e,r,o)}return r[u].exports}for(var a="function"==typeof n&&n,u=0;u<o.length;u++)i(o[u]);return i}({1:[function(n,e,r){(function(t){"use strict";function e(t,n,e){t[n]||Object[r](t,n,{writable:!0,configurable:!0,value:e})}if(n(327),n(328),n(2),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var r="defineProperty";e(String.prototype,"padLeft","".padStart),e(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&e(Array,t,Function.call.bind([][t]))})}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2,327:327,328:328}],2:[function(t,n,e){t(130),n.exports=t(23).RegExp.escape},{130:130,23:23}],3:[function(t,n,e){n.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},{}],4:[function(t,n,e){var r=t(18);n.exports=function(t,n){if("number"!=typeof t&&"Number"!=r(t))throw TypeError(n);return+t}},{18:18}],5:[function(t,n,e){var r=t(128)("unscopables"),o=Array.prototype;void 0==o[r]&&t(42)(o,r,{}),n.exports=function(t){o[r][t]=!0}},{128:128,42:42}],6:[function(t,n,e){n.exports=function(t,n,e,r){if(!(t instanceof n)||void 0!==r&&r in t)throw TypeError(e+": incorrect invocation!");return t}},{}],7:[function(t,n,e){var r=t(51);n.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},{51:51}],8:[function(t,n,e){"use strict";var r=t(119),o=t(114),i=t(118);n.exports=[].copyWithin||function(t,n){var e=r(this),a=i(e.length),u=o(t,a),s=o(n,a),c=arguments.length>2?arguments[2]:void 0,l=Math.min((void 0===c?a:o(c,a))-s,a-u),f=1;for(s<u&&u<s+l&&(f=-1,s+=l-1,u+=l-1);l-- >0;)s in e?e[u]=e[s]:delete e[u],u+=f,s+=f;return e}},{114:114,118:118,119:119}],9:[function(t,n,e){"use strict";var r=t(119),o=t(114),i=t(118);n.exports=function(t){for(var n=r(this),e=i(n.length),a=arguments.length,u=o(a>1?arguments[1]:void 0,e),s=a>2?arguments[2]:void 0,c=void 0===s?e:o(s,e);c>u;)n[u++]=t;return n}},{114:114,118:118,119:119}],10:[function(t,n,e){var r=t(39);n.exports=function(t,n){var e=[];return r(t,!1,e.push,e,n),e}},{39:39}],11:[function(t,n,e){var r=t(117),o=t(118),i=t(114);n.exports=function(t){return function(n,e,a){var u,s=r(n),c=o(s.length),l=i(a,c);if(t&&e!=e){for(;c>l;)if((u=s[l++])!=u)return!0}else for(;c>l;l++)if((t||l in s)&&s[l]===e)return t||l||0;return!t&&-1}}},{114:114,117:117,118:118}],12:[function(t,n,e){var r=t(25),o=t(47),i=t(119),a=t(118),u=t(15);n.exports=function(t,n){var e=1==t,s=2==t,c=3==t,l=4==t,f=6==t,d=5==t||f,h=n||u;return function(n,u,v){for(var g,p,y=i(n),m=o(y),_=r(u,v,3),b=a(m.length),w=0,x=e?h(n,b):s?h(n,0):void 0;b>w;w++)if((d||w in m)&&(g=m[w],p=_(g,w,y),t))if(e)x[w]=p;else if(p)switch(t){case 3:return!0;case 5:return g;case 6:return w;case 2:x.push(g)}else if(l)return!1;return f?-1:c||l?l:x}}},{118:118,119:119,15:15,25:25,47:47}],13:[function(t,n,e){var r=t(3),o=t(119),i=t(47),a=t(118);n.exports=function(t,n,e,u,s){r(n);var c=o(t),l=i(c),f=a(c.length),d=s?f-1:0,h=s?-1:1;if(e<2)for(;;){if(d in l){u=l[d],d+=h;break}if(d+=h,s?d<0:f<=d)throw TypeError("Reduce of empty array with no initial value")}for(;s?d>=0:f>d;d+=h)d in l&&(u=n(u,l[d],d,c));return u}},{118:118,119:119,3:3,47:47}],14:[function(t,n,e){var r=t(51),o=t(49),i=t(128)("species");n.exports=function(t){var n;return o(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!o(n.prototype)||(n=void 0),r(n)&&null===(n=n[i])&&(n=void 0)),void 0===n?Array:n}},{128:128,49:49,51:51}],15:[function(t,n,e){var r=t(14);n.exports=function(t,n){return new(r(t))(n)}},{14:14}],16:[function(t,n,e){"use strict";var r=t(3),o=t(51),i=t(46),a=[].slice,u={},s=function(t,n,e){if(!(n in u)){for(var r=[],o=0;o<n;o++)r[o]="a["+o+"]";u[n]=Function("F,a","return new F("+r.join(",")+")")}return u[n](t,e)};n.exports=Function.bind||function(t){var n=r(this),e=a.call(arguments,1),u=function(){var r=e.concat(a.call(arguments));return this instanceof u?s(n,r.length,r):i(n,r,t)};return o(n.prototype)&&(u.prototype=n.prototype),u}},{3:3,46:46,51:51}],17:[function(t,n,e){var r=t(18),o=t(128)("toStringTag"),i="Arguments"==r(function(){return arguments}()),a=function(t,n){try{return t[n]}catch(t){}};n.exports=function(t){var n,e,u;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(e=a(n=Object(t),o))?e:i?r(n):"Object"==(u=r(n))&&"function"==typeof n.callee?"Arguments":u}},{128:128,18:18}],18:[function(t,n,e){var r={}.toString;n.exports=function(t){return r.call(t).slice(8,-1)}},{}],19:[function(t,n,e){"use strict";var r=t(72).f,o=t(71),i=t(93),a=t(25),u=t(6),s=t(39),c=t(55),l=t(57),f=t(100),d=t(29),h=t(66).fastKey,v=t(125),g=d?"_s":"size",p=function(t,n){var e,r=h(n);if("F"!==r)return t._i[r];for(e=t._f;e;e=e.n)if(e.k==n)return e};n.exports={getConstructor:function(t,n,e,c){var l=t(function(t,r){u(t,l,n,"_i"),t._t=n,t._i=o(null),t._f=void 0,t._l=void 0,t[g]=0,void 0!=r&&s(r,e,t[c],t)});return i(l.prototype,{clear:function(){for(var t=v(this,n),e=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete e[r.i];t._f=t._l=void 0,t[g]=0},delete:function(t){var e=v(this,n),r=p(e,t);if(r){var o=r.n,i=r.p;delete e._i[r.i],r.r=!0,i&&(i.n=o),o&&(o.p=i),e._f==r&&(e._f=o),e._l==r&&(e._l=i),e[g]--}return!!r},forEach:function(t){v(this,n);for(var e,r=a(t,arguments.length>1?arguments[1]:void 0,3);e=e?e.n:this._f;)for(r(e.v,e.k,this);e&&e.r;)e=e.p},has:function(t){return!!p(v(this,n),t)}}),d&&r(l.prototype,"size",{get:function(){return v(this,n)[g]}}),l},def:function(t,n,e){var r,o,i=p(t,n);return i?i.v=e:(t._l=i={i:o=h(n,!0),k:n,v:e,p:r=t._l,n:void 0,r:!1},t._f||(t._f=i),r&&(r.n=i),t[g]++,"F"!==o&&(t._i[o]=i)),t},getEntry:p,setStrong:function(t,n,e){c(t,n,function(t,e){this._t=v(t,n),this._k=e,this._l=void 0},function(){for(var t=this,n=t._k,e=t._l;e&&e.r;)e=e.p;return t._t&&(t._l=e=e?e.n:t._t._f)?"keys"==n?l(0,e.k):"values"==n?l(0,e.v):l(0,[e.k,e.v]):(t._t=void 0,l(1))},e?"entries":"values",!e,!0),f(n)}}},{100:100,125:125,25:25,29:29,39:39,55:55,57:57,6:6,66:66,71:71,72:72,93:93}],20:[function(t,n,e){var r=t(17),o=t(10);n.exports=function(t){return function(){if(r(this)!=t)throw TypeError(t+"#toJSON isn't generic");return o(this)}}},{10:10,17:17}],21:[function(t,n,e){"use strict";var r=t(93),o=t(66).getWeak,i=t(7),a=t(51),u=t(6),s=t(39),c=t(12),l=t(41),f=t(125),d=c(5),h=c(6),v=0,g=function(t){return t._l||(t._l=new p)},p=function(){this.a=[]},y=function(t,n){return d(t.a,function(t){return t[0]===n})};p.prototype={get:function(t){var n=y(this,t);if(n)return n[1]},has:function(t){return!!y(this,t)},set:function(t,n){var e=y(this,t);e?e[1]=n:this.a.push([t,n])},delete:function(t){var n=h(this.a,function(n){return n[0]===t});return~n&&this.a.splice(n,1),!!~n}},n.exports={getConstructor:function(t,n,e,i){var c=t(function(t,r){u(t,c,n,"_i"),t._t=n,t._i=v++,t._l=void 0,void 0!=r&&s(r,e,t[i],t)});return r(c.prototype,{delete:function(t){if(!a(t))return!1;var e=o(t);return!0===e?g(f(this,n)).delete(t):e&&l(e,this._i)&&delete e[this._i]},has:function(t){if(!a(t))return!1;var e=o(t);return!0===e?g(f(this,n)).has(t):e&&l(e,this._i)}}),c},def:function(t,n,e){var r=o(i(n),!0);return!0===r?g(t).set(n,e):r[t._i]=e,t},ufstore:g}},{12:12,125:125,39:39,41:41,51:51,6:6,66:66,7:7,93:93}],22:[function(t,n,e){"use strict";var r=t(40),o=t(33),i=t(94),a=t(93),u=t(66),s=t(39),c=t(6),l=t(51),f=t(35),d=t(56),h=t(101),v=t(45);n.exports=function(t,n,e,g,p,y){var m=r[t],_=m,b=p?"set":"add",w=_&&_.prototype,x={},A=function(t){var n=w[t];i(w,t,"delete"==t?function(t){return!(y&&!l(t))&&n.call(this,0===t?0:t)}:"has"==t?function(t){return!(y&&!l(t))&&n.call(this,0===t?0:t)}:"get"==t?function(t){return y&&!l(t)?void 0:n.call(this,0===t?0:t)}:"add"==t?function(t){return n.call(this,0===t?0:t),this}:function(t,e){return n.call(this,0===t?0:t,e),this})};if("function"==typeof _&&(y||w.forEach&&!f(function(){(new _).entries().next()}))){var S=new _,k=S[b](y?{}:-0,1)!=S,T=f(function(){S.has(1)}),P=d(function(t){new _(t)}),E=!y&&f(function(){for(var t=new _,n=5;n--;)t[b](n,n);return!t.has(-0)});P||((_=n(function(n,e){c(n,_,t);var r=v(new m,n,_);return void 0!=e&&s(e,p,r[b],r),r})).prototype=w,w.constructor=_),(T||E)&&(A("delete"),A("has"),p&&A("get")),(E||k)&&A(b),y&&w.clear&&delete w.clear}else _=g.getConstructor(n,t,p,b),a(_.prototype,e),u.NEED=!0;return h(_,t),x[t]=_,o(o.G+o.W+o.F*(_!=m),x),y||g.setStrong(_,t,p),_}},{101:101,33:33,35:35,39:39,40:40,45:45,51:51,56:56,6:6,66:66,93:93,94:94}],23:[function(t,n,e){var r=n.exports={version:"2.5.0"};"number"==typeof __e&&(__e=r)},{}],24:[function(t,n,e){"use strict";var r=t(72),o=t(92);n.exports=function(t,n,e){n in t?r.f(t,n,o(0,e)):t[n]=e}},{72:72,92:92}],25:[function(t,n,e){var r=t(3);n.exports=function(t,n,e){if(r(t),void 0===n)return t;switch(e){case 1:return function(e){return t.call(n,e)};case 2:return function(e,r){return t.call(n,e,r)};case 3:return function(e,r,o){return t.call(n,e,r,o)}}return function(){return t.apply(n,arguments)}}},{3:3}],26:[function(t,n,e){"use strict";var r=t(35),o=Date.prototype.getTime,i=Date.prototype.toISOString,a=function(t){return t>9?t:"0"+t};n.exports=r(function(){return"0385-07-25T07:06:39.999Z"!=i.call(new Date(-5e13-1))})||!r(function(){i.call(new Date(NaN))})?function(){if(!isFinite(o.call(this)))throw RangeError("Invalid time value");var t=this,n=t.getUTCFullYear(),e=t.getUTCMilliseconds(),r=n<0?"-":n>9999?"+":"";return r+("00000"+Math.abs(n)).slice(r?-6:-4)+"-"+a(t.getUTCMonth()+1)+"-"+a(t.getUTCDate())+"T"+a(t.getUTCHours())+":"+a(t.getUTCMinutes())+":"+a(t.getUTCSeconds())+"."+(e>99?e:"0"+a(e))+"Z"}:i},{35:35}],27:[function(t,n,e){"use strict";var r=t(7),o=t(120);n.exports=function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return o(r(this),"number"!=t)}},{120:120,7:7}],28:[function(t,n,e){n.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},{}],29:[function(t,n,e){n.exports=!t(35)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{35:35}],30:[function(t,n,e){var r=t(51),o=t(40).document,i=r(o)&&r(o.createElement);n.exports=function(t){return i?o.createElement(t):{}}},{40:40,51:51}],31:[function(t,n,e){n.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},{}],32:[function(t,n,e){var r=t(81),o=t(78),i=t(82);n.exports=function(t){var n=r(t),e=o.f;if(e)for(var a,u=e(t),s=i.f,c=0;u.length>c;)s.call(t,a=u[c++])&&n.push(a);return n}},{78:78,81:81,82:82}],33:[function(t,n,e){var r=t(40),o=t(23),i=t(42),a=t(94),u=t(25),s=function(t,n,e){var c,l,f,d,h=t&s.F,v=t&s.G,g=t&s.S,p=t&s.P,y=t&s.B,m=v?r:g?r[n]||(r[n]={}):(r[n]||{}).prototype,_=v?o:o[n]||(o[n]={}),b=_.prototype||(_.prototype={});v&&(e=n);for(c in e)f=((l=!h&&m&&void 0!==m[c])?m:e)[c],d=y&&l?u(f,r):p&&"function"==typeof f?u(Function.call,f):f,m&&a(m,c,f,t&s.U),_[c]!=f&&i(_,c,d),p&&b[c]!=f&&(b[c]=f)};r.core=o,s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,n.exports=s},{23:23,25:25,40:40,42:42,94:94}],34:[function(t,n,e){var r=t(128)("match");n.exports=function(t){var n=/./;try{"/./"[t](n)}catch(e){try{return n[r]=!1,!"/./"[t](n)}catch(t){}}return!0}},{128:128}],35:[function(t,n,e){n.exports=function(t){try{return!!t()}catch(t){return!0}}},{}],36:[function(t,n,e){"use strict";var r=t(42),o=t(94),i=t(35),a=t(28),u=t(128);n.exports=function(t,n,e){var s=u(t),c=e(a,s,""[t]),l=c[0],f=c[1];i(function(){var n={};return n[s]=function(){return 7},7!=""[t](n)})&&(o(String.prototype,t,l),r(RegExp.prototype,s,2==n?function(t,n){return f.call(t,this,n)}:function(t){return f.call(t,this)}))}},{128:128,28:28,35:35,42:42,94:94}],37:[function(t,n,e){"use strict";var r=t(7);n.exports=function(){var t=r(this),n="";return t.global&&(n+="g"),t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),t.sticky&&(n+="y"),n}},{7:7}],38:[function(t,n,e){"use strict";function r(t,n,e,c,l,f,d,h){for(var v,g,p=l,y=0,m=!!d&&u(d,h,3);y<c;){if(y in e){if(v=m?m(e[y],y,n):e[y],g=!1,i(v)&&(g=void 0!==(g=v[s])?!!g:o(v)),g&&f>0)p=r(t,n,v,a(v.length),p,f-1)-1;else{if(p>=9007199254740991)throw TypeError();t[p]=v}p++}y++}return p}var o=t(49),i=t(51),a=t(118),u=t(25),s=t(128)("isConcatSpreadable");n.exports=r},{118:118,128:128,25:25,49:49,51:51}],39:[function(t,n,e){var r=t(25),o=t(53),i=t(48),a=t(7),u=t(118),s=t(129),c={},l={};(e=n.exports=function(t,n,e,f,d){var h,v,g,p,y=d?function(){return t}:s(t),m=r(e,f,n?2:1),_=0;if("function"!=typeof y)throw TypeError(t+" is not iterable!");if(i(y)){for(h=u(t.length);h>_;_++)if((p=n?m(a(v=t[_])[0],v[1]):m(t[_]))===c||p===l)return p}else for(g=y.call(t);!(v=g.next()).done;)if((p=o(g,m,v.value,n))===c||p===l)return p}).BREAK=c,e.RETURN=l},{118:118,129:129,25:25,48:48,53:53,7:7}],40:[function(t,n,e){var r=n.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},{}],41:[function(t,n,e){var r={}.hasOwnProperty;n.exports=function(t,n){return r.call(t,n)}},{}],42:[function(t,n,e){var r=t(72),o=t(92);n.exports=t(29)?function(t,n,e){return r.f(t,n,o(1,e))}:function(t,n,e){return t[n]=e,t}},{29:29,72:72,92:92}],43:[function(t,n,e){var r=t(40).document;n.exports=r&&r.documentElement},{40:40}],44:[function(t,n,e){n.exports=!t(29)&&!t(35)(function(){return 7!=Object.defineProperty(t(30)("div"),"a",{get:function(){return 7}}).a})},{29:29,30:30,35:35}],45:[function(t,n,e){var r=t(51),o=t(99).set;n.exports=function(t,n,e){var i,a=n.constructor;return a!==e&&"function"==typeof a&&(i=a.prototype)!==e.prototype&&r(i)&&o&&o(t,i),t}},{51:51,99:99}],46:[function(t,n,e){n.exports=function(t,n,e){var r=void 0===e;switch(n.length){case 0:return r?t():t.call(e);case 1:return r?t(n[0]):t.call(e,n[0]);case 2:return r?t(n[0],n[1]):t.call(e,n[0],n[1]);case 3:return r?t(n[0],n[1],n[2]):t.call(e,n[0],n[1],n[2]);case 4:return r?t(n[0],n[1],n[2],n[3]):t.call(e,n[0],n[1],n[2],n[3])}return t.apply(e,n)}},{}],47:[function(t,n,e){var r=t(18);n.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},{18:18}],48:[function(t,n,e){var r=t(58),o=t(128)("iterator"),i=Array.prototype;n.exports=function(t){return void 0!==t&&(r.Array===t||i[o]===t)}},{128:128,58:58}],49:[function(t,n,e){var r=t(18);n.exports=Array.isArray||function(t){return"Array"==r(t)}},{18:18}],50:[function(t,n,e){var r=t(51),o=Math.floor;n.exports=function(t){return!r(t)&&isFinite(t)&&o(t)===t}},{51:51}],51:[function(t,n,e){n.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},{}],52:[function(t,n,e){var r=t(51),o=t(18),i=t(128)("match");n.exports=function(t){var n;return r(t)&&(void 0!==(n=t[i])?!!n:"RegExp"==o(t))}},{128:128,18:18,51:51}],53:[function(t,n,e){var r=t(7);n.exports=function(t,n,e,o){try{return o?n(r(e)[0],e[1]):n(e)}catch(n){var i=t.return;throw void 0!==i&&r(i.call(t)),n}}},{7:7}],54:[function(t,n,e){"use strict";var r=t(71),o=t(92),i=t(101),a={};t(42)(a,t(128)("iterator"),function(){return this}),n.exports=function(t,n,e){t.prototype=r(a,{next:o(1,e)}),i(t,n+" Iterator")}},{101:101,128:128,42:42,71:71,92:92}],55:[function(t,n,e){"use strict";var r=t(60),o=t(33),i=t(94),a=t(42),u=t(41),s=t(58),c=t(54),l=t(101),f=t(79),d=t(128)("iterator"),h=!([].keys&&"next"in[].keys()),v=function(){return this};n.exports=function(t,n,e,g,p,y,m){c(e,n,g);var _,b,w,x=function(t){if(!h&&t in T)return T[t];switch(t){case"keys":case"values":return function(){return new e(this,t)}}return function(){return new e(this,t)}},A=n+" Iterator",S="values"==p,k=!1,T=t.prototype,P=T[d]||T["@@iterator"]||p&&T[p],E=P||x(p),I=p?S?x("entries"):E:void 0,C="Array"==n?T.entries||P:P;if(C&&(w=f(C.call(new t)))!==Object.prototype&&w.next&&(l(w,A,!0),r||u(w,d)||a(w,d,v)),S&&P&&"values"!==P.name&&(k=!0,E=function(){return P.call(this)}),r&&!m||!h&&!k&&T[d]||a(T,d,E),s[n]=E,s[A]=v,p)if(_={values:S?E:x("values"),keys:y?E:x("keys"),entries:I},m)for(b in _)b in T||i(T,b,_[b]);else o(o.P+o.F*(h||k),n,_);return _}},{101:101,128:128,33:33,41:41,42:42,54:54,58:58,60:60,79:79,94:94}],56:[function(t,n,e){var r=t(128)("iterator"),o=!1;try{var i=[7][r]();i.return=function(){o=!0},Array.from(i,function(){throw 2})}catch(t){}n.exports=function(t,n){if(!n&&!o)return!1;var e=!1;try{var i=[7],a=i[r]();a.next=function(){return{done:e=!0}},i[r]=function(){return a},t(i)}catch(t){}return e}},{128:128}],57:[function(t,n,e){n.exports=function(t,n){return{value:n,done:!!t}}},{}],58:[function(t,n,e){n.exports={}},{}],59:[function(t,n,e){var r=t(81),o=t(117);n.exports=function(t,n){for(var e,i=o(t),a=r(i),u=a.length,s=0;u>s;)if(i[e=a[s++]]===n)return e}},{117:117,81:81}],60:[function(t,n,e){n.exports=!1},{}],61:[function(t,n,e){var r=Math.expm1;n.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:r},{}],62:[function(t,n,e){var r=t(65),o=Math.pow,i=o(2,-52),a=o(2,-23),u=o(2,127)*(2-a),s=o(2,-126),c=function(t){return t+1/i-1/i};n.exports=Math.fround||function(t){var n,e,o=Math.abs(t),l=r(t);return o<s?l*c(o/s/a)*s*a:(n=(1+a/i)*o,(e=n-(n-o))>u||e!=e?l*(1/0):l*e)}},{65:65}],63:[function(t,n,e){n.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},{}],64:[function(t,n,e){n.exports=Math.scale||function(t,n,e,r,o){return 0===arguments.length||t!=t||n!=n||e!=e||r!=r||o!=o?NaN:t===1/0||t===-1/0?t:(t-n)*(o-r)/(e-n)+r}},{}],65:[function(t,n,e){n.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},{}],66:[function(t,n,e){var r=t(124)("meta"),o=t(51),i=t(41),a=t(72).f,u=0,s=Object.isExtensible||function(){return!0},c=!t(35)(function(){return s(Object.preventExtensions({}))}),l=function(t){a(t,r,{value:{i:"O"+ ++u,w:{}}})},f=n.exports={KEY:r,NEED:!1,fastKey:function(t,n){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,r)){if(!s(t))return"F";if(!n)return"E";l(t)}return t[r].i},getWeak:function(t,n){if(!i(t,r)){if(!s(t))return!0;if(!n)return!1;l(t)}return t[r].w},onFreeze:function(t){return c&&f.NEED&&s(t)&&!i(t,r)&&l(t),t}}},{124:124,35:35,41:41,51:51,72:72}],67:[function(t,n,e){var r=t(160),o=t(33),i=t(103)("metadata"),a=i.store||(i.store=new(t(266))),u=function(t,n,e){var o=a.get(t);if(!o){if(!e)return;a.set(t,o=new r)}var i=o.get(n);if(!i){if(!e)return;o.set(n,i=new r)}return i};n.exports={store:a,map:u,has:function(t,n,e){var r=u(n,e,!1);return void 0!==r&&r.has(t)},get:function(t,n,e){var r=u(n,e,!1);return void 0===r?void 0:r.get(t)},set:function(t,n,e,r){u(e,r,!0).set(t,n)},keys:function(t,n){var e=u(t,n,!1),r=[];return e&&e.forEach(function(t,n){r.push(n)}),r},key:function(t){return void 0===t||"symbol"==typeof t?t:String(t)},exp:function(t){o(o.S,"Reflect",t)}}},{103:103,160:160,266:266,33:33}],68:[function(t,n,e){var r=t(40),o=t(113).set,i=r.MutationObserver||r.WebKitMutationObserver,a=r.process,u=r.Promise,s="process"==t(18)(a);n.exports=function(){var t,n,e,c=function(){var r,o;for(s&&(r=a.domain)&&r.exit();t;){o=t.fn,t=t.next;try{o()}catch(r){throw t?e():n=void 0,r}}n=void 0,r&&r.enter()};if(s)e=function(){a.nextTick(c)};else if(i){var l=!0,f=document.createTextNode("");new i(c).observe(f,{characterData:!0}),e=function(){f.data=l=!l}}else if(u&&u.resolve){var d=u.resolve();e=function(){d.then(c)}}else e=function(){o.call(r,c)};return function(r){var o={fn:r,next:void 0};n&&(n.next=o),t||(t=o,e()),n=o}}},{113:113,18:18,40:40}],69:[function(t,n,e){"use strict";function r(t){var n,e;this.promise=new t(function(t,r){if(void 0!==n||void 0!==e)throw TypeError("Bad Promise constructor");n=t,e=r}),this.resolve=o(n),this.reject=o(e)}var o=t(3);n.exports.f=function(t){return new r(t)}},{3:3}],70:[function(t,n,e){"use strict";var r=t(81),o=t(78),i=t(82),a=t(119),u=t(47),s=Object.assign;n.exports=!s||t(35)(function(){var t={},n={},e=Symbol(),r="abcdefghijklmnopqrst";return t[e]=7,r.split("").forEach(function(t){n[t]=t}),7!=s({},t)[e]||Object.keys(s({},n)).join("")!=r})?function(t,n){for(var e=a(t),s=arguments.length,c=1,l=o.f,f=i.f;s>c;)for(var d,h=u(arguments[c++]),v=l?r(h).concat(l(h)):r(h),g=v.length,p=0;g>p;)f.call(h,d=v[p++])&&(e[d]=h[d]);return e}:s},{119:119,35:35,47:47,78:78,81:81,82:82}],71:[function(t,n,e){var r=t(7),o=t(73),i=t(31),a=t(102)("IE_PROTO"),u=function(){},s=function(){var n,e=t(30)("iframe"),r=i.length;for(e.style.display="none",t(43).appendChild(e),e.src="javascript:",(n=e.contentWindow.document).open(),n.write("<script>document.F=Object<\/script>"),n.close(),s=n.F;r--;)delete s.prototype[i[r]];return s()};n.exports=Object.create||function(t,n){var e;return null!==t?(u.prototype=r(t),e=new u,u.prototype=null,e[a]=t):e=s(),void 0===n?e:o(e,n)}},{102:102,30:30,31:31,43:43,7:7,73:73}],72:[function(t,n,e){var r=t(7),o=t(44),i=t(120),a=Object.defineProperty;e.f=t(29)?Object.defineProperty:function(t,n,e){if(r(t),n=i(n,!0),r(e),o)try{return a(t,n,e)}catch(t){}if("get"in e||"set"in e)throw TypeError("Accessors not supported!");return"value"in e&&(t[n]=e.value),t}},{120:120,29:29,44:44,7:7}],73:[function(t,n,e){var r=t(72),o=t(7),i=t(81);n.exports=t(29)?Object.defineProperties:function(t,n){o(t);for(var e,a=i(n),u=a.length,s=0;u>s;)r.f(t,e=a[s++],n[e]);return t}},{29:29,7:7,72:72,81:81}],74:[function(t,n,e){"use strict";n.exports=t(60)||!t(35)(function(){var n=Math.random();__defineSetter__.call(null,n,function(){}),delete t(40)[n]})},{35:35,40:40,60:60}],75:[function(t,n,e){var r=t(82),o=t(92),i=t(117),a=t(120),u=t(41),s=t(44),c=Object.getOwnPropertyDescriptor;e.f=t(29)?c:function(t,n){if(t=i(t),n=a(n,!0),s)try{return c(t,n)}catch(t){}if(u(t,n))return o(!r.f.call(t,n),t[n])}},{117:117,120:120,29:29,41:41,44:44,82:82,92:92}],76:[function(t,n,e){var r=t(117),o=t(77).f,i={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],u=function(t){try{return o(t)}catch(t){return a.slice()}};n.exports.f=function(t){return a&&"[object Window]"==i.call(t)?u(t):o(r(t))}},{117:117,77:77}],77:[function(t,n,e){var r=t(80),o=t(31).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},{31:31,80:80}],78:[function(t,n,e){e.f=Object.getOwnPropertySymbols},{}],79:[function(t,n,e){var r=t(41),o=t(119),i=t(102)("IE_PROTO"),a=Object.prototype;n.exports=Object.getPrototypeOf||function(t){return t=o(t),r(t,i)?t[i]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},{102:102,119:119,41:41}],80:[function(t,n,e){var r=t(41),o=t(117),i=t(11)(!1),a=t(102)("IE_PROTO");n.exports=function(t,n){var e,u=o(t),s=0,c=[];for(e in u)e!=a&&r(u,e)&&c.push(e);for(;n.length>s;)r(u,e=n[s++])&&(~i(c,e)||c.push(e));return c}},{102:102,11:11,117:117,41:41}],81:[function(t,n,e){var r=t(80),o=t(31);n.exports=Object.keys||function(t){return r(t,o)}},{31:31,80:80}],82:[function(t,n,e){e.f={}.propertyIsEnumerable},{}],83:[function(t,n,e){var r=t(33),o=t(23),i=t(35);n.exports=function(t,n){var e=(o.Object||{})[t]||Object[t],a={};a[t]=n(e),r(r.S+r.F*i(function(){e(1)}),"Object",a)}},{23:23,33:33,35:35}],84:[function(t,n,e){var r=t(81),o=t(117),i=t(82).f;n.exports=function(t){return function(n){for(var e,a=o(n),u=r(a),s=u.length,c=0,l=[];s>c;)i.call(a,e=u[c++])&&l.push(t?[e,a[e]]:a[e]);return l}}},{117:117,81:81,82:82}],85:[function(t,n,e){var r=t(77),o=t(78),i=t(7),a=t(40).Reflect;n.exports=a&&a.ownKeys||function(t){var n=r.f(i(t)),e=o.f;return e?n.concat(e(t)):n}},{40:40,7:7,77:77,78:78}],86:[function(t,n,e){var r=t(40).parseFloat,o=t(111).trim;n.exports=1/r(t(112)+"-0")!=-1/0?function(t){var n=o(String(t),3),e=r(n);return 0===e&&"-"==n.charAt(0)?-0:e}:r},{111:111,112:112,40:40}],87:[function(t,n,e){var r=t(40).parseInt,o=t(111).trim,i=t(112),a=/^[-+]?0[xX]/;n.exports=8!==r(i+"08")||22!==r(i+"0x16")?function(t,n){var e=o(String(t),3);return r(e,n>>>0||(a.test(e)?16:10))}:r},{111:111,112:112,40:40}],88:[function(t,n,e){"use strict";var r=t(89),o=t(46),i=t(3);n.exports=function(){for(var t=i(this),n=arguments.length,e=Array(n),a=0,u=r._,s=!1;n>a;)(e[a]=arguments[a++])===u&&(s=!0);return function(){var r,i=this,a=arguments.length,c=0,l=0;if(!s&&!a)return o(t,e,i);if(r=e.slice(),s)for(;n>c;c++)r[c]===u&&(r[c]=arguments[l++]);for(;a>l;)r.push(arguments[l++]);return o(t,r,i)}}},{3:3,46:46,89:89}],89:[function(t,n,e){n.exports=t(40)},{40:40}],90:[function(t,n,e){n.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},{}],91:[function(t,n,e){var r=t(69);n.exports=function(t,n){var e=r.f(t);return(0,e.resolve)(n),e.promise}},{69:69}],92:[function(t,n,e){n.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},{}],93:[function(t,n,e){var r=t(94);n.exports=function(t,n,e){for(var o in n)r(t,o,n[o],e);return t}},{94:94}],94:[function(t,n,e){var r=t(40),o=t(42),i=t(41),a=t(124)("src"),u=Function.toString,s=(""+u).split("toString");t(23).inspectSource=function(t){return u.call(t)},(n.exports=function(t,n,e,u){var c="function"==typeof e;c&&(i(e,"name")||o(e,"name",n)),t[n]!==e&&(c&&(i(e,a)||o(e,a,t[n]?""+t[n]:s.join(String(n)))),t===r?t[n]=e:u?t[n]?t[n]=e:o(t,n,e):(delete t[n],o(t,n,e)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||u.call(this)})},{124:124,23:23,40:40,41:41,42:42}],95:[function(t,n,e){n.exports=function(t,n){var e=n===Object(n)?function(t){return n[t]}:n;return function(n){return String(n).replace(t,e)}}},{}],96:[function(t,n,e){n.exports=Object.is||function(t,n){return t===n?0!==t||1/t==1/n:t!=t&&n!=n}},{}],97:[function(t,n,e){"use strict";var r=t(33),o=t(3),i=t(25),a=t(39);n.exports=function(t){r(r.S,t,{from:function(t){var n,e,r,u,s=arguments[1];return o(this),(n=void 0!==s)&&o(s),void 0==t?new this:(e=[],n?(r=0,u=i(s,arguments[2],2),a(t,!1,function(t){e.push(u(t,r++))})):a(t,!1,e.push,e),new this(e))}})}},{25:25,3:3,33:33,39:39}],98:[function(t,n,e){"use strict";var r=t(33);n.exports=function(t){r(r.S,t,{of:function(){for(var t=arguments.length,n=Array(t);t--;)n[t]=arguments[t];return new this(n)}})}},{33:33}],99:[function(t,n,e){var r=t(51),o=t(7),i=function(t,n){if(o(t),!r(n)&&null!==n)throw TypeError(n+": can't set as prototype!")};n.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(n,e,r){try{(r=t(25)(Function.call,t(75).f(Object.prototype,"__proto__").set,2))(n,[]),e=!(n instanceof Array)}catch(t){e=!0}return function(t,n){return i(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:i}},{25:25,51:51,7:7,75:75}],100:[function(t,n,e){"use strict";var r=t(40),o=t(72),i=t(29),a=t(128)("species");n.exports=function(t){var n=r[t];i&&n&&!n[a]&&o.f(n,a,{configurable:!0,get:function(){return this}})}},{128:128,29:29,40:40,72:72}],101:[function(t,n,e){var r=t(72).f,o=t(41),i=t(128)("toStringTag");n.exports=function(t,n,e){t&&!o(t=e?t:t.prototype,i)&&r(t,i,{configurable:!0,value:n})}},{128:128,41:41,72:72}],102:[function(t,n,e){var r=t(103)("keys"),o=t(124);n.exports=function(t){return r[t]||(r[t]=o(t))}},{103:103,124:124}],103:[function(t,n,e){var r=t(40),o=r["__core-js_shared__"]||(r["__core-js_shared__"]={});n.exports=function(t){return o[t]||(o[t]={})}},{40:40}],104:[function(t,n,e){var r=t(7),o=t(3),i=t(128)("species");n.exports=function(t,n){var e,a=r(t).constructor;return void 0===a||void 0==(e=r(a)[i])?n:o(e)}},{128:128,3:3,7:7}],105:[function(t,n,e){"use strict";var r=t(35);n.exports=function(t,n){return!!t&&r(function(){n?t.call(null,function(){},1):t.call(null)})}},{35:35}],106:[function(t,n,e){var r=t(116),o=t(28);n.exports=function(t){return function(n,e){var i,a,u=String(o(n)),s=r(e),c=u.length;return s<0||s>=c?t?"":void 0:(i=u.charCodeAt(s))<55296||i>56319||s+1===c||(a=u.charCodeAt(s+1))<56320||a>57343?t?u.charAt(s):i:t?u.slice(s,s+2):a-56320+(i-55296<<10)+65536}}},{116:116,28:28}],107:[function(t,n,e){var r=t(52),o=t(28);n.exports=function(t,n,e){if(r(n))throw TypeError("String#"+e+" doesn't accept regex!");return String(o(t))}},{28:28,52:52}],108:[function(t,n,e){var r=t(33),o=t(35),i=t(28),a=/"/g,u=function(t,n,e,r){var o=String(i(t)),u="<"+n;return""!==e&&(u+=" "+e+'="'+String(r).replace(a,"&quot;")+'"'),u+">"+o+"</"+n+">"};n.exports=function(t,n){var e={};e[t]=n(u),r(r.P+r.F*o(function(){var n=""[t]('"');return n!==n.toLowerCase()||n.split('"').length>3}),"String",e)}},{28:28,33:33,35:35}],109:[function(t,n,e){var r=t(118),o=t(110),i=t(28);n.exports=function(t,n,e,a){var u=String(i(t)),s=u.length,c=void 0===e?" ":String(e),l=r(n);if(l<=s||""==c)return u;var f=l-s,d=o.call(c,Math.ceil(f/c.length));return d.length>f&&(d=d.slice(0,f)),a?d+u:u+d}},{110:110,118:118,28:28}],110:[function(t,n,e){"use strict";var r=t(116),o=t(28);n.exports=function(t){var n=String(o(this)),e="",i=r(t);if(i<0||i==1/0)throw RangeError("Count can't be negative");for(;i>0;(i>>>=1)&&(n+=n))1&i&&(e+=n);return e}},{116:116,28:28}],111:[function(t,n,e){var r=t(33),o=t(28),i=t(35),a=t(112),u="["+a+"]",s=RegExp("^"+u+u+"*"),c=RegExp(u+u+"*$"),l=function(t,n,e){var o={},u=i(function(){return!!a[t]()||""!=""[t]()}),s=o[t]=u?n(f):a[t];e&&(o[e]=s),r(r.P+r.F*u,"String",o)},f=l.trim=function(t,n){return t=String(o(t)),1&n&&(t=t.replace(s,"")),2&n&&(t=t.replace(c,"")),t};n.exports=l},{112:112,28:28,33:33,35:35}],112:[function(t,n,e){n.exports="\t\n\v\f\r \u2028\u2029\ufeff"},{}],113:[function(t,n,e){var r,o,i,a=t(25),u=t(46),s=t(43),c=t(30),l=t(40),f=l.process,d=l.setImmediate,h=l.clearImmediate,v=l.MessageChannel,g=l.Dispatch,p=0,y={},m=function(){var t=+this;if(y.hasOwnProperty(t)){var n=y[t];delete y[t],n()}},_=function(t){m.call(t.data)};d&&h||(d=function(t){for(var n=[],e=1;arguments.length>e;)n.push(arguments[e++]);return y[++p]=function(){u("function"==typeof t?t:Function(t),n)},r(p),p},h=function(t){delete y[t]},"process"==t(18)(f)?r=function(t){f.nextTick(a(m,t,1))}:g&&g.now?r=function(t){g.now(a(m,t,1))}:v?(i=(o=new v).port2,o.port1.onmessage=_,r=a(i.postMessage,i,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(t){l.postMessage(t+"","*")},l.addEventListener("message",_,!1)):r="onreadystatechange"in c("script")?function(t){s.appendChild(c("script")).onreadystatechange=function(){s.removeChild(this),m.call(t)}}:function(t){setTimeout(a(m,t,1),0)}),n.exports={set:d,clear:h}},{18:18,25:25,30:30,40:40,43:43,46:46}],114:[function(t,n,e){var r=t(116),o=Math.max,i=Math.min;n.exports=function(t,n){return(t=r(t))<0?o(t+n,0):i(t,n)}},{116:116}],115:[function(t,n,e){var r=t(116),o=t(118);n.exports=function(t){if(void 0===t)return 0;var n=r(t),e=o(n);if(n!==e)throw RangeError("Wrong length!");return e}},{116:116,118:118}],116:[function(t,n,e){var r=Math.ceil,o=Math.floor;n.exports=function(t){return isNaN(t=+t)?0:(t>0?o:r)(t)}},{}],117:[function(t,n,e){var r=t(47),o=t(28);n.exports=function(t){return r(o(t))}},{28:28,47:47}],118:[function(t,n,e){var r=t(116),o=Math.min;n.exports=function(t){return t>0?o(r(t),9007199254740991):0}},{116:116}],119:[function(t,n,e){var r=t(28);n.exports=function(t){return Object(r(t))}},{28:28}],120:[function(t,n,e){var r=t(51);n.exports=function(t,n){if(!r(t))return t;var e,o;if(n&&"function"==typeof(e=t.toString)&&!r(o=e.call(t)))return o;if("function"==typeof(e=t.valueOf)&&!r(o=e.call(t)))return o;if(!n&&"function"==typeof(e=t.toString)&&!r(o=e.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},{51:51}],121:[function(t,n,e){"use strict";if(t(29)){var r=t(60),o=t(40),i=t(35),a=t(33),u=t(123),s=t(122),c=t(25),l=t(6),f=t(92),d=t(42),h=t(93),v=t(116),g=t(118),p=t(115),y=t(114),m=t(120),_=t(41),b=t(17),w=t(51),x=t(119),A=t(48),S=t(71),k=t(79),T=t(77).f,P=t(129),E=t(124),I=t(128),C=t(12),O=t(11),M=t(104),j=t(141),R=t(58),L=t(56),N=t(100),W=t(9),D=t(8),B=t(72),F=t(75),U=B.f,H=F.f,Q=o.RangeError,Y=o.TypeError,z=o.Uint8Array,V=Array.prototype,G=s.ArrayBuffer,q=s.DataView,K=C(0),J=C(2),$=C(3),X=C(4),Z=C(5),tt=C(6),nt=O(!0),et=O(!1),rt=j.values,ot=j.keys,it=j.entries,at=V.lastIndexOf,ut=V.reduce,st=V.reduceRight,ct=V.join,lt=V.sort,ft=V.slice,dt=V.toString,ht=V.toLocaleString,vt=I("iterator"),gt=I("toStringTag"),pt=E("typed_constructor"),yt=E("def_constructor"),mt=u.CONSTR,_t=u.TYPED,bt=u.VIEW,wt=C(1,function(t,n){return Tt(M(t,t[yt]),n)}),xt=i(function(){return 1===new z(new Uint16Array([1]).buffer)[0]}),At=!!z&&!!z.prototype.set&&i(function(){new z(1).set({})}),St=function(t,n){var e=v(t);if(e<0||e%n)throw Q("Wrong offset!");return e},kt=function(t){if(w(t)&&_t in t)return t;throw Y(t+" is not a typed array!")},Tt=function(t,n){if(!(w(t)&&pt in t))throw Y("It is not a typed array constructor!");return new t(n)},Pt=function(t,n){return Et(M(t,t[yt]),n)},Et=function(t,n){for(var e=0,r=n.length,o=Tt(t,r);r>e;)o[e]=n[e++];return o},It=function(t,n,e){U(t,n,{get:function(){return this._d[e]}})},Ct=function(t){var n,e,r,o,i,a,u=x(t),s=arguments.length,l=s>1?arguments[1]:void 0,f=void 0!==l,d=P(u);if(void 0!=d&&!A(d)){for(a=d.call(u),r=[],n=0;!(i=a.next()).done;n++)r.push(i.value);u=r}for(f&&s>2&&(l=c(l,arguments[2],2)),n=0,e=g(u.length),o=Tt(this,e);e>n;n++)o[n]=f?l(u[n],n):u[n];return o},Ot=function(){for(var t=0,n=arguments.length,e=Tt(this,n);n>t;)e[t]=arguments[t++];return e},Mt=!!z&&i(function(){ht.call(new z(1))}),jt=function(){return ht.apply(Mt?ft.call(kt(this)):kt(this),arguments)},Rt={copyWithin:function(t,n){return D.call(kt(this),t,n,arguments.length>2?arguments[2]:void 0)},every:function(t){return X(kt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return W.apply(kt(this),arguments)},filter:function(t){return Pt(this,J(kt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return Z(kt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return tt(kt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){K(kt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return et(kt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return nt(kt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ct.apply(kt(this),arguments)},lastIndexOf:function(t){return at.apply(kt(this),arguments)},map:function(t){return wt(kt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return ut.apply(kt(this),arguments)},reduceRight:function(t){return st.apply(kt(this),arguments)},reverse:function(){for(var t,n=this,e=kt(n).length,r=Math.floor(e/2),o=0;o<r;)t=n[o],n[o++]=n[--e],n[e]=t;return n},some:function(t){return $(kt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return lt.call(kt(this),t)},subarray:function(t,n){var e=kt(this),r=e.length,o=y(t,r);return new(M(e,e[yt]))(e.buffer,e.byteOffset+o*e.BYTES_PER_ELEMENT,g((void 0===n?r:y(n,r))-o))}},Lt=function(t,n){return Pt(this,ft.call(kt(this),t,n))},Nt=function(t){kt(this);var n=St(arguments[1],1),e=this.length,r=x(t),o=g(r.length),i=0;if(o+n>e)throw Q("Wrong length!");for(;i<o;)this[n+i]=r[i++]},Wt={entries:function(){return it.call(kt(this))},keys:function(){return ot.call(kt(this))},values:function(){return rt.call(kt(this))}},Dt=function(t,n){return w(t)&&t[_t]&&"symbol"!=typeof n&&n in t&&String(+n)==String(n)},Bt=function(t,n){return Dt(t,n=m(n,!0))?f(2,t[n]):H(t,n)},Ft=function(t,n,e){return!(Dt(t,n=m(n,!0))&&w(e)&&_(e,"value"))||_(e,"get")||_(e,"set")||e.configurable||_(e,"writable")&&!e.writable||_(e,"enumerable")&&!e.enumerable?U(t,n,e):(t[n]=e.value,t)};mt||(F.f=Bt,B.f=Ft),a(a.S+a.F*!mt,"Object",{getOwnPropertyDescriptor:Bt,defineProperty:Ft}),i(function(){dt.call({})})&&(dt=ht=function(){return ct.call(this)});var Ut=h({},Rt);h(Ut,Wt),d(Ut,vt,Wt.values),h(Ut,{slice:Lt,set:Nt,constructor:function(){},toString:dt,toLocaleString:jt}),It(Ut,"buffer","b"),It(Ut,"byteOffset","o"),It(Ut,"byteLength","l"),It(Ut,"length","e"),U(Ut,gt,{get:function(){return this[_t]}}),n.exports=function(t,n,e,s){var c=t+((s=!!s)?"Clamped":"")+"Array",f="get"+t,h="set"+t,v=o[c],y=v||{},m=v&&k(v),_=!v||!u.ABV,x={},A=v&&v.prototype,P=function(t,e){var r=t._d;return r.v[f](e*n+r.o,xt)},E=function(t,e,r){var o=t._d;s&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),o.v[h](e*n+o.o,r,xt)},I=function(t,n){U(t,n,{get:function(){return P(this,n)},set:function(t){return E(this,n,t)},enumerable:!0})};_?(v=e(function(t,e,r,o){l(t,v,c,"_d");var i,a,u,s,f=0,h=0;if(w(e)){if(!(e instanceof G||"ArrayBuffer"==(s=b(e))||"SharedArrayBuffer"==s))return _t in e?Et(v,e):Ct.call(v,e);i=e,h=St(r,n);var y=e.byteLength;if(void 0===o){if(y%n)throw Q("Wrong length!");if((a=y-h)<0)throw Q("Wrong length!")}else if((a=g(o)*n)+h>y)throw Q("Wrong length!");u=a/n}else u=p(e),i=new G(a=u*n);for(d(t,"_d",{b:i,o:h,l:a,e:u,v:new q(i)});f<u;)I(t,f++)}),A=v.prototype=S(Ut),d(A,"constructor",v)):i(function(){v(1)})&&i(function(){new v(-1)})&&L(function(t){new v,new v(null),new v(1.5),new v(t)},!0)||(v=e(function(t,e,r,o){l(t,v,c);var i;return w(e)?e instanceof G||"ArrayBuffer"==(i=b(e))||"SharedArrayBuffer"==i?void 0!==o?new y(e,St(r,n),o):void 0!==r?new y(e,St(r,n)):new y(e):_t in e?Et(v,e):Ct.call(v,e):new y(p(e))}),K(m!==Function.prototype?T(y).concat(T(m)):T(y),function(t){t in v||d(v,t,y[t])}),v.prototype=A,r||(A.constructor=v));var C=A[vt],O=!!C&&("values"==C.name||void 0==C.name),M=Wt.values;d(v,pt,!0),d(A,_t,c),d(A,bt,!0),d(A,yt,v),(s?new v(1)[gt]==c:gt in A)||U(A,gt,{get:function(){return c}}),x[c]=v,a(a.G+a.W+a.F*(v!=y),x),a(a.S,c,{BYTES_PER_ELEMENT:n}),a(a.S+a.F*i(function(){y.of.call(v,1)}),c,{from:Ct,of:Ot}),"BYTES_PER_ELEMENT"in A||d(A,"BYTES_PER_ELEMENT",n),a(a.P,c,Rt),N(c),a(a.P+a.F*At,c,{set:Nt}),a(a.P+a.F*!O,c,Wt),r||A.toString==dt||(A.toString=dt),a(a.P+a.F*i(function(){new v(1).slice()}),c,{slice:Lt}),a(a.P+a.F*(i(function(){return[1,2].toLocaleString()!=new v([1,2]).toLocaleString()})||!i(function(){A.toLocaleString.call([1,2])})),c,{toLocaleString:jt}),R[c]=O?C:M,r||O||d(A,vt,M)}}else n.exports=function(){}},{100:100,104:104,11:11,114:114,115:115,116:116,118:118,119:119,12:12,120:120,122:122,123:123,124:124,128:128,129:129,141:141,17:17,25:25,29:29,33:33,35:35,40:40,41:41,42:42,48:48,51:51,56:56,58:58,6:6,60:60,71:71,72:72,75:75,77:77,79:79,8:8,9:9,92:92,93:93}],122:[function(t,n,e){"use strict";function r(t,n,e){var r,o,i,a=Array(e),u=8*e-n-1,s=(1<<u)-1,c=s>>1,l=23===n?D(2,-24)-D(2,-77):0,f=0,d=t<0||0===t&&1/t<0?1:0;for((t=W(t))!=t||t===L?(o=t!=t?1:0,r=s):(r=B(F(t)/U),t*(i=D(2,-r))<1&&(r--,i*=2),(t+=r+c>=1?l/i:l*D(2,1-c))*i>=2&&(r++,i/=2),r+c>=s?(o=0,r=s):r+c>=1?(o=(t*i-1)*D(2,n),r+=c):(o=t*D(2,c-1)*D(2,n),r=0));n>=8;a[f++]=255&o,o/=256,n-=8);for(r=r<<n|o,u+=n;u>0;a[f++]=255&r,r/=256,u-=8);return a[--f]|=128*d,a}function o(t,n,e){var r,o=8*e-n-1,i=(1<<o)-1,a=i>>1,u=o-7,s=e-1,c=t[s--],l=127&c;for(c>>=7;u>0;l=256*l+t[s],s--,u-=8);for(r=l&(1<<-u)-1,l>>=-u,u+=n;u>0;r=256*r+t[s],s--,u-=8);if(0===l)l=1-a;else{if(l===i)return r?NaN:c?-L:L;r+=D(2,n),l-=a}return(c?-1:1)*r*D(2,l-n)}function i(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function a(t){return[255&t]}function u(t){return[255&t,t>>8&255]}function s(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function c(t){return r(t,52,8)}function l(t){return r(t,23,4)}function f(t,n,e){T(t[I],n,{get:function(){return this[e]}})}function d(t,n,e,r){var o=S(+e);if(o+n>t[Q])throw R(C);var i=t[H]._b,a=o+t[Y],u=i.slice(a,a+n);return r?u:u.reverse()}function h(t,n,e,r,o,i){var a=S(+e);if(a+n>t[Q])throw R(C);for(var u=t[H]._b,s=a+t[Y],c=r(+o),l=0;l<n;l++)u[s+l]=c[i?l:n-l-1]}var v=t(40),g=t(29),p=t(60),y=t(123),m=t(42),_=t(93),b=t(35),w=t(6),x=t(116),A=t(118),S=t(115),k=t(77).f,T=t(72).f,P=t(9),E=t(101),I="prototype",C="Wrong index!",O=v.ArrayBuffer,M=v.DataView,j=v.Math,R=v.RangeError,L=v.Infinity,N=O,W=j.abs,D=j.pow,B=j.floor,F=j.log,U=j.LN2,H=g?"_b":"buffer",Q=g?"_l":"byteLength",Y=g?"_o":"byteOffset";if(y.ABV){if(!b(function(){O(1)})||!b(function(){new O(-1)})||b(function(){return new O,new O(1.5),new O(NaN),"ArrayBuffer"!=O.name})){for(var z,V=(O=function(t){return w(this,O),new N(S(t))})[I]=N[I],G=k(N),q=0;G.length>q;)(z=G[q++])in O||m(O,z,N[z]);p||(V.constructor=O)}var K=new M(new O(2)),J=M[I].setInt8;K.setInt8(0,2147483648),K.setInt8(1,2147483649),!K.getInt8(0)&&K.getInt8(1)||_(M[I],{setInt8:function(t,n){J.call(this,t,n<<24>>24)},setUint8:function(t,n){J.call(this,t,n<<24>>24)}},!0)}else O=function(t){w(this,O,"ArrayBuffer");var n=S(t);this._b=P.call(Array(n),0),this[Q]=n},M=function(t,n,e){w(this,M,"DataView"),w(t,O,"DataView");var r=t[Q],o=x(n);if(o<0||o>r)throw R("Wrong offset!");if(e=void 0===e?r-o:A(e),o+e>r)throw R("Wrong length!");this[H]=t,this[Y]=o,this[Q]=e},g&&(f(O,"byteLength","_l"),f(M,"buffer","_b"),f(M,"byteLength","_l"),f(M,"byteOffset","_o")),_(M[I],{getInt8:function(t){return d(this,1,t)[0]<<24>>24},getUint8:function(t){return d(this,1,t)[0]},getInt16:function(t){var n=d(this,2,t,arguments[1]);return(n[1]<<8|n[0])<<16>>16},getUint16:function(t){var n=d(this,2,t,arguments[1]);return n[1]<<8|n[0]},getInt32:function(t){return i(d(this,4,t,arguments[1]))},getUint32:function(t){return i(d(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return o(d(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return o(d(this,8,t,arguments[1]),52,8)},setInt8:function(t,n){h(this,1,t,a,n)},setUint8:function(t,n){h(this,1,t,a,n)},setInt16:function(t,n){h(this,2,t,u,n,arguments[2])},setUint16:function(t,n){h(this,2,t,u,n,arguments[2])},setInt32:function(t,n){h(this,4,t,s,n,arguments[2])},setUint32:function(t,n){h(this,4,t,s,n,arguments[2])},setFloat32:function(t,n){h(this,4,t,l,n,arguments[2])},setFloat64:function(t,n){h(this,8,t,c,n,arguments[2])}});E(O,"ArrayBuffer"),E(M,"DataView"),m(M[I],y.VIEW,!0),e.ArrayBuffer=O,e.DataView=M},{101:101,115:115,116:116,118:118,123:123,29:29,35:35,40:40,42:42,6:6,60:60,72:72,77:77,9:9,93:93}],123:[function(t,n,e){for(var r,o=t(40),i=t(42),a=t(124),u=a("typed_array"),s=a("view"),c=!(!o.ArrayBuffer||!o.DataView),l=c,f=0,d="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");f<9;)(r=o[d[f++]])?(i(r.prototype,u,!0),i(r.prototype,s,!0)):l=!1;n.exports={ABV:c,CONSTR:l,TYPED:u,VIEW:s}},{124:124,40:40,42:42}],124:[function(t,n,e){var r=0,o=Math.random();n.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+o).toString(36))}},{}],125:[function(t,n,e){var r=t(51);n.exports=function(t,n){if(!r(t)||t._t!==n)throw TypeError("Incompatible receiver, "+n+" required!");return t}},{51:51}],126:[function(t,n,e){var r=t(40),o=t(23),i=t(60),a=t(127),u=t(72).f;n.exports=function(t){var n=o.Symbol||(o.Symbol=i?{}:r.Symbol||{});"_"==t.charAt(0)||t in n||u(n,t,{value:a.f(t)})}},{127:127,23:23,40:40,60:60,72:72}],127:[function(t,n,e){e.f=t(128)},{128:128}],128:[function(t,n,e){var r=t(103)("wks"),o=t(124),i=t(40).Symbol,a="function"==typeof i;(n.exports=function(t){return r[t]||(r[t]=a&&i[t]||(a?i:o)("Symbol."+t))}).store=r},{103:103,124:124,40:40}],129:[function(t,n,e){var r=t(17),o=t(128)("iterator"),i=t(58);n.exports=t(23).getIteratorMethod=function(t){if(void 0!=t)return t[o]||t["@@iterator"]||i[r(t)]}},{128:128,17:17,23:23,58:58}],130:[function(t,n,e){var r=t(33),o=t(95)(/[\\^$*+?.()|[\]{}]/g,"\\$&");r(r.S,"RegExp",{escape:function(t){return o(t)}})},{33:33,95:95}],131:[function(t,n,e){var r=t(33);r(r.P,"Array",{copyWithin:t(8)}),t(5)("copyWithin")},{33:33,5:5,8:8}],132:[function(t,n,e){"use strict";var r=t(33),o=t(12)(4);r(r.P+r.F*!t(105)([].every,!0),"Array",{every:function(t){return o(this,t,arguments[1])}})},{105:105,12:12,33:33}],133:[function(t,n,e){var r=t(33);r(r.P,"Array",{fill:t(9)}),t(5)("fill")},{33:33,5:5,9:9}],134:[function(t,n,e){"use strict";var r=t(33),o=t(12)(2);r(r.P+r.F*!t(105)([].filter,!0),"Array",{filter:function(t){return o(this,t,arguments[1])}})},{105:105,12:12,33:33}],135:[function(t,n,e){"use strict";var r=t(33),o=t(12)(6),i="findIndex",a=!0;i in[]&&Array(1)[i](function(){a=!1}),r(r.P+r.F*a,"Array",{findIndex:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),t(5)(i)},{12:12,33:33,5:5}],136:[function(t,n,e){"use strict";var r=t(33),o=t(12)(5),i=!0;"find"in[]&&Array(1).find(function(){i=!1}),r(r.P+r.F*i,"Array",{find:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),t(5)("find")},{12:12,33:33,5:5}],137:[function(t,n,e){"use strict";var r=t(33),o=t(12)(0),i=t(105)([].forEach,!0);r(r.P+r.F*!i,"Array",{forEach:function(t){return o(this,t,arguments[1])}})},{105:105,12:12,33:33}],138:[function(t,n,e){"use strict";var r=t(25),o=t(33),i=t(119),a=t(53),u=t(48),s=t(118),c=t(24),l=t(129);o(o.S+o.F*!t(56)(function(t){Array.from(t)}),"Array",{from:function(t){var n,e,o,f,d=i(t),h="function"==typeof this?this:Array,v=arguments.length,g=v>1?arguments[1]:void 0,p=void 0!==g,y=0,m=l(d);if(p&&(g=r(g,v>2?arguments[2]:void 0,2)),void 0==m||h==Array&&u(m))for(e=new h(n=s(d.length));n>y;y++)c(e,y,p?g(d[y],y):d[y]);else for(f=m.call(d),e=new h;!(o=f.next()).done;y++)c(e,y,p?a(f,g,[o.value,y],!0):o.value);return e.length=y,e}})},{118:118,119:119,129:129,24:24,25:25,33:33,48:48,53:53,56:56}],139:[function(t,n,e){"use strict";var r=t(33),o=t(11)(!1),i=[].indexOf,a=!!i&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(a||!t(105)(i)),"Array",{indexOf:function(t){return a?i.apply(this,arguments)||0:o(this,t,arguments[1])}})},{105:105,11:11,33:33}],140:[function(t,n,e){var r=t(33);r(r.S,"Array",{isArray:t(49)})},{33:33,49:49}],141:[function(t,n,e){"use strict";var r=t(5),o=t(57),i=t(58),a=t(117);n.exports=t(55)(Array,"Array",function(t,n){this._t=a(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,e=this._i++;return!t||e>=t.length?(this._t=void 0,o(1)):"keys"==n?o(0,e):"values"==n?o(0,t[e]):o(0,[e,t[e]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},{117:117,5:5,55:55,57:57,58:58}],142:[function(t,n,e){"use strict";var r=t(33),o=t(117),i=[].join;r(r.P+r.F*(t(47)!=Object||!t(105)(i)),"Array",{join:function(t){return i.call(o(this),void 0===t?",":t)}})},{105:105,117:117,33:33,47:47}],143:[function(t,n,e){"use strict";var r=t(33),o=t(117),i=t(116),a=t(118),u=[].lastIndexOf,s=!!u&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(s||!t(105)(u)),"Array",{lastIndexOf:function(t){if(s)return u.apply(this,arguments)||0;var n=o(this),e=a(n.length),r=e-1;for(arguments.length>1&&(r=Math.min(r,i(arguments[1]))),r<0&&(r=e+r);r>=0;r--)if(r in n&&n[r]===t)return r||0;return-1}})},{105:105,116:116,117:117,118:118,33:33}],144:[function(t,n,e){"use strict";var r=t(33),o=t(12)(1);r(r.P+r.F*!t(105)([].map,!0),"Array",{map:function(t){return o(this,t,arguments[1])}})},{105:105,12:12,33:33}],145:[function(t,n,e){"use strict";var r=t(33),o=t(24);r(r.S+r.F*t(35)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,n=arguments.length,e=new("function"==typeof this?this:Array)(n);n>t;)o(e,t,arguments[t++]);return e.length=n,e}})},{24:24,33:33,35:35}],146:[function(t,n,e){"use strict";var r=t(33),o=t(13);r(r.P+r.F*!t(105)([].reduceRight,!0),"Array",{reduceRight:function(t){return o(this,t,arguments.length,arguments[1],!0)}})},{105:105,13:13,33:33}],147:[function(t,n,e){"use strict";var r=t(33),o=t(13);r(r.P+r.F*!t(105)([].reduce,!0),"Array",{reduce:function(t){return o(this,t,arguments.length,arguments[1],!1)}})},{105:105,13:13,33:33}],148:[function(t,n,e){"use strict";var r=t(33),o=t(43),i=t(18),a=t(114),u=t(118),s=[].slice;r(r.P+r.F*t(35)(function(){o&&s.call(o)}),"Array",{slice:function(t,n){var e=u(this.length),r=i(this);if(n=void 0===n?e:n,"Array"==r)return s.call(this,t,n);for(var o=a(t,e),c=a(n,e),l=u(c-o),f=Array(l),d=0;d<l;d++)f[d]="String"==r?this.charAt(o+d):this[o+d];return f}})},{114:114,118:118,18:18,33:33,35:35,43:43}],149:[function(t,n,e){"use strict";var r=t(33),o=t(12)(3);r(r.P+r.F*!t(105)([].some,!0),"Array",{some:function(t){return o(this,t,arguments[1])}})},{105:105,12:12,33:33}],150:[function(t,n,e){"use strict";var r=t(33),o=t(3),i=t(119),a=t(35),u=[].sort,s=[1,2,3];r(r.P+r.F*(a(function(){s.sort(void 0)})||!a(function(){s.sort(null)})||!t(105)(u)),"Array",{sort:function(t){return void 0===t?u.call(i(this)):u.call(i(this),o(t))}})},{105:105,119:119,3:3,33:33,35:35}],151:[function(t,n,e){t(100)("Array")},{100:100}],152:[function(t,n,e){var r=t(33);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},{33:33}],153:[function(t,n,e){var r=t(33),o=t(26);r(r.P+r.F*(Date.prototype.toISOString!==o),"Date",{toISOString:o})},{26:26,33:33}],154:[function(t,n,e){"use strict";var r=t(33),o=t(119),i=t(120);r(r.P+r.F*t(35)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var n=o(this),e=i(n);return"number"!=typeof e||isFinite(e)?n.toISOString():null}})},{119:119,120:120,33:33,35:35}],155:[function(t,n,e){var r=t(128)("toPrimitive"),o=Date.prototype;r in o||t(42)(o,r,t(27))},{128:128,27:27,42:42}],156:[function(t,n,e){var r=Date.prototype,o=r.toString,i=r.getTime;new Date(NaN)+""!="Invalid Date"&&t(94)(r,"toString",function(){var t=i.call(this);return t==t?o.call(this):"Invalid Date"})},{94:94}],157:[function(t,n,e){var r=t(33);r(r.P,"Function",{bind:t(16)})},{16:16,33:33}],158:[function(t,n,e){"use strict";var r=t(51),o=t(79),i=t(128)("hasInstance"),a=Function.prototype;i in a||t(72).f(a,i,{value:function(t){if("function"!=typeof this||!r(t))return!1;if(!r(this.prototype))return t instanceof this;for(;t=o(t);)if(this.prototype===t)return!0;return!1}})},{128:128,51:51,72:72,79:79}],159:[function(t,n,e){var r=t(72).f,o=Function.prototype,i=/^\s*function ([^ (]*)/;"name"in o||t(29)&&r(o,"name",{configurable:!0,get:function(){try{return(""+this).match(i)[1]}catch(t){return""}}})},{29:29,72:72}],160:[function(t,n,e){"use strict";var r=t(19),o=t(125);n.exports=t(22)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var n=r.getEntry(o(this,"Map"),t);return n&&n.v},set:function(t,n){return r.def(o(this,"Map"),0===t?0:t,n)}},r,!0)},{125:125,19:19,22:22}],161:[function(t,n,e){var r=t(33),o=t(63),i=Math.sqrt,a=Math.acosh;r(r.S+r.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:o(t-1+i(t-1)*i(t+1))}})},{33:33,63:63}],162:[function(t,n,e){function r(t){return isFinite(t=+t)&&0!=t?t<0?-r(-t):Math.log(t+Math.sqrt(t*t+1)):t}var o=t(33),i=Math.asinh;o(o.S+o.F*!(i&&1/i(0)>0),"Math",{asinh:r})},{33:33}],163:[function(t,n,e){var r=t(33),o=Math.atanh;r(r.S+r.F*!(o&&1/o(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},{33:33}],164:[function(t,n,e){var r=t(33),o=t(65);r(r.S,"Math",{cbrt:function(t){return o(t=+t)*Math.pow(Math.abs(t),1/3)}})},{33:33,65:65}],165:[function(t,n,e){var r=t(33);r(r.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},{33:33}],166:[function(t,n,e){var r=t(33),o=Math.exp;r(r.S,"Math",{cosh:function(t){return(o(t=+t)+o(-t))/2}})},{33:33}],167:[function(t,n,e){var r=t(33),o=t(61);r(r.S+r.F*(o!=Math.expm1),"Math",{expm1:o})},{33:33,61:61}],168:[function(t,n,e){var r=t(33);r(r.S,"Math",{fround:t(62)})},{33:33,62:62}],169:[function(t,n,e){var r=t(33),o=Math.abs;r(r.S,"Math",{hypot:function(t,n){for(var e,r,i=0,a=0,u=arguments.length,s=0;a<u;)s<(e=o(arguments[a++]))?(i=i*(r=s/e)*r+1,s=e):i+=e>0?(r=e/s)*r:e;return s===1/0?1/0:s*Math.sqrt(i)}})},{33:33}],170:[function(t,n,e){var r=t(33),o=Math.imul;r(r.S+r.F*t(35)(function(){return-5!=o(4294967295,5)||2!=o.length}),"Math",{imul:function(t,n){var e=+t,r=+n,o=65535&e,i=65535&r;return 0|o*i+((65535&e>>>16)*i+o*(65535&r>>>16)<<16>>>0)}})},{33:33,35:35}],171:[function(t,n,e){var r=t(33);r(r.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},{33:33}],172:[function(t,n,e){var r=t(33);r(r.S,"Math",{log1p:t(63)})},{33:33,63:63}],173:[function(t,n,e){var r=t(33);r(r.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},{33:33}],174:[function(t,n,e){var r=t(33);r(r.S,"Math",{sign:t(65)})},{33:33,65:65}],175:[function(t,n,e){var r=t(33),o=t(61),i=Math.exp;r(r.S+r.F*t(35)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(o(t)-o(-t))/2:(i(t-1)-i(-t-1))*(Math.E/2)}})},{33:33,35:35,61:61}],176:[function(t,n,e){var r=t(33),o=t(61),i=Math.exp;r(r.S,"Math",{tanh:function(t){var n=o(t=+t),e=o(-t);return n==1/0?1:e==1/0?-1:(n-e)/(i(t)+i(-t))}})},{33:33,61:61}],177:[function(t,n,e){var r=t(33);r(r.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},{33:33}],178:[function(t,n,e){"use strict";var r=t(40),o=t(41),i=t(18),a=t(45),u=t(120),s=t(35),c=t(77).f,l=t(75).f,f=t(72).f,d=t(111).trim,h=r.Number,v=h,g=h.prototype,p="Number"==i(t(71)(g)),y="trim"in String.prototype,m=function(t){var n=u(t,!1);if("string"==typeof n&&n.length>2){var e,r,o,i=(n=y?n.trim():d(n,3)).charCodeAt(0);if(43===i||45===i){if(88===(e=n.charCodeAt(2))||120===e)return NaN}else if(48===i){switch(n.charCodeAt(1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+n}for(var a,s=n.slice(2),c=0,l=s.length;c<l;c++)if((a=s.charCodeAt(c))<48||a>o)return NaN;return parseInt(s,r)}}return+n};if(!h(" 0o1")||!h("0b1")||h("+0x1")){h=function(t){var n=arguments.length<1?0:t,e=this;return e instanceof h&&(p?s(function(){g.valueOf.call(e)}):"Number"!=i(e))?a(new v(m(n)),e,h):m(n)};for(var _,b=t(29)?c(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;b.length>w;w++)o(v,_=b[w])&&!o(h,_)&&f(h,_,l(v,_));h.prototype=g,g.constructor=h,t(94)(r,"Number",h)}},{111:111,120:120,18:18,29:29,35:35,40:40,41:41,45:45,71:71,72:72,75:75,77:77,94:94}],179:[function(t,n,e){var r=t(33);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},{33:33}],180:[function(t,n,e){var r=t(33),o=t(40).isFinite;r(r.S,"Number",{isFinite:function(t){return"number"==typeof t&&o(t)}})},{33:33,40:40}],181:[function(t,n,e){var r=t(33);r(r.S,"Number",{isInteger:t(50)})},{33:33,50:50}],182:[function(t,n,e){var r=t(33);r(r.S,"Number",{isNaN:function(t){return t!=t}})},{33:33}],183:[function(t,n,e){var r=t(33),o=t(50),i=Math.abs;r(r.S,"Number",{isSafeInteger:function(t){return o(t)&&i(t)<=9007199254740991}})},{33:33,50:50}],184:[function(t,n,e){var r=t(33);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},{33:33}],185:[function(t,n,e){var r=t(33);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},{33:33}],186:[function(t,n,e){var r=t(33),o=t(86);r(r.S+r.F*(Number.parseFloat!=o),"Number",{parseFloat:o})},{33:33,86:86}],187:[function(t,n,e){var r=t(33),o=t(87);r(r.S+r.F*(Number.parseInt!=o),"Number",{parseInt:o})},{33:33,87:87}],188:[function(t,n,e){"use strict";var r=t(33),o=t(116),i=t(4),a=t(110),u=1..toFixed,s=Math.floor,c=[0,0,0,0,0,0],l="Number.toFixed: incorrect invocation!",f=function(t,n){for(var e=-1,r=n;++e<6;)r+=t*c[e],c[e]=r%1e7,r=s(r/1e7)},d=function(t){for(var n=6,e=0;--n>=0;)e+=c[n],c[n]=s(e/t),e=e%t*1e7},h=function(){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==c[t]){var e=String(c[t]);n=""===n?e:n+a.call("0",7-e.length)+e}return n},v=function(t,n,e){return 0===n?e:n%2==1?v(t,n-1,e*t):v(t*t,n/2,e)},g=function(t){for(var n=0,e=t;e>=4096;)n+=12,e/=4096;for(;e>=2;)n+=1,e/=2;return n};r(r.P+r.F*(!!u&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!t(35)(function(){u.call({})})),"Number",{toFixed:function(t){var n,e,r,u,s=i(this,l),c=o(t),p="",y="0";if(c<0||c>20)throw RangeError(l);if(s!=s)return"NaN";if(s<=-1e21||s>=1e21)return String(s);if(s<0&&(p="-",s=-s),s>1e-21)if(n=g(s*v(2,69,1))-69,e=n<0?s*v(2,-n,1):s/v(2,n,1),e*=4503599627370496,(n=52-n)>0){for(f(0,e),r=c;r>=7;)f(1e7,0),r-=7;for(f(v(10,r,1),0),r=n-1;r>=23;)d(1<<23),r-=23;d(1<<r),f(1,1),d(2),y=h()}else f(0,e),f(1<<-n,0),y=h()+a.call("0",c);return y=c>0?p+((u=y.length)<=c?"0."+a.call("0",c-u)+y:y.slice(0,u-c)+"."+y.slice(u-c)):p+y}})},{110:110,116:116,33:33,35:35,4:4}],189:[function(t,n,e){"use strict";var r=t(33),o=t(35),i=t(4),a=1..toPrecision;r(r.P+r.F*(o(function(){return"1"!==a.call(1,void 0)})||!o(function(){a.call({})})),"Number",{toPrecision:function(t){var n=i(this,"Number#toPrecision: incorrect invocation!");return void 0===t?a.call(n):a.call(n,t)}})},{33:33,35:35,4:4}],190:[function(t,n,e){var r=t(33);r(r.S+r.F,"Object",{assign:t(70)})},{33:33,70:70}],191:[function(t,n,e){var r=t(33);r(r.S,"Object",{create:t(71)})},{33:33,71:71}],192:[function(t,n,e){var r=t(33);r(r.S+r.F*!t(29),"Object",{defineProperties:t(73)})},{29:29,33:33,73:73}],193:[function(t,n,e){var r=t(33);r(r.S+r.F*!t(29),"Object",{defineProperty:t(72).f})},{29:29,33:33,72:72}],194:[function(t,n,e){var r=t(51),o=t(66).onFreeze;t(83)("freeze",function(t){return function(n){return t&&r(n)?t(o(n)):n}})},{51:51,66:66,83:83}],195:[function(t,n,e){var r=t(117),o=t(75).f;t(83)("getOwnPropertyDescriptor",function(){return function(t,n){return o(r(t),n)}})},{117:117,75:75,83:83}],196:[function(t,n,e){t(83)("getOwnPropertyNames",function(){return t(76).f})},{76:76,83:83}],197:[function(t,n,e){var r=t(119),o=t(79);t(83)("getPrototypeOf",function(){return function(t){return o(r(t))}})},{119:119,79:79,83:83}],198:[function(t,n,e){var r=t(51);t(83)("isExtensible",function(t){return function(n){return!!r(n)&&(!t||t(n))}})},{51:51,83:83}],199:[function(t,n,e){var r=t(51);t(83)("isFrozen",function(t){return function(n){return!r(n)||!!t&&t(n)}})},{51:51,83:83}],200:[function(t,n,e){var r=t(51);t(83)("isSealed",function(t){return function(n){return!r(n)||!!t&&t(n)}})},{51:51,83:83}],201:[function(t,n,e){var r=t(33);r(r.S,"Object",{is:t(96)})},{33:33,96:96}],202:[function(t,n,e){var r=t(119),o=t(81);t(83)("keys",function(){return function(t){return o(r(t))}})},{119:119,81:81,83:83}],203:[function(t,n,e){var r=t(51),o=t(66).onFreeze;t(83)("preventExtensions",function(t){return function(n){return t&&r(n)?t(o(n)):n}})},{51:51,66:66,83:83}],204:[function(t,n,e){var r=t(51),o=t(66).onFreeze;t(83)("seal",function(t){return function(n){return t&&r(n)?t(o(n)):n}})},{51:51,66:66,83:83}],205:[function(t,n,e){var r=t(33);r(r.S,"Object",{setPrototypeOf:t(99).set})},{33:33,99:99}],206:[function(t,n,e){"use strict";var r=t(17),o={};o[t(128)("toStringTag")]="z",o+""!="[object z]"&&t(94)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},{128:128,17:17,94:94}],207:[function(t,n,e){var r=t(33),o=t(86);r(r.G+r.F*(parseFloat!=o),{parseFloat:o})},{33:33,86:86}],208:[function(t,n,e){var r=t(33),o=t(87);r(r.G+r.F*(parseInt!=o),{parseInt:o})},{33:33,87:87}],209:[function(t,n,e){"use strict";var r,o,i,a,u=t(60),s=t(40),c=t(25),l=t(17),f=t(33),d=t(51),h=t(3),v=t(6),g=t(39),p=t(104),y=t(113).set,m=t(68)(),_=t(69),b=t(90),w=t(91),x=s.TypeError,A=s.process,S=s.Promise,k="process"==l(A),T=function(){},P=o=_.f,E=!!function(){try{var n=S.resolve(1),e=(n.constructor={})[t(128)("species")]=function(t){t(T,T)};return(k||"function"==typeof PromiseRejectionEvent)&&n.then(T)instanceof e}catch(t){}}(),I=u?function(t,n){return t===n||t===S&&n===a}:function(t,n){return t===n},C=function(t){var n;return!(!d(t)||"function"!=typeof(n=t.then))&&n},O=function(t,n){if(!t._n){t._n=!0;var e=t._c;m(function(){for(var r=t._v,o=1==t._s,i=0;e.length>i;)!function(n){var e,i,a=o?n.ok:n.fail,u=n.resolve,s=n.reject,c=n.domain;try{a?(o||(2==t._h&&R(t),t._h=1),!0===a?e=r:(c&&c.enter(),e=a(r),c&&c.exit()),e===n.promise?s(x("Promise-chain cycle")):(i=C(e))?i.call(e,u,s):u(e)):s(r)}catch(t){s(t)}}(e[i++]);t._c=[],t._n=!1,n&&!t._h&&M(t)})}},M=function(t){y.call(s,function(){var n,e,r,o=t._v,i=j(t);if(i&&(n=b(function(){k?A.emit("unhandledRejection",o,t):(e=s.onunhandledrejection)?e({promise:t,reason:o}):(r=s.console)&&r.error&&r.error("Unhandled promise rejection",o)}),t._h=k||j(t)?2:1),t._a=void 0,i&&n.e)throw n.v})},j=function(t){if(1==t._h)return!1;for(var n,e=t._a||t._c,r=0;e.length>r;)if((n=e[r++]).fail||!j(n.promise))return!1;return!0},R=function(t){y.call(s,function(){var n;k?A.emit("rejectionHandled",t):(n=s.onrejectionhandled)&&n({promise:t,reason:t._v})})},L=function(t){var n=this;n._d||(n._d=!0,(n=n._w||n)._v=t,n._s=2,n._a||(n._a=n._c.slice()),O(n,!0))},N=function(t){var n,e=this;if(!e._d){e._d=!0,e=e._w||e;try{if(e===t)throw x("Promise can't be resolved itself");(n=C(t))?m(function(){var r={_w:e,_d:!1};try{n.call(t,c(N,r,1),c(L,r,1))}catch(t){L.call(r,t)}}):(e._v=t,e._s=1,O(e,!1))}catch(t){L.call({_w:e,_d:!1},t)}}};E||(S=function(t){v(this,S,"Promise","_h"),h(t),r.call(this);try{t(c(N,this,1),c(L,this,1))}catch(t){L.call(this,t)}},(r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=t(93)(S.prototype,{then:function(t,n){var e=P(p(this,S));return e.ok="function"!=typeof t||t,e.fail="function"==typeof n&&n,e.domain=k?A.domain:void 0,this._c.push(e),this._a&&this._a.push(e),this._s&&O(this,!1),e.promise},catch:function(t){return this.then(void 0,t)}}),i=function(){var t=new r;this.promise=t,this.resolve=c(N,t,1),this.reject=c(L,t,1)},_.f=P=function(t){return I(S,t)?new i(t):o(t)}),f(f.G+f.W+f.F*!E,{Promise:S}),t(101)(S,"Promise"),t(100)("Promise"),a=t(23).Promise,f(f.S+f.F*!E,"Promise",{reject:function(t){var n=P(this);return(0,n.reject)(t),n.promise}}),f(f.S+f.F*(u||!E),"Promise",{resolve:function(t){return t instanceof S&&I(t.constructor,this)?t:w(this,t)}}),f(f.S+f.F*!(E&&t(56)(function(t){S.all(t).catch(T)})),"Promise",{all:function(t){var n=this,e=P(n),r=e.resolve,o=e.reject,i=b(function(){var e=[],i=0,a=1;g(t,!1,function(t){var u=i++,s=!1;e.push(void 0),a++,n.resolve(t).then(function(t){s||(s=!0,e[u]=t,--a||r(e))},o)}),--a||r(e)});return i.e&&o(i.v),e.promise},race:function(t){var n=this,e=P(n),r=e.reject,o=b(function(){g(t,!1,function(t){n.resolve(t).then(e.resolve,r)})});return o.e&&r(o.v),e.promise}})},{100:100,101:101,104:104,113:113,128:128,17:17,23:23,25:25,3:3,33:33,39:39,40:40,51:51,56:56,6:6,60:60,68:68,69:69,90:90,91:91,93:93}],210:[function(t,n,e){var r=t(33),o=t(3),i=t(7),a=(t(40).Reflect||{}).apply,u=Function.apply;r(r.S+r.F*!t(35)(function(){a(function(){})}),"Reflect",{apply:function(t,n,e){var r=o(t),s=i(e);return a?a(r,n,s):u.call(r,n,s)}})},{3:3,33:33,35:35,40:40,7:7}],211:[function(t,n,e){var r=t(33),o=t(71),i=t(3),a=t(7),u=t(51),s=t(35),c=t(16),l=(t(40).Reflect||{}).construct,f=s(function(){function t(){}return!(l(function(){},[],t)instanceof t)}),d=!s(function(){l(function(){})});r(r.S+r.F*(f||d),"Reflect",{construct:function(t,n){i(t),a(n);var e=arguments.length<3?t:i(arguments[2]);if(d&&!f)return l(t,n,e);if(t==e){switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3])}var r=[null];return r.push.apply(r,n),new(c.apply(t,r))}var s=e.prototype,h=o(u(s)?s:Object.prototype),v=Function.apply.call(t,h,n);return u(v)?v:h}})},{16:16,3:3,33:33,35:35,40:40,51:51,7:7,71:71}],212:[function(t,n,e){var r=t(72),o=t(33),i=t(7),a=t(120);o(o.S+o.F*t(35)(function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,n,e){i(t),n=a(n,!0),i(e);try{return r.f(t,n,e),!0}catch(t){return!1}}})},{120:120,33:33,35:35,7:7,72:72}],213:[function(t,n,e){var r=t(33),o=t(75).f,i=t(7);r(r.S,"Reflect",{deleteProperty:function(t,n){var e=o(i(t),n);return!(e&&!e.configurable)&&delete t[n]}})},{33:33,7:7,75:75}],214:[function(t,n,e){"use strict";var r=t(33),o=t(7),i=function(t){this._t=o(t),this._i=0;var n,e=this._k=[];for(n in t)e.push(n)};t(54)(i,"Object",function(){var t,n=this,e=n._k;do{if(n._i>=e.length)return{value:void 0,done:!0}}while(!((t=e[n._i++])in n._t));return{value:t,done:!1}}),r(r.S,"Reflect",{enumerate:function(t){return new i(t)}})},{33:33,54:54,7:7}],215:[function(t,n,e){var r=t(75),o=t(33),i=t(7);o(o.S,"Reflect",{getOwnPropertyDescriptor:function(t,n){return r.f(i(t),n)}})},{33:33,7:7,75:75}],216:[function(t,n,e){var r=t(33),o=t(79),i=t(7);r(r.S,"Reflect",{getPrototypeOf:function(t){return o(i(t))}})},{33:33,7:7,79:79}],217:[function(t,n,e){function r(t,n){var e,u,l=arguments.length<3?t:arguments[2];return c(t)===l?t[n]:(e=o.f(t,n))?a(e,"value")?e.value:void 0!==e.get?e.get.call(l):void 0:s(u=i(t))?r(u,n,l):void 0}var o=t(75),i=t(79),a=t(41),u=t(33),s=t(51),c=t(7);u(u.S,"Reflect",{get:r})},{33:33,41:41,51:51,7:7,75:75,79:79}],218:[function(t,n,e){var r=t(33);r(r.S,"Reflect",{has:function(t,n){return n in t}})},{33:33}],219:[function(t,n,e){var r=t(33),o=t(7),i=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(t){return o(t),!i||i(t)}})},{33:33,7:7}],220:[function(t,n,e){var r=t(33);r(r.S,"Reflect",{ownKeys:t(85)})},{33:33,85:85}],221:[function(t,n,e){var r=t(33),o=t(7),i=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(t){o(t);try{return i&&i(t),!0}catch(t){return!1}}})},{33:33,7:7}],222:[function(t,n,e){var r=t(33),o=t(99);o&&r(r.S,"Reflect",{setPrototypeOf:function(t,n){o.check(t,n);try{return o.set(t,n),!0}catch(t){return!1}}})},{33:33,99:99}],223:[function(t,n,e){function r(t,n,e){var s,d,h=arguments.length<4?t:arguments[3],v=i.f(l(t),n);if(!v){if(f(d=a(t)))return r(d,n,e,h);v=c(0)}return u(v,"value")?!(!1===v.writable||!f(h))&&(s=i.f(h,n)||c(0),s.value=e,o.f(h,n,s),!0):void 0!==v.set&&(v.set.call(h,e),!0)}var o=t(72),i=t(75),a=t(79),u=t(41),s=t(33),c=t(92),l=t(7),f=t(51);s(s.S,"Reflect",{set:r})},{33:33,41:41,51:51,7:7,72:72,75:75,79:79,92:92}],224:[function(t,n,e){var r=t(40),o=t(45),i=t(72).f,a=t(77).f,u=t(52),s=t(37),c=r.RegExp,l=c,f=c.prototype,d=/a/g,h=/a/g,v=new c(d)!==d;if(t(29)&&(!v||t(35)(function(){return h[t(128)("match")]=!1,c(d)!=d||c(h)==h||"/a/i"!=c(d,"i")}))){c=function(t,n){var e=this instanceof c,r=u(t),i=void 0===n;return!e&&r&&t.constructor===c&&i?t:o(v?new l(r&&!i?t.source:t,n):l((r=t instanceof c)?t.source:t,r&&i?s.call(t):n),e?this:f,c)};for(var g=function(t){t in c||i(c,t,{configurable:!0,get:function(){return l[t]},set:function(n){l[t]=n}})},p=a(l),y=0;p.length>y;)g(p[y++]);f.constructor=c,c.prototype=f,t(94)(r,"RegExp",c)}t(100)("RegExp")},{100:100,128:128,29:29,35:35,37:37,40:40,45:45,52:52,72:72,77:77,94:94}],225:[function(t,n,e){t(29)&&"g"!=/./g.flags&&t(72).f(RegExp.prototype,"flags",{configurable:!0,get:t(37)})},{29:29,37:37,72:72}],226:[function(t,n,e){t(36)("match",1,function(t,n,e){return[function(e){"use strict";var r=t(this),o=void 0==e?void 0:e[n];return void 0!==o?o.call(e,r):new RegExp(e)[n](String(r))},e]})},{36:36}],227:[function(t,n,e){t(36)("replace",2,function(t,n,e){return[function(r,o){"use strict";var i=t(this),a=void 0==r?void 0:r[n];return void 0!==a?a.call(r,i,o):e.call(String(i),r,o)},e]})},{36:36}],228:[function(t,n,e){t(36)("search",1,function(t,n,e){return[function(e){"use strict";var r=t(this),o=void 0==e?void 0:e[n];return void 0!==o?o.call(e,r):new RegExp(e)[n](String(r))},e]})},{36:36}],229:[function(t,n,e){t(36)("split",2,function(n,e,r){"use strict";var o=t(52),i=r,a=[].push;if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length){var u=void 0===/()??/.exec("")[1];r=function(t,n){var e=String(this);if(void 0===t&&0===n)return[];if(!o(t))return i.call(e,t,n);var r,s,c,l,f,d=[],h=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),v=0,g=void 0===n?4294967295:n>>>0,p=new RegExp(t.source,h+"g");for(u||(r=new RegExp("^"+p.source+"$(?!\\s)",h));(s=p.exec(e))&&!((c=s.index+s[0].length)>v&&(d.push(e.slice(v,s.index)),!u&&s.length>1&&s[0].replace(r,function(){for(f=1;f<arguments.length-2;f++)void 0===arguments[f]&&(s[f]=void 0)}),s.length>1&&s.index<e.length&&a.apply(d,s.slice(1)),l=s[0].length,v=c,d.length>=g));)p.lastIndex===s.index&&p.lastIndex++;return v===e.length?!l&&p.test("")||d.push(""):d.push(e.slice(v)),d.length>g?d.slice(0,g):d}}else"0".split(void 0,0).length&&(r=function(t,n){return void 0===t&&0===n?[]:i.call(this,t,n)});return[function(t,o){var i=n(this),a=void 0==t?void 0:t[e];return void 0!==a?a.call(t,i,o):r.call(String(i),t,o)},r]})},{36:36,52:52}],230:[function(t,n,e){"use strict";t(225);var r=t(7),o=t(37),i=t(29),a=/./.toString,u=function(n){t(94)(RegExp.prototype,"toString",n,!0)};t(35)(function(){return"/a/b"!=a.call({source:"a",flags:"b"})})?u(function(){var t=r(this);return"/".concat(t.source,"/","flags"in t?t.flags:!i&&t instanceof RegExp?o.call(t):void 0)}):"toString"!=a.name&&u(function(){return a.call(this)})},{225:225,29:29,35:35,37:37,7:7,94:94}],231:[function(t,n,e){"use strict";var r=t(19),o=t(125);n.exports=t(22)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return r.def(o(this,"Set"),t=0===t?0:t,t)}},r)},{125:125,19:19,22:22}],232:[function(t,n,e){"use strict";t(108)("anchor",function(t){return function(n){return t(this,"a","name",n)}})},{108:108}],233:[function(t,n,e){"use strict";t(108)("big",function(t){return function(){return t(this,"big","","")}})},{108:108}],234:[function(t,n,e){"use strict";t(108)("blink",function(t){return function(){return t(this,"blink","","")}})},{108:108}],235:[function(t,n,e){"use strict";t(108)("bold",function(t){return function(){return t(this,"b","","")}})},{108:108}],236:[function(t,n,e){"use strict";var r=t(33),o=t(106)(!1);r(r.P,"String",{codePointAt:function(t){return o(this,t)}})},{106:106,33:33}],237:[function(t,n,e){"use strict";var r=t(33),o=t(118),i=t(107),a="".endsWith;r(r.P+r.F*t(34)("endsWith"),"String",{endsWith:function(t){var n=i(this,t,"endsWith"),e=arguments.length>1?arguments[1]:void 0,r=o(n.length),u=void 0===e?r:Math.min(o(e),r),s=String(t);return a?a.call(n,s,u):n.slice(u-s.length,u)===s}})},{107:107,118:118,33:33,34:34}],238:[function(t,n,e){"use strict";t(108)("fixed",function(t){return function(){return t(this,"tt","","")}})},{108:108}],239:[function(t,n,e){"use strict";t(108)("fontcolor",function(t){return function(n){return t(this,"font","color",n)}})},{108:108}],240:[function(t,n,e){"use strict";t(108)("fontsize",function(t){return function(n){return t(this,"font","size",n)}})},{108:108}],241:[function(t,n,e){var r=t(33),o=t(114),i=String.fromCharCode,a=String.fromCodePoint;r(r.S+r.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(t){for(var n,e=[],r=arguments.length,a=0;r>a;){if(n=+arguments[a++],o(n,1114111)!==n)throw RangeError(n+" is not a valid code point");e.push(n<65536?i(n):i(55296+((n-=65536)>>10),n%1024+56320))}return e.join("")}})},{114:114,33:33}],242:[function(t,n,e){"use strict";var r=t(33),o=t(107);r(r.P+r.F*t(34)("includes"),"String",{includes:function(t){return!!~o(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},{107:107,33:33,34:34}],243:[function(t,n,e){"use strict";t(108)("italics",function(t){return function(){return t(this,"i","","")}})},{108:108}],244:[function(t,n,e){"use strict";var r=t(106)(!0);t(55)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,e=this._i;return e>=n.length?{value:void 0,done:!0}:(t=r(n,e),this._i+=t.length,{value:t,done:!1})})},{106:106,55:55}],245:[function(t,n,e){"use strict";t(108)("link",function(t){return function(n){return t(this,"a","href",n)}})},{108:108}],246:[function(t,n,e){var r=t(33),o=t(117),i=t(118);r(r.S,"String",{raw:function(t){for(var n=o(t.raw),e=i(n.length),r=arguments.length,a=[],u=0;e>u;)a.push(String(n[u++])),u<r&&a.push(String(arguments[u]));return a.join("")}})},{117:117,118:118,33:33}],247:[function(t,n,e){var r=t(33);r(r.P,"String",{repeat:t(110)})},{110:110,33:33}],248:[function(t,n,e){"use strict";t(108)("small",function(t){return function(){return t(this,"small","","")}})},{108:108}],249:[function(t,n,e){"use strict";var r=t(33),o=t(118),i=t(107),a="".startsWith;r(r.P+r.F*t(34)("startsWith"),"String",{startsWith:function(t){var n=i(this,t,"startsWith"),e=o(Math.min(arguments.length>1?arguments[1]:void 0,n.length)),r=String(t);return a?a.call(n,r,e):n.slice(e,e+r.length)===r}})},{107:107,118:118,33:33,34:34}],250:[function(t,n,e){"use strict";t(108)("strike",function(t){return function(){return t(this,"strike","","")}})},{108:108}],251:[function(t,n,e){"use strict";t(108)("sub",function(t){return function(){return t(this,"sub","","")}})},{108:108}],252:[function(t,n,e){"use strict";t(108)("sup",function(t){return function(){return t(this,"sup","","")}})},{108:108}],253:[function(t,n,e){"use strict";t(111)("trim",function(t){return function(){return t(this,3)}})},{111:111}],254:[function(t,n,e){"use strict";var r=t(40),o=t(41),i=t(29),a=t(33),u=t(94),s=t(66).KEY,c=t(35),l=t(103),f=t(101),d=t(124),h=t(128),v=t(127),g=t(126),p=t(59),y=t(32),m=t(49),_=t(7),b=t(117),w=t(120),x=t(92),A=t(71),S=t(76),k=t(75),T=t(72),P=t(81),E=k.f,I=T.f,C=S.f,O=r.Symbol,M=r.JSON,j=M&&M.stringify,R=h("_hidden"),L=h("toPrimitive"),N={}.propertyIsEnumerable,W=l("symbol-registry"),D=l("symbols"),B=l("op-symbols"),F=Object.prototype,U="function"==typeof O,H=r.QObject,Q=!H||!H.prototype||!H.prototype.findChild,Y=i&&c(function(){return 7!=A(I({},"a",{get:function(){return I(this,"a",{value:7}).a}})).a})?function(t,n,e){var r=E(F,n);r&&delete F[n],I(t,n,e),r&&t!==F&&I(F,n,r)}:I,z=function(t){var n=D[t]=A(O.prototype);return n._k=t,n},V=U&&"symbol"==typeof O.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof O},G=function(t,n,e){return t===F&&G(B,n,e),_(t),n=w(n,!0),_(e),o(D,n)?(e.enumerable?(o(t,R)&&t[R][n]&&(t[R][n]=!1),e=A(e,{enumerable:x(0,!1)})):(o(t,R)||I(t,R,x(1,{})),t[R][n]=!0),Y(t,n,e)):I(t,n,e)},q=function(t,n){_(t);for(var e,r=y(n=b(n)),o=0,i=r.length;i>o;)G(t,e=r[o++],n[e]);return t},K=function(t){var n=N.call(this,t=w(t,!0));return!(this===F&&o(D,t)&&!o(B,t))&&(!(n||!o(this,t)||!o(D,t)||o(this,R)&&this[R][t])||n)},J=function(t,n){if(t=b(t),n=w(n,!0),t!==F||!o(D,n)||o(B,n)){var e=E(t,n);return!e||!o(D,n)||o(t,R)&&t[R][n]||(e.enumerable=!0),e}},$=function(t){for(var n,e=C(b(t)),r=[],i=0;e.length>i;)o(D,n=e[i++])||n==R||n==s||r.push(n);return r},X=function(t){for(var n,e=t===F,r=C(e?B:b(t)),i=[],a=0;r.length>a;)!o(D,n=r[a++])||e&&!o(F,n)||i.push(D[n]);return i};U||(u((O=function(){if(this instanceof O)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),n=function(e){this===F&&n.call(B,e),o(this,R)&&o(this[R],t)&&(this[R][t]=!1),Y(this,t,x(1,e))};return i&&Q&&Y(F,t,{configurable:!0,set:n}),z(t)}).prototype,"toString",function(){return this._k}),k.f=J,T.f=G,t(77).f=S.f=$,t(82).f=K,t(78).f=X,i&&!t(60)&&u(F,"propertyIsEnumerable",K,!0),v.f=function(t){return z(h(t))}),a(a.G+a.W+a.F*!U,{Symbol:O});for(var Z="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),tt=0;Z.length>tt;)h(Z[tt++]);for(var nt=P(h.store),et=0;nt.length>et;)g(nt[et++]);a(a.S+a.F*!U,"Symbol",{for:function(t){return o(W,t+="")?W[t]:W[t]=O(t)},keyFor:function(t){if(V(t))return p(W,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){Q=!0},useSimple:function(){Q=!1}}),a(a.S+a.F*!U,"Object",{create:function(t,n){return void 0===n?A(t):q(A(t),n)},defineProperty:G,defineProperties:q,getOwnPropertyDescriptor:J,getOwnPropertyNames:$,getOwnPropertySymbols:X}),M&&a(a.S+a.F*(!U||c(function(){var t=O();return"[null]"!=j([t])||"{}"!=j({a:t})||"{}"!=j(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!V(t)){for(var n,e,r=[t],o=1;arguments.length>o;)r.push(arguments[o++]);return"function"==typeof(n=r[1])&&(e=n),!e&&m(n)||(n=function(t,n){if(e&&(n=e.call(this,t,n)),!V(n))return n}),r[1]=n,j.apply(M,r)}}}),O.prototype[L]||t(42)(O.prototype,L,O.prototype.valueOf),f(O,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},{101:101,103:103,117:117,120:120,124:124,126:126,127:127,128:128,29:29,32:32,33:33,35:35,40:40,41:41,42:42,49:49,59:59,60:60,66:66,7:7,71:71,72:72,75:75,76:76,77:77,78:78,81:81,82:82,92:92,94:94}],255:[function(t,n,e){"use strict";var r=t(33),o=t(123),i=t(122),a=t(7),u=t(114),s=t(118),c=t(51),l=t(40).ArrayBuffer,f=t(104),d=i.ArrayBuffer,h=i.DataView,v=o.ABV&&l.isView,g=d.prototype.slice,p=o.VIEW;r(r.G+r.W+r.F*(l!==d),{ArrayBuffer:d}),r(r.S+r.F*!o.CONSTR,"ArrayBuffer",{isView:function(t){return v&&v(t)||c(t)&&p in t}}),r(r.P+r.U+r.F*t(35)(function(){return!new d(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(t,n){if(void 0!==g&&void 0===n)return g.call(a(this),t);for(var e=a(this).byteLength,r=u(t,e),o=u(void 0===n?e:n,e),i=new(f(this,d))(s(o-r)),c=new h(this),l=new h(i),v=0;r<o;)l.setUint8(v++,c.getUint8(r++));return i}}),t(100)("ArrayBuffer")},{100:100,104:104,114:114,118:118,122:122,123:123,33:33,35:35,40:40,51:51,7:7}],256:[function(t,n,e){var r=t(33);r(r.G+r.W+r.F*!t(123).ABV,{DataView:t(122).DataView})},{122:122,123:123,33:33}],257:[function(t,n,e){t(121)("Float32",4,function(t){return function(n,e,r){return t(this,n,e,r)}})},{121:121}],258:[function(t,n,e){t(121)("Float64",8,function(t){return function(n,e,r){return t(this,n,e,r)}})},{121:121}],259:[function(t,n,e){t(121)("Int16",2,function(t){return function(n,e,r){return t(this,n,e,r)}})},{121:121}],260:[function(t,n,e){t(121)("Int32",4,function(t){return function(n,e,r){return t(this,n,e,r)}})},{121:121}],261:[function(t,n,e){t(121)("Int8",1,function(t){return function(n,e,r){return t(this,n,e,r)}})},{121:121}],262:[function(t,n,e){t(121)("Uint16",2,function(t){return function(n,e,r){return t(this,n,e,r)}})},{121:121}],263:[function(t,n,e){t(121)("Uint32",4,function(t){return function(n,e,r){return t(this,n,e,r)}})},{121:121}],264:[function(t,n,e){t(121)("Uint8",1,function(t){return function(n,e,r){return t(this,n,e,r)}})},{121:121}],265:[function(t,n,e){t(121)("Uint8",1,function(t){return function(n,e,r){return t(this,n,e,r)}},!0)},{121:121}],266:[function(t,n,e){"use strict";var r,o=t(12)(0),i=t(94),a=t(66),u=t(70),s=t(21),c=t(51),l=t(35),f=t(125),d=a.getWeak,h=Object.isExtensible,v=s.ufstore,g={},p=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},y={get:function(t){if(c(t)){var n=d(t);return!0===n?v(f(this,"WeakMap")).get(t):n?n[this._i]:void 0}},set:function(t,n){return s.def(f(this,"WeakMap"),t,n)}},m=n.exports=t(22)("WeakMap",p,y,s,!0,!0);l(function(){return 7!=(new m).set((Object.freeze||Object)(g),7).get(g)})&&(u((r=s.getConstructor(p,"WeakMap")).prototype,y),a.NEED=!0,o(["delete","has","get","set"],function(t){var n=m.prototype,e=n[t];i(n,t,function(n,o){if(c(n)&&!h(n)){this._f||(this._f=new r);var i=this._f[t](n,o);return"set"==t?this:i}return e.call(this,n,o)})}))},{12:12,125:125,21:21,22:22,35:35,51:51,66:66,70:70,94:94}],267:[function(t,n,e){"use strict";var r=t(21),o=t(125);t(22)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return r.def(o(this,"WeakSet"),t,!0)}},r,!1,!0)},{125:125,21:21,22:22}],268:[function(t,n,e){"use strict";var r=t(33),o=t(38),i=t(119),a=t(118),u=t(3),s=t(15);r(r.P,"Array",{flatMap:function(t){var n,e,r=i(this);return u(t),n=a(r.length),e=s(r,0),o(e,r,r,n,0,1,t,arguments[1]),e}}),t(5)("flatMap")},{118:118,119:119,15:15,3:3,33:33,38:38,5:5}],269:[function(t,n,e){"use strict";var r=t(33),o=t(38),i=t(119),a=t(118),u=t(116),s=t(15);r(r.P,"Array",{flatten:function(){var t=arguments[0],n=i(this),e=a(n.length),r=s(n,0);return o(r,n,n,e,0,void 0===t?1:u(t)),r}}),t(5)("flatten")},{116:116,118:118,119:119,15:15,33:33,38:38,5:5}],270:[function(t,n,e){"use strict";var r=t(33),o=t(11)(!0);r(r.P,"Array",{includes:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),t(5)("includes")},{11:11,33:33,5:5}],271:[function(t,n,e){var r=t(33),o=t(68)(),i=t(40).process,a="process"==t(18)(i);r(r.G,{asap:function(t){var n=a&&i.domain;o(n?n.bind(t):t)}})},{18:18,33:33,40:40,68:68}],272:[function(t,n,e){var r=t(33),o=t(18);r(r.S,"Error",{isError:function(t){return"Error"===o(t)}})},{18:18,33:33}],273:[function(t,n,e){var r=t(33);r(r.G,{global:t(40)})},{33:33,40:40}],274:[function(t,n,e){t(97)("Map")},{97:97}],275:[function(t,n,e){t(98)("Map")},{98:98}],276:[function(t,n,e){var r=t(33);r(r.P+r.R,"Map",{toJSON:t(20)("Map")})},{20:20,33:33}],277:[function(t,n,e){var r=t(33);r(r.S,"Math",{clamp:function(t,n,e){return Math.min(e,Math.max(n,t))}})},{33:33}],278:[function(t,n,e){var r=t(33);r(r.S,"Math",{DEG_PER_RAD:Math.PI/180})},{33:33}],279:[function(t,n,e){var r=t(33),o=180/Math.PI;r(r.S,"Math",{degrees:function(t){return t*o}})},{33:33}],280:[function(t,n,e){var r=t(33),o=t(64),i=t(62);r(r.S,"Math",{fscale:function(t,n,e,r,a){return i(o(t,n,e,r,a))}})},{33:33,62:62,64:64}],281:[function(t,n,e){var r=t(33);r(r.S,"Math",{iaddh:function(t,n,e,r){var o=t>>>0,i=e>>>0;return(n>>>0)+(r>>>0)+((o&i|(o|i)&~(o+i>>>0))>>>31)|0}})},{33:33}],282:[function(t,n,e){var r=t(33);r(r.S,"Math",{imulh:function(t,n){var e=+t,r=+n,o=65535&e,i=65535&r,a=e>>16,u=r>>16,s=(a*i>>>0)+(o*i>>>16);return a*u+(s>>16)+((o*u>>>0)+(65535&s)>>16)}})},{33:33}],283:[function(t,n,e){var r=t(33);r(r.S,"Math",{isubh:function(t,n,e,r){var o=t>>>0,i=e>>>0;return(n>>>0)-(r>>>0)-((~o&i|~(o^i)&o-i>>>0)>>>31)|0}})},{33:33}],284:[function(t,n,e){var r=t(33);r(r.S,"Math",{RAD_PER_DEG:180/Math.PI})},{33:33}],285:[function(t,n,e){var r=t(33),o=Math.PI/180;r(r.S,"Math",{radians:function(t){return t*o}})},{33:33}],286:[function(t,n,e){var r=t(33);r(r.S,"Math",{scale:t(64)})},{33:33,64:64}],287:[function(t,n,e){var r=t(33);r(r.S,"Math",{signbit:function(t){return(t=+t)!=t?t:0==t?1/t==1/0:t>0}})},{33:33}],288:[function(t,n,e){var r=t(33);r(r.S,"Math",{umulh:function(t,n){var e=+t,r=+n,o=65535&e,i=65535&r,a=e>>>16,u=r>>>16,s=(a*i>>>0)+(o*i>>>16);return a*u+(s>>>16)+((o*u>>>0)+(65535&s)>>>16)}})},{33:33}],289:[function(t,n,e){"use strict";var r=t(33),o=t(119),i=t(3),a=t(72);t(29)&&r(r.P+t(74),"Object",{__defineGetter__:function(t,n){a.f(o(this),t,{get:i(n),enumerable:!0,configurable:!0})}})},{119:119,29:29,3:3,33:33,72:72,74:74}],290:[function(t,n,e){"use strict";var r=t(33),o=t(119),i=t(3),a=t(72);t(29)&&r(r.P+t(74),"Object",{__defineSetter__:function(t,n){a.f(o(this),t,{set:i(n),enumerable:!0,configurable:!0})}})},{119:119,29:29,3:3,33:33,72:72,74:74}],291:[function(t,n,e){var r=t(33),o=t(84)(!0);r(r.S,"Object",{entries:function(t){return o(t)}})},{33:33,84:84}],292:[function(t,n,e){var r=t(33),o=t(85),i=t(117),a=t(75),u=t(24);r(r.S,"Object",{getOwnPropertyDescriptors:function(t){for(var n,e,r=i(t),s=a.f,c=o(r),l={},f=0;c.length>f;)void 0!==(e=s(r,n=c[f++]))&&u(l,n,e);return l}})},{117:117,24:24,33:33,75:75,85:85}],293:[function(t,n,e){"use strict";var r=t(33),o=t(119),i=t(120),a=t(79),u=t(75).f;t(29)&&r(r.P+t(74),"Object",{__lookupGetter__:function(t){var n,e=o(this),r=i(t,!0);do{if(n=u(e,r))return n.get}while(e=a(e))}})},{119:119,120:120,29:29,33:33,74:74,75:75,79:79}],294:[function(t,n,e){"use strict";var r=t(33),o=t(119),i=t(120),a=t(79),u=t(75).f;t(29)&&r(r.P+t(74),"Object",{__lookupSetter__:function(t){var n,e=o(this),r=i(t,!0);do{if(n=u(e,r))return n.set}while(e=a(e))}})},{119:119,120:120,29:29,33:33,74:74,75:75,79:79}],295:[function(t,n,e){var r=t(33),o=t(84)(!1);r(r.S,"Object",{values:function(t){return o(t)}})},{33:33,84:84}],296:[function(t,n,e){"use strict";var r=t(33),o=t(40),i=t(23),a=t(68)(),u=t(128)("observable"),s=t(3),c=t(7),l=t(6),f=t(93),d=t(42),h=t(39),v=h.RETURN,g=function(t){return null==t?void 0:s(t)},p=function(t){var n=t._c;n&&(t._c=void 0,n())},y=function(t){return void 0===t._o},m=function(t){y(t)||(t._o=void 0,p(t))},_=function(t,n){c(t),this._c=void 0,this._o=t,t=new b(this);try{var e=n(t),r=e;null!=e&&("function"==typeof e.unsubscribe?e=function(){r.unsubscribe()}:s(e),this._c=e)}catch(n){return void t.error(n)}y(this)&&p(this)};_.prototype=f({},{unsubscribe:function(){m(this)}});var b=function(t){this._s=t};b.prototype=f({},{next:function(t){var n=this._s;if(!y(n)){var e=n._o;try{var r=g(e.next);if(r)return r.call(e,t)}catch(t){try{m(n)}finally{throw t}}}},error:function(t){var n=this._s;if(y(n))throw t;var e=n._o;n._o=void 0;try{var r=g(e.error);if(!r)throw t;t=r.call(e,t)}catch(t){try{p(n)}finally{throw t}}return p(n),t},complete:function(t){var n=this._s;if(!y(n)){var e=n._o;n._o=void 0;try{var r=g(e.complete);t=r?r.call(e,t):void 0}catch(t){try{p(n)}finally{throw t}}return p(n),t}}});var w=function(t){l(this,w,"Observable","_f")._f=s(t)};f(w.prototype,{subscribe:function(t){return new _(t,this._f)},forEach:function(t){var n=this;return new(i.Promise||o.Promise)(function(e,r){s(t);var o=n.subscribe({next:function(n){try{return t(n)}catch(t){r(t),o.unsubscribe()}},error:r,complete:e})})}}),f(w,{from:function(t){var n="function"==typeof this?this:w,e=g(c(t)[u]);if(e){var r=c(e.call(t));return r.constructor===n?r:new n(function(t){return r.subscribe(t)})}return new n(function(n){var e=!1;return a(function(){if(!e){try{if(h(t,!1,function(t){if(n.next(t),e)return v})===v)return}catch(t){if(e)throw t;return void n.error(t)}n.complete()}}),function(){e=!0}})},of:function(){for(var t=0,n=arguments.length,e=Array(n);t<n;)e[t]=arguments[t++];return new("function"==typeof this?this:w)(function(t){var n=!1;return a(function(){if(!n){for(var r=0;r<e.length;++r)if(t.next(e[r]),n)return;t.complete()}}),function(){n=!0}})}}),d(w.prototype,u,function(){return this}),r(r.G,{Observable:w}),t(100)("Observable")},{100:100,128:128,23:23,3:3,33:33,39:39,40:40,42:42,6:6,68:68,7:7,93:93}],297:[function(t,n,e){"use strict";var r=t(33),o=t(23),i=t(40),a=t(104),u=t(91);r(r.P+r.R,"Promise",{finally:function(t){var n=a(this,o.Promise||i.Promise),e="function"==typeof t;return this.then(e?function(e){return u(n,t()).then(function(){return e})}:t,e?function(e){return u(n,t()).then(function(){throw e})}:t)}})},{104:104,23:23,33:33,40:40,91:91}],298:[function(t,n,e){"use strict";var r=t(33),o=t(69),i=t(90);r(r.S,"Promise",{try:function(t){var n=o.f(this),e=i(t);return(e.e?n.reject:n.resolve)(e.v),n.promise}})},{33:33,69:69,90:90}],299:[function(t,n,e){var r=t(67),o=t(7),i=r.key,a=r.set;r.exp({defineMetadata:function(t,n,e,r){a(t,n,o(e),i(r))}})},{67:67,7:7}],300:[function(t,n,e){var r=t(67),o=t(7),i=r.key,a=r.map,u=r.store;r.exp({deleteMetadata:function(t,n){var e=arguments.length<3?void 0:i(arguments[2]),r=a(o(n),e,!1);if(void 0===r||!r.delete(t))return!1;if(r.size)return!0;var s=u.get(n);return s.delete(e),!!s.size||u.delete(n)}})},{67:67,7:7}],301:[function(t,n,e){var r=t(231),o=t(10),i=t(67),a=t(7),u=t(79),s=i.keys,c=i.key,l=function(t,n){var e=s(t,n),i=u(t);if(null===i)return e;var a=l(i,n);return a.length?e.length?o(new r(e.concat(a))):a:e};i.exp({getMetadataKeys:function(t){return l(a(t),arguments.length<2?void 0:c(arguments[1]))}})},{10:10,231:231,67:67,7:7,79:79}],302:[function(t,n,e){var r=t(67),o=t(7),i=t(79),a=r.has,u=r.get,s=r.key,c=function(t,n,e){if(a(t,n,e))return u(t,n,e);var r=i(n);return null!==r?c(t,r,e):void 0};r.exp({getMetadata:function(t,n){return c(t,o(n),arguments.length<3?void 0:s(arguments[2]))}})},{67:67,7:7,79:79}],303:[function(t,n,e){var r=t(67),o=t(7),i=r.keys,a=r.key;r.exp({getOwnMetadataKeys:function(t){return i(o(t),arguments.length<2?void 0:a(arguments[1]))}})},{67:67,7:7}],304:[function(t,n,e){var r=t(67),o=t(7),i=r.get,a=r.key;r.exp({getOwnMetadata:function(t,n){return i(t,o(n),arguments.length<3?void 0:a(arguments[2]))}})},{67:67,7:7}],305:[function(t,n,e){var r=t(67),o=t(7),i=t(79),a=r.has,u=r.key,s=function(t,n,e){if(a(t,n,e))return!0;var r=i(n);return null!==r&&s(t,r,e)};r.exp({hasMetadata:function(t,n){return s(t,o(n),arguments.length<3?void 0:u(arguments[2]))}})},{67:67,7:7,79:79}],306:[function(t,n,e){var r=t(67),o=t(7),i=r.has,a=r.key;r.exp({hasOwnMetadata:function(t,n){return i(t,o(n),arguments.length<3?void 0:a(arguments[2]))}})},{67:67,7:7}],307:[function(t,n,e){var r=t(67),o=t(7),i=t(3),a=r.key,u=r.set;r.exp({metadata:function(t,n){return function(e,r){u(t,n,(void 0!==r?o:i)(e),a(r))}}})},{3:3,67:67,7:7}],308:[function(t,n,e){t(97)("Set")},{97:97}],309:[function(t,n,e){t(98)("Set")},{98:98}],310:[function(t,n,e){var r=t(33);r(r.P+r.R,"Set",{toJSON:t(20)("Set")})},{20:20,33:33}],311:[function(t,n,e){"use strict";var r=t(33),o=t(106)(!0);r(r.P,"String",{at:function(t){return o(this,t)}})},{106:106,33:33}],312:[function(t,n,e){"use strict";var r=t(33),o=t(28),i=t(118),a=t(52),u=t(37),s=RegExp.prototype,c=function(t,n){this._r=t,this._s=n};t(54)(c,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),r(r.P,"String",{matchAll:function(t){if(o(this),!a(t))throw TypeError(t+" is not a regexp!");var n=String(this),e="flags"in s?String(t.flags):u.call(t),r=new RegExp(t.source,~e.indexOf("g")?e:"g"+e);return r.lastIndex=i(t.lastIndex),new c(r,n)}})},{118:118,28:28,33:33,37:37,52:52,54:54}],313:[function(t,n,e){"use strict";var r=t(33),o=t(109);r(r.P,"String",{padEnd:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},{109:109,33:33}],314:[function(t,n,e){"use strict";var r=t(33),o=t(109);r(r.P,"String",{padStart:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},{109:109,33:33}],315:[function(t,n,e){"use strict";t(111)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},{111:111}],316:[function(t,n,e){"use strict";t(111)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},{111:111}],317:[function(t,n,e){t(126)("asyncIterator")},{126:126}],318:[function(t,n,e){t(126)("observable")},{126:126}],319:[function(t,n,e){var r=t(33);r(r.S,"System",{global:t(40)})},{33:33,40:40}],320:[function(t,n,e){t(97)("WeakMap")},{97:97}],321:[function(t,n,e){t(98)("WeakMap")},{98:98}],322:[function(t,n,e){t(97)("WeakSet")},{97:97}],323:[function(t,n,e){t(98)("WeakSet")},{98:98}],324:[function(t,n,e){for(var r=t(141),o=t(81),i=t(94),a=t(40),u=t(42),s=t(58),c=t(128),l=c("iterator"),f=c("toStringTag"),d=s.Array,h={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},v=o(h),g=0;g<v.length;g++){var p,y=v[g],m=h[y],_=a[y],b=_&&_.prototype;if(b&&(b[l]||u(b,l,d),b[f]||u(b,f,y),s[y]=d,m))for(p in r)b[p]||i(b,p,r[p],!0)}},{128:128,141:141,40:40,42:42,58:58,81:81,94:94}],325:[function(t,n,e){var r=t(33),o=t(113);r(r.G+r.B,{setImmediate:o.set,clearImmediate:o.clear})},{113:113,33:33}],326:[function(t,n,e){var r=t(40),o=t(33),i=t(46),a=t(88),u=r.navigator,s=!!u&&/MSIE .\./.test(u.userAgent),c=function(t){return s?function(n,e){return t(i(a,[].slice.call(arguments,2),"function"==typeof n?n:Function(n)),e)}:t};o(o.G+o.B+o.F*s,{setTimeout:c(r.setTimeout),setInterval:c(r.setInterval)})},{33:33,40:40,46:46,88:88}],327:[function(t,n,e){t(254),t(191),t(193),t(192),t(195),t(197),t(202),t(196),t(194),t(204),t(203),t(199),t(200),t(198),t(190),t(201),t(205),t(206),t(157),t(159),t(158),t(208),t(207),t(178),t(188),t(189),t(179),t(180),t(181),t(182),t(183),t(184),t(185),t(186),t(187),t(161),t(162),t(163),t(164),t(165),t(166),t(167),t(168),t(169),t(170),t(171),t(172),t(173),t(174),t(175),t(176),t(177),t(241),t(246),t(253),t(244),t(236),t(237),t(242),t(247),t(249),t(232),t(233),t(234),t(235),t(238),t(239),t(240),t(243),t(245),t(248),t(250),t(251),t(252),t(152),t(154),t(153),t(156),t(155),t(140),t(138),t(145),t(142),t(148),t(150),t(137),t(144),t(134),t(149),t(132),t(147),t(146),t(139),t(143),t(131),t(133),t(136),t(135),t(151),t(141),t(224),t(230),t(225),t(226),t(227),t(228),t(229),t(209),t(160),t(231),t(266),t(267),t(255),t(256),t(261),t(264),t(265),t(259),t(262),t(260),t(263),t(257),t(258),t(210),t(211),t(212),t(213),t(214),t(217),t(215),t(216),t(218),t(219),t(220),t(221),t(223),t(222),t(270),t(268),t(269),t(311),t(314),t(313),t(315),t(316),t(312),t(317),t(318),t(292),t(295),t(291),t(289),t(290),t(293),t(294),t(276),t(310),t(275),t(309),t(321),t(323),t(274),t(308),t(320),t(322),t(273),t(319),t(272),t(277),t(278),t(279),t(280),t(281),t(283),t(282),t(284),t(285),t(286),t(288),t(287),t(297),t(298),t(299),t(300),t(302),t(301),t(304),t(303),t(305),t(306),t(307),t(271),t(296),t(326),t(325),t(324),n.exports=t(23)},{131:131,132:132,133:133,134:134,135:135,136:136,137:137,138:138,139:139,140:140,141:141,142:142,143:143,144:144,145:145,146:146,147:147,148:148,149:149,150:150,151:151,152:152,153:153,154:154,155:155,156:156,157:157,158:158,159:159,160:160,161:161,162:162,163:163,164:164,165:165,166:166,167:167,168:168,169:169,170:170,171:171,172:172,173:173,174:174,175:175,176:176,177:177,178:178,179:179,180:180,181:181,182:182,183:183,184:184,185:185,186:186,187:187,188:188,189:189,190:190,191:191,192:192,193:193,194:194,195:195,196:196,197:197,198:198,199:199,200:200,201:201,202:202,203:203,204:204,205:205,206:206,207:207,208:208,209:209,210:210,211:211,212:212,213:213,214:214,215:215,216:216,217:217,218:218,219:219,220:220,221:221,222:222,223:223,224:224,225:225,226:226,227:227,228:228,229:229,23:23,230:230,231:231,232:232,233:233,234:234,235:235,236:236,237:237,238:238,239:239,240:240,241:241,242:242,243:243,244:244,245:245,246:246,247:247,248:248,249:249,250:250,251:251,252:252,253:253,254:254,255:255,256:256,257:257,258:258,259:259,260:260,261:261,262:262,263:263,264:264,265:265,266:266,267:267,268:268,269:269,270:270,271:271,272:272,273:273,274:274,275:275,276:276,277:277,278:278,279:279,280:280,281:281,282:282,283:283,284:284,285:285,286:286,287:287,288:288,289:289,290:290,291:291,292:292,293:293,294:294,295:295,296:296,297:297,298:298,299:299,300:300,301:301,302:302,303:303,304:304,305:305,306:306,307:307,308:308,309:309,310:310,311:311,312:312,313:313,314:314,315:315,316:316,317:317,318:318,319:319,320:320,321:321,322:322,323:323,324:324,325:325,326:326}],328:[function(n,e,r){(function(t){!function(t){"use strict";function n(t,n,e,r){var i=n&&n.prototype instanceof o?n:o,a=Object.create(i.prototype),u=new h(r||[]);return a._invoke=c(t,e,u),a}function r(t,n,e){try{return{type:"normal",arg:t.call(n,e)}}catch(t){return{type:"throw",arg:t}}}function o(){}function i(){}function a(){}function u(t){["next","throw","return"].forEach(function(n){t[n]=function(t){return this._invoke(n,t)}})}function s(n){function e(t,o,i,a){var u=r(n[t],n,o);if("throw"!==u.type){var s=u.arg,c=s.value;return c&&"object"==typeof c&&m.call(c,"__await")?Promise.resolve(c.__await).then(function(t){e("next",t,i,a)},function(t){e("throw",t,i,a)}):Promise.resolve(c).then(function(t){s.value=t,i(s)},a)}a(u.arg)}"object"==typeof t.process&&t.process.domain&&(e=t.process.domain.bind(e));var o;this._invoke=function(t,n){function r(){return new Promise(function(r,o){e(t,n,r,o)})}return o=o?o.then(r,r):r()}}function c(t,n,e){var o=k;return function(i,a){if(o===P)throw new Error("Generator is already running");if(o===E){if("throw"===i)throw a;return g()}for(e.method=i,e.arg=a;;){var u=e.delegate;if(u){var s=l(u,e);if(s){if(s===I)continue;return s}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if(o===k)throw o=E,e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);o=P;var c=r(t,n,e);if("normal"===c.type){if(o=e.done?E:T,c.arg===I)continue;return{value:c.arg,done:e.done}}"throw"===c.type&&(o=E,e.method="throw",e.arg=c.arg)}}}function l(t,n){var e=t.iterator[n.method];if(e===p){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=p,l(t,n),"throw"===n.method))return I;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return I}var o=r(e,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,I;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=p),n.delegate=null,I):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,I)}function f(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function d(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function h(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(f,this),this.reset(!0)}function v(t){if(t){var n=t[b];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var e=-1,r=function n(){for(;++e<t.length;)if(m.call(t,e))return n.value=t[e],n.done=!1,n;return n.value=p,n.done=!0,n};return r.next=r}}return{next:g}}function g(){return{value:p,done:!0}}var p,y=Object.prototype,m=y.hasOwnProperty,_="function"==typeof Symbol?Symbol:{},b=_.iterator||"@@iterator",w=_.asyncIterator||"@@asyncIterator",x=_.toStringTag||"@@toStringTag",A="object"==typeof e,S=t.regeneratorRuntime;if(S)A&&(e.exports=S);else{(S=t.regeneratorRuntime=A?e.exports:{}).wrap=n;var k="suspendedStart",T="suspendedYield",P="executing",E="completed",I={},C={};C[b]=function(){return this};var O=Object.getPrototypeOf,M=O&&O(O(v([])));M&&M!==y&&m.call(M,b)&&(C=M);var j=a.prototype=o.prototype=Object.create(C);i.prototype=j.constructor=a,a.constructor=i,a[x]=i.displayName="GeneratorFunction",S.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===i||"GeneratorFunction"===(n.displayName||n.name))},S.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,a):(t.__proto__=a,x in t||(t[x]="GeneratorFunction")),t.prototype=Object.create(j),t},S.awrap=function(t){return{__await:t}},u(s.prototype),s.prototype[w]=function(){return this},S.AsyncIterator=s,S.async=function(t,e,r,o){var i=new s(n(t,e,r,o));return S.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},u(j),j[x]="Generator",j[b]=function(){return this},j.toString=function(){return"[object Generator]"},S.keys=function(t){var n=[];for(var e in t)n.push(e);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},S.values=v,h.prototype={constructor:h,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=p,this.done=!1,this.delegate=null,this.method="next",this.arg=p,this.tryEntries.forEach(d),!t)for(var n in this)"t"===n.charAt(0)&&m.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=p)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){function n(n,r){return i.type="throw",i.arg=t,e.next=n,r&&(e.method="next",e.arg=p),!!r}if(this.done)throw t;for(var e=this,r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=m.call(o,"catchLoc"),u=m.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,n){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc<=this.prev&&m.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=n&&n<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=n,o?(this.method="next",this.next=o.finallyLoc,I):this.complete(i)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),I},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var e=this.tryEntries[n];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),d(e),I}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var e=this.tryEntries[n];if(e.tryLoc===t){var r=e.completion;if("throw"===r.type){var o=r.arg;d(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,e){return this.delegate={iterator:v(t),resultName:n,nextLoc:e},"next"===this.method&&(this.arg=p),I}}}}("object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:this)}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])}).call(n,e(53))},function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),i=(0,function(t){return t&&t.__esModule?t:{default:t}}(e(0)).default)(),a=function(){function t(){r(this,t),this._cache={annosPerCanvas:{}},this._queues={annosPerCanvas:[]},this._maxCanvases=5}return o(t,[{key:"getAnnotationsPerCanvas",value:function(t){return i.debug("AnnotationCacheInMemory#getAnnotationsPerCanvas",t),this._logState("get"),this._cache.annosPerCanvas[t]||null}},{key:"setAnnotationsPerCanvas",value:function(t,n){i.debug("AnnotationCacheInMemory#setAnnotationsPerCanvas canvasId:",t,"annotations:",n);var e=this._cache.annosPerCanvas,r=this._queues.annosPerCanvas;this._logState("set before"),e[t]||(e[t]=n,r.push(t),r.length>this._maxCanvases&&delete e[r.shift()],this._logState("set after"))}},{key:"invalidateAllCanvases",value:function(){i.debug("AnnotationCacheInMemory#invalidateAllCanvases"),this._cache.annosPerCanvas={},this._queues.annosPerCanvas=[]}},{key:"invalidateCanvasId",value:function(t){i.debug("AnnotationCacheInMemory#invalidateCanvasId canvasId:",t);var n=this._queues.annosPerCanvas;delete this._cache.annosPerCanvas[t],n.splice(n.indexOf(t),1)}},{key:"_logState",value:function(t){i.debug("Mem cache "+t),i.debug("cache:",this._cache),i.debug("queues:",this._queues)}}]),t}();n.default=a},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),a=(e(1),r(e(0))),u=(r(e(3)),(0,a.default)()),s=function(){function t(){o(this,t),this._valid=!1}return i(t,[{key:"init",value:function(){var t=this;return u.debug("AnnotationCacheINdexeddb#_init"),this._db=new Dexie(this._dbName),this._db.version(1).stores({layers:"id,jsonData,timestamp",annosPerCanvas:"canvasId,jsonData,timestamp"}),this._db.open().catch(function(n){t._valid=!1,u.error("AnnotationCache#setupIndexDb open failed:",n)})}},{key:"isValid",value:function(){return this._valid}},{key:"deleteDb",value:function(){return u.debug("AnnotationCache#deleteDb"),Dexie.delete(this._dbName)}},{key:"getLayers",value:function(){return u.debug("AnnotationCache#getLayers"),this._db.layers.where("id").equals(1).first(function(t){var n=void 0!==t?t.jsonData:null;return n instanceof Array?n:[]})}},{key:"setLayers",value:function(t){u.debug("AnnotationCache#setLayers",t);var n=this;return this._emptyTable("layers").then(function(){return n._db.layers.add({id:1,jsonData:t}).catch(function(t){throw u.error("AnnotatinCache#setLayers update failed: "+t),t})})}},{key:"getAnnotationsPerCanvas",value:function(t){u.debug("AnnotationCache#getAnnotationsPerCanvas",t);var n=this;return this._db.annosPerCanvas.where("canvasId").equals(t).and(function(t){var e=(new Date).valueOf();return u.debug("AnnotationCache#getAnnotationsPerCanvas expiration test: "+(e<t.timestamp+n._expiresInMS)),e<t.timestamp+n._expiresInMS}).first(function(t){return t?t.jsonData:null})}},{key:"setAnnotationsPerCanvas",value:function(t,n){var e=this;u.debug("AnnotationCache#setAnnotationsPerCanvas canvas:",t,"data:",n);var r=this._db.annosPerCanvas,o=(this._db.annosPerCanvas.where("canvasId").equals(t),{canvasId:t,jsonData:n,timestamp:(new Date).valueOf()});return r.put(o).catch(function(t){u.error("AnnotationCache#setAnnotationsPerCanvas put failed for",o,": "+t),e._valid=!1})}},{key:"invalidateAllCanvases",value:function(){return u.debug("AnnotationCache#invalidateAllCanvases"),this._emptyTable("annosPerCanvas")}},{key:"invalidateCanvasId",value:function(t){return u.debug("AnnotationCache#invalidateCanvasId canvasId:",t),this._deleteAnnotationsPerCanvas(t)}},{key:"_emptyTable",value:function(t){u.debug("AnnotationCache#emptyTable",t);var n=this._db.table(t);return this._db.transaction("rw",n,function(){n.each(function(e,r){u.debug("AnnotationCache#emptyTable deleting",r.key),n.delete(r.key).catch(function(n){u.error("AnnotationCache#emptyTable deleting from table "+t+": "+n)})})})}},{key:"_deleteAnnotationsPerCanvas",value:function(t){u.debug("AnnotationCache#deleteAnnotationsPerCanvas canvasId:",t);return this._db.annosPerCanvas.where("canvasId").equals(t).delete().catch(function(n){u.error("AnnotationCache#deleteAnnotationsPerCanvas failed to delete canvasId: "+t)})}}]),t}();n.default=s},function(t,n,e){"use strict";function r(t){return function(){var n=t.apply(this,arguments);return new Promise(function(t,e){function r(o,i){try{var a=n[o](i),u=a.value}catch(t){return void e(t)}if(!a.done)return Promise.resolve(u).then(function(t){r("next",t)},function(t){r("throw",t)});t(u)}return r("next")})}}function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),a=e(1),u=(0,function(t){return t&&t.__esModule?t:{default:t}}(e(0)).default)(),s=function(){function t(n){o(this,t),this.options=Object.assign({tocSpec:null,annotationExplorer:null},n),this._cache={}}return i(t,[{key:"getToc",value:function(){var t=r(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(u.debug("AnnotationTocCache#getToc canvasId:",n),this._cache[n]){t.next=7;break}return t.next=4,this.createToc(n);case 4:this._cache[n]=t.sent,t.next=8;break;case 7:u.debug("AnnotationTocCache#getToc hit cache",n);case 8:return u.debug("AnnotationTocCache getToc toc:",this._cache[n]),t.abrupt("return",this._cache[n]);case 10:case"end":return t.stop()}},t,this)}));return function(n){return t.apply(this,arguments)}}()},{key:"createToc",value:function(){var t=r(regeneratorRuntime.mark(function t(n){var e,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.options.annotationExplorer.getAnnotations({canvasId:n});case 2:return e=t.sent,r=new a.AnnotationToc(this.options.tocSpec,e,{logger:u}),t.abrupt("return",r);case 5:case"end":return t.stop()}},t,this)}));return function(n){return t.apply(this,arguments)}}()},{key:"invalidate",value:function(t){delete this._cache[t]}}]),t}();n.default=s},function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}();n.default=function(){return a||(a=new u),a};var i=function(t){return t&&t.__esModule?t:{default:t}}(e(0)),a=null,u=function(){function t(){r(this,t),this.logger=(0,i.default)()}return o(t,[{key:"fetchSettingsFromHtml",value:function(t){var n={},e=t.attr("data-toc-tags")||"",r=t.attr("data-layer-ids")||"";return n.apiUrl=t.attr("data-settings-url"),n.roomId=t.attr("data-room-id"),n.manifestUri=t.attr("data-manifest-url"),n.projectId=t.attr("data-room-id"),n.canvasId=t.attr("data-canvas-id")||"",n.tocTags=e?e.split(","):[],n.layerIds=r?r.split(","):[],n.annotationId=t.attr("data-annotation-id")||null,n}},{key:"fetchSettingsFromApi",value:function(t,n){var e=t+"?room_id="+n;return this.logger.debug("ConfigFetcher#fetchSettingsFromApi url:",e),new Promise(function(t,n){jQuery.Deferred();jQuery.ajax({url:e,success:function(n){t(n)},error:function(){n("Failed to fetch server settings from "+e)}})})}}]),t}()},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={en:{nextCanvas:"Next Canvas",previousCanvas:"Previous Canvas",showBottomPanel:"Show Canvas List",hideBottomPanel:"Hide Canvas List"},ko:{nextCanvas:" ",previousCanvas:" ",showBottomPanel:" ",hideBottomPanel:"  "}}},function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,n){var e=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return e}return function(n,e){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return t(n,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),u=function(t){return t&&t.__esModule?t:{default:t}}(e(23)),s=function(){function t(){r(this,t)}return a(t,[{key:"getLocalesConfig",value:function(t){var n=u.default,e=t.ui.i18nOverrides;if("object"===(void 0===e?"undefined":i(e))){var r=!0,a=!1,s=void 0;try{for(var c,l=Object.entries(e)[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var f=o(c.value,2),d=f[0],h=f[1];n[d]||(n[d]={});var v=!0,g=!1,p=void 0;try{for(var y,m=Object.entries(h)[Symbol.iterator]();!(v=(y=m.next()).done);v=!0){var _=o(y.value,2),b=_[0],w=_[1];n[d][b]=w}}catch(t){g=!0,p=t}finally{try{!v&&m.return&&m.return()}finally{if(g)throw p}}}}catch(t){a=!0,s=t}finally{try{!r&&l.return&&l.return()}finally{if(a)throw s}}}return n}}]),t}();n.default=s},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),a=r(e(8)),u=r(e(0)),s=r(e(2)),c=r(e(24)),l=(0,u.default)(),f=function(){function t(n){o(this,t),l.debug("MiradorConfigBuilder#constructor options:",n),this._options=n,this._state=(0,s.default)();var e=this._state.getSetting("initialLayout","windows")[0];this._manifestUri=e.manifest,this._canvasId=e.canvas}return i(t,[{key:"buildConfig",value:function(){var t=jQuery.extend(!0,{},this._options.defaultSettings),n=this._state.getSetting("annotations","tocSpec");jQuery.extend(t,{id:this._options.miradorId,buildPath:this._options.mirador.buildPath||"/",i18nPath:"/locales/",imagesPath:"/images/",logosPath:"/images/logos/",mainMenuSettings:{show:!1},data:[{manifestUri:this._manifestUri}],windowObjects:[this.windowObject()],autoHideControls:!1,annotationEndpoint:this.endPointConfig(),annotationBodyEditor:{module:"AnnotationEditor",options:{miradorDriven:!0,mode:"create"}},i18nAdditions:(new c.default).getLocalesConfig(this._options)});var e=t.windowSettings;e.displayLayout=!1,n&&(e.sidePanelOptions.annotationTocTabAvailable=!0,e.sidePanelOptions.tocTabAvailable=!1),this._state.getSetting("auth","isEditor")||(e.canvasControls.annotations.annotationCreation=!1),this._state.getSetting("mirador","annotationsOverlay","showByDefault")&&(e.canvasControls.annotations.annotationState="on");var r=this._state.getSetting("mirador","annotationsOverlay","hoverColor"),o=this._state.getSetting("mirador","annotationsOverlay","hoverWidthFactor");return r&&(t.drawingToolsSettings.hoverColor=r),o&&(t.drawingToolsSettings.hoverWidthFactor=o),l.debug("MiradorConfigBuilder#buildConfig config:",t),t}},{key:"windowObject",value:function(){var t={loadedManifest:this._manifestUri,bottomPanelVisible:!1};return this._canvasId&&(t.canvasID=this._canvasId),t}},{key:"endPointConfig",value:function(){return{name:"Yale Annotations",module:"YaleEndpoint",dataSource:a.default,options:{prefix:this._options.endpointUrl}}}}]),t}();n.default=f},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),a=r(e(0)),u=r(e(2)),s=(0,a.default)(),c=function(){function t(n){o(this,t),this.options=Object.assign({element:null,appendTo:null,windowId:null,structures:[],manifestVersion:null,previousSelectedElements:[],selectedElements:[],previousOpenElements:[],openElements:[],hoveredElement:[],selectContext:null,tocData:{},active:null,eventEmitter:null},n),this.init()}return i(t,[{key:"init",value:function(){var t=this,n=(0,u.default)().getSetting("annotations","tocSpec");if(n){this.element=jQuery(l()).appendTo(this.options.appendTo);for(var e=n.generator[0],r=0;r<e.max;++r){var o=this._createItem(r,n);this.element.append(o)}}else this.element=jQuery(f()).appendTo(this.options.appendTo);this._selectedElem=null,this.element.data("AnnotationTableOfContent",this),this.element.mousemove(function(t){t.stopPropagation()}),this.element.mouseenter(function(n){t._unselect()})}},{key:"scrollToTags",value:function(t){s.debug("AnnotationTableOfContents#scrollToTags tags:",t);var n="."+t[0],e=this.element.find(n);this._select(e),this.element.scrollTo(e,500)}},{key:"_select",value:function(t){this._unselect(),this._selectedElem=t,t.addClass("selected")}},{key:"_unselect",value:function(){this._selectedElem&&this._selectedElem.removeClass("selected")}},{key:"_createItem",value:function(t,n){var e=this,r=n.generator[0],o=r.tag.prefix+(t+1),i=jQuery(d({tag:o,content:r.descriptions[t]})),a=n.canvasMap[o];return i.click(function(t){var n=e.options.windowId;e._savedScrollTop=e.element.scrollTop(),t.preventDefault(),jQuery(this).focus(),jQuery.publish("YM_ANNOTATION_TOC_TAGS_SELECTED",[n,a[0],[o]]),setTimeout(function(){e.element.scrollTo(e._savedScrollTop)},0)}),i}}]),t}();n.default=c;var l=Handlebars.compile(['<div class="ym-annotation-toc">',"<h1>Table of Contents</h1>","</div>"].join("")),f=Handlebars.compile(['<div class="ym-annotation-toc">',"Table of contents is empty","</div>"].join("")),d=Handlebars.compile(['<div class="ym-annotation-toc-item {{tag}}" tabindex="-1">','<a href="#">{{{content}}}</a>',"</div>"].join(""))},function(t,n,e){"use strict";var r=function(t){return t&&t.__esModule?t:{default:t}}(e(0));!function(t){var n=Handlebars.compile(['<div class="header"></div>','<div class="content">','  <div class="description">',"    <p>{{message}}</p>","  </div>","</div>",'<div class="actions">','  <div class="ui ok button">{{yesLabel}}</div>','  <div class="ui cancel button">{{noLabel}}</div>',"</div>"].join(""));t.DialogBuilder=function(t){this.logger=(0,r.default)();var n="ym_dialog",e=jQuery("#"+n);0===e.length&&(e=jQuery("<div/>").attr("id",n).addClass("ui modal ym_modal").appendTo(jQuery("body"))),this.elem=e},t.DialogBuilder.prototype={confirm:function(t,n){n(window.confirm(t))},dialog:function(t){this.logger.debug("DialogBuilder#dialog opts:",t);var e=t.buttons.yes,r=t.buttons.no;this.elem.html(n({message:t.message,yesLabel:e.label,noLabel:r.label})),this.elem.modal({onApprove:function(t){"function"==typeof e.callback&&e.callback()},onDeny:function(t){"function"==typeof r.callback&&r.callback()}}),this.elem.modal("show")}}}(Mirador)},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e(1);var o=r(e(0)),i=r(e(2));r(e(7));!function(t){t.yaleExt=t.yaleExt||{};var n=(0,o.default)();jQuery.extend(t.yaleExt,{getCombinedBounds:function(t){n.debug("yaleExt.getCombinedBounds shapes:",t);var e=null;return jQuery.each(t,function(t,r){e=e?e.unite(r.strokeBounds):r.strokeBounds,n.debug("index: "+t+", bounds: "+e)}),e},updateTooltipStyles:function(){var t=jQuery(".qtip-default, .qtip-content"),n=(0,i.default)().getSetting("mirador","tooltipStyles");n&&(t.css("color",n.color),t.css("background-color",n.backgroundColor),t.css("border",n.border))},truncate:function(t,n){var e=t.replace(/<(?:.|\n)*?>/gm,"");return(e=e.replace(/&.*?;/gm,"")).length>n?e.slice(0,n-3)+"...":e}})}(Mirador)},function(t,n,e){"use strict";var r=function(t){return t&&t.__esModule?t:{default:t}}(e(0));!function(t){(0,r.default)();t.Hud.prototype.qtipExtra=function(t){this.element.find(".mirador-osd-previous").each(function(){jQuery(this).qtip({content:{text:jQuery(this).attr("title")},position:{my:"bottom left",at:"top left"},style:{classes:"qtip-dark qtip-shadow qtip-rounded",tip:!1}})}),this.element.find(".mirador-osd-next").each(function(){jQuery(this).qtip({content:{text:jQuery(this).attr("title")},position:{my:"bottom right",at:"top right"},style:{classes:"qtip-dark qtip-shadow qtip-rounded",tip:!1}})})},t.Hud.prototype.toggleBottomPanelQtip=function(t){var n=t?i18next.t("hideBottomPanel"):i18next.t("showBottomPanel"),e=this.element.find(".mirador-osd-toggle-bottom-panel");this._bottomPanelQtipInitialized?e.qtip("option","content.text",n):(e.each(function(){jQuery(this).qtip({content:{text:n},position:{my:"bottom center",at:"top center",adjust:{method:"shift",y:10}},style:{classes:"qtip-dark qtip-shadow qtip-rounded"}})}),this._bottomPanelQtipInitialized=!0)}}(Mirador)},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=e(1),i=r(e(0)),a=r(e(3));!function(t){t.yaleExt=t.yaleExt||{};var n=(0,i.default)();t.ImageView.prototype.enableAnnotationLayer=function(){this.annotationState="on"},t.ImageView.prototype.zoomToAnnotation=function(e){n.debug("ImageView(ext)#zoomToAnnotation annotation:",e);var r=void 0,o=void 0,i=void 0,a=void 0;try{var u=this.osd.viewport;r=u.getZoom(),o=this.annotationsLayer.drawTool.getShapesForAnnotation(e),i=t.yaleExt.getCombinedBounds(o);var s=u.imageToViewportCoordinates(i.width,i.height),c=u.getBounds(),l=s.x/c.width,f=s.y/c.height;if("number"!=typeof(a=1/Math.max(l,f)*.75)||isNaN(a)){var d="ImageView(ext)#zoomToAnnotation invalid zoomFactor "+a;throw n.error(d,e),d}u.zoomBy(a)}catch(t){n.error("ImageView(ext)#zoomToAnnotation failed for annotation",e,"-",t),n.error("oldZoom:",r,"shapes:",o,"shapeBounds:",i,"zoomFactor:",a)}},t.ImageView.prototype.panToAnnotation=function(e){n.debug("ImageView(ext)#panToAnnotation anno:",e);var r=this.osd.viewport,o=this.annotationsLayer.drawTool.getShapesForAnnotation(e),i=t.yaleExt.getCombinedBounds(o),a=i.x+i.width/2,u=i.y+i.height/2,s=(new OpenSeadragon.Point(a,u),r.imageToViewportCoordinates(i.x,i.y)),c=r.imageToViewportCoordinates(i.width,i.height),l=s.x,f=s.x+c.x,d=s.y,h=s.y+c.y,v=r.getBounds(),g=(r.getHomeBounds().height,v.x),p=v.x+v.width,y=v.y,m=v.y+v.height,_=.08/r.getZoom(),b=0,w=0;if(f+_>p?l-_<g?b=l-_-g:l-(b=f+_-p)-_<g&&(b-=g-(l-b-_)):l-_<g&&(b=l-_-g),h+_>m?d-_<y?w=d-_-y:d-(w=h+_-m)-_<y&&(w-=y-(d-w-_)):d-_<y&&(w=d-_-y),"number"!=typeof b||isNaN(b)||"number"!=typeof w||isNaN(w)){var x="ImageView(ext)#panToAnnotation invalid value(s) panX: "+b+", panY: "+w;throw n.error(x,e),x}r.panBy(new OpenSeadragon.Point(b,w))};var e=t.ImageView.prototype.listenForActions;t.ImageView.prototype.listenForActions=function(){var t=this;e.call(this),this.eventEmitter.subscribe("ANNOTATIONS_LIST_UPDATED",function(e){n.debug("ImageView(ext):SUB:ANNOTATIONS_LIST_UPDATED window:",t.windowId,"annotationToBeFocused:",t._annotationToBeFocused),t._annotationToBeFocused&&setTimeout(function(){var e=(0,a.default)().getWindowProxyById(t.windowId),r=t._annotationToBeFocused;if(!o.annoUtil.hasTargetOnCanvas(r)){var i={},u=!0,s=!1,c=void 0;try{for(var l,f=e.getAnnotationsList()[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var d=l.value;i[d["@id"]]=d}}catch(t){s=!0,c=t}finally{try{!u&&f.return&&f.return()}finally{if(s)throw c}}r=o.annoUtil.findTransitiveTargetAnnotations(r,i).filter(function(t){var n=!0,r=!1,i=void 0;try{for(var a,u=(0,o.Anno)(t).targets[Symbol.iterator]();!(n=(a=u.next()).done);n=!0)if(a.value.full===e.getCurrentCanvasId())return!0}catch(t){r=!0,i=t}finally{try{!n&&u.return&&u.return()}finally{if(r)throw i}}return!1})[0]}t._annotationToBeFocused=null,r?(t.zoomToAnnotation(r),t.panToAnnotation(r),t.annotationsLayer.drawTool.updateHighlights(r)):n.error("ImageWindow(ext):SUB:ANNOTATIONS_LIST_UPDATED annotation not found")},500)}),this.eventEmitter.subscribe("YM_DISPLAY_ON",function(e){n.debug("ExtImageView:SUB:YM_DISPLAY_ON"),"off"===t.hud.annoState.current&&t.hud.annoState.displayOn(t.element.find(".mirador-osd-annotations-layer"))})}}(Mirador)},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=function(){function t(t,n){var e=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return e}return function(n,e){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return t(n,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=r(e(0)),a=r(e(2));!function(t){function n(t){var n=0,e=0,r=!0,o=!1,i=void 0;try{for(var a,u=t.sequences[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var s=a.value,c=!0,l=!1,f=void 0;try{for(var d,h=s.canvases[Symbol.iterator]();!(c=(d=h.next()).done);c=!0){var v=d.value;v.width>n&&(n=v.width),v.height>e&&(e=v.height)}}catch(t){l=!0,f=t}finally{try{!c&&h.return&&h.return()}finally{if(l)throw f}}}}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}var g=Math.min(Math.max(n,e),4096);return[g,g]}function e(t){var n=t.canvases,e=!0,o=!1,i=void 0;try{for(var a,u=n[Symbol.iterator]();!(e=(a=u.next()).done);e=!0)r(a.value)}catch(t){o=!0,i=t}finally{try{!e&&u.return&&u.return()}finally{if(o)throw i}}}function r(t){var n=t.images;t.width=l,t.height=f;var e=!0,r=!1,o=void 0;try{for(var i,a=n[Symbol.iterator]();!(e=(i=a.next()).done);e=!0)u(i.value)}catch(t){r=!0,o=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw o}}}function u(t){var n=t.resource;n["@id"]=c+"/full/"+l+","+f+"/0/default.jpg",n.service["@id"]=c,n.width=String(l),n.height=String(f)}var s=(0,i.default)(),c="",l=1,f=1;t.Manifest.prototype.processCopyright=function(t){if(s.debug("Manifest#processCopyright jsonLd in:",t),(0,a.default)().getSetting("auth","images","copyrighted")){c=(0,a.default)().getSetting("auth","images","altImageService");var r=n(t),i=o(r,2);l=i[0],f=i[1];var u=t.sequences,d=!0,h=!1,v=void 0;try{for(var g,p=u[Symbol.iterator]();!(d=(g=p.next()).done);d=!0)e(g.value)}catch(t){h=!0,v=t}finally{try{!d&&p.return&&p.return()}finally{if(h)throw v}}}return s.debug("Manifest#processCopyright jsonLd out:",t),t}}(Mirador)},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=r(e(0)),i=r(e(2));!function(t){var n=(0,o.default)();t.OsdRegionDrawTool.prototype.getShapesForAnnotation=function(t){n.debug("OsdRegionDrawTool(ext)#getShapesForAnnotation this.annotationsToShapesMap:",this.annotationsToShapesMap);var e=[];return jQuery.each(this.annotationsToShapesMap,function(n,r){n===t["@id"]&&jQuery.each(r,function(t,n){e.push(n)})}),e},t.OsdRegionDrawTool.prototype.saveStrokeColor=function(t){t.data._ym_defaultStrokeColor||(t.data._ym_defaultStrokeColor=t.strokeColor)},t.OsdRegionDrawTool.prototype.saveStrokeWidth=function(t){t.data._ym_defaultStrokeWidth||(t.data._ym_defaultStrokeWidth=t.data.strokeWidth)},t.OsdRegionDrawTool.prototype.getDefaultStrokeWidth=function(t){return"number"==typeof t.data._ym_defaultStrokeWidth?t.data._ym_defaultStrokeWidth:t.data.strokeWidth},t.OsdRegionDrawTool.prototype.updateHighlights=function(t){n.debug("OsdRegionDrawTool(ext)#updateHighlights annotation:",t);var e=this;jQuery.each(this.annotationsToShapesMap,function(n,r){jQuery.each(r,function(n,r){r.data.annotation["@id"]===t["@id"]?(e.highlightShape(r),r.bringToFront()):(e.deHighlightShape(r),r.sendToBack())})}),this.osdViewer.forceRedraw()},t.OsdRegionDrawTool.prototype.updateShapesVisibility=function(t){var n=!0,e=!1,r=void 0;try{for(var o,a=Object.values(this.annotationsToShapesMap)[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var u=o.value,s=!0,c=!1,l=void 0;try{for(var f,d=u[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){var h=f.value,v=!0,g=!1,p=void 0;try{for(var y,m=t[Symbol.iterator]();!(v=(y=m.next()).done);v=!0){var _=y.value;if(h.data.annotation["@id"]===_["@id"])h.bringToFront(),h.opacity=1;else{h.sendToBack();var b=(0,i.default)().getSetting("mirador","annotationsOverlay","hideUnfocused");h.opacity=b?0:1}}}catch(t){g=!0,p=t}finally{try{!v&&m.return&&m.return()}finally{if(g)throw p}}}}catch(t){c=!0,l=t}finally{try{!s&&d.return&&d.return()}finally{if(c)throw l}}}}catch(t){e=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(e)throw r}}},t.OsdRegionDrawTool.prototype.highlightShape=function(t){this.saveStrokeColor(t),this.saveStrokeWidth(t);var n=(0,i.default)(),e=n.getSetting("mirador","annotationsOverlay","hoverColor"),r=n.getSetting("mirador","annotationsOverlay","hoverWidthFactor");if(e&&(t.strokeColor=e),r){var o=t.data._ym_defaultStrokeWidth;t.data.strokeWidth=r*("number"==typeof o?o:t.data.strokeWidth)}t.set({opacity:1})},t.OsdRegionDrawTool.prototype.deHighlightShape=function(t){t.data._ym_defaultStrokeColor&&(t.strokeColor=t.data._ym_defaultStrokeColor),t._ym_defaultStrokeWidth&&(t.data.strokeWidth=t._ym_defaultStrokeWidth);var n=(0,i.default)().getSetting("mirador","annotationsOverlay","hideUnfocused");t.opacity=n?0:1}}(Mirador)},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=r(e(14)),i=r(e(26)),a=e(13);e(27),e(28),e(29),e(30),e(31),e(32),function(t){t.AnnotationEditor=o.default,t.AnnotationTableOfContents=i.default,t.YaleEndpoint=a.YaleEndpoint}(Mirador)},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t){return function(){var n=t.apply(this,arguments);return new Promise(function(t,e){function r(o,i){try{var a=n[o](i),u=a.value}catch(t){return void e(t)}if(!a.done)return Promise.resolve(u).then(function(t){r("next",t)},function(t){r("throw",t)});t(u)}return r("next")})}}function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),u=r(e(4)),s=r(e(0)),c=r(e(3)),l=r(e(10)),f=r(e(2)),d=r(e(42)),h=(0,s.default)(),v=function(){function t(n){i(this,t),this.init(n)}return a(t,[{key:"init",value:function(t){h.debug("Grid#init"),this.element=jQuery("#"+t),this._state=(0,f.default)(),this.miradorProxyManager=(0,c.default)(),this._annotationExplorer=(0,u.default)().getAnnotationExplorer(),this._annotationWindows={},this.initLayout(),this.bindEvents()}},{key:"initLayout",value:function(){var t=this;h.debug("Grid#initLayout");this._layout=new GoldenLayout({settings:{hasHeaders:!0,showPopoutIcon:!1,selectionEnabled:!1},dimensions:{minItemWidth:200,minItemHeight:200},content:[{type:"row",isClosable:!1,content:[]}]},this.element),this._layout.registerComponent("Mirador",function(t,n){h.debug("Registering component container:",t,"componentState:",n);var e=jQuery("<div/>").attr("id",n.miradorId);t.getElement().append(e)}),this._layout.registerComponent("Annotations",function(t,n){var e=n.windowId,r=jQuery("<div/>").attr("id",e)[0];t.getElement().html(r.outerHTML)}),this._layout.on("stateChanged",function(n){h.debug("GoldenLayout stateChanged event:",n);var e=!0,r=!1,o=void 0;try{for(var i,a=t.miradorProxyManager.getMiradorProxies()[Symbol.iterator]();!(e=(i=a.next()).done);e=!0)i.value.publish("resizeMirador")}catch(t){r=!0,o=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw o}}return!0}),this._layout.on("itemDestroyed",function(n){if(h.debug("GoldenLayout itemDestroyed item:",n),"Annotations"==n.componentName){var e=n.config.componentState.windowId;h.debug("Annotation window destroyed:",e),t._annotationWindows[e].destroy(),delete t._annotationWindows[e],t._resizeWindows()}}),this._layout.init()}},{key:"resize",value:function(){h.debug("Grid#resize"),this.element.css("bottom",0),this._layout.updateSize()}},{key:"addMiradorWindow",value:function(t){h.debug("Grid#addMiradorWindow miradorId:",t);var n={type:"component",componentName:"Mirador",componentState:{miradorId:t},isClosable:!1};this._layout.root.contentItems[0].addChild(n)}},{key:"addAnnotationWindows",value:function(t){h.debug("Grid#addAnnotationWindows config:",t);var n=!0,e=!1,r=void 0;try{for(var o,i=t.windows[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){var a=o.value;this.addAnnotationWindow(a)}}catch(t){e=!0,r=t}finally{try{!n&&i.return&&i.return()}finally{if(e)throw r}}}},{key:"addAnnotationWindow",value:function(){var t=o(regeneratorRuntime.mark(function t(n){var e,r,o,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return h.debug("Grid#addAnnotationWindow options:",n),t.next=3,(0,l.default)().show("Opening an annotation window...");case 3:return e=Mirador.genUUID(),r=n.imageWindowId||null,o={id:e,type:"component",componentName:"Annotations",componentState:{windowId:e}},this._layout.root.contentItems[0].addChild(o),i=(0,u.default)().getAnnotationExplorer(),a=new d.default({id:e,appendTo:jQuery("#"+e),explorer:i,miradorId:n.miradorId||null,canvasWindowId:r,initialLayerId:n.layerId||this._pickLayer(),initialTocTags:n.tocTags||[],annotationId:n.annotationId||null,appState:this._state}),t.next=11,a.init().catch(function(t){h.error("Grid#addAnnotationWindow annoWin.init failed:",t)});case 11:return this._annotationWindows[e]=a,this._resizeWindows(),(0,l.default)().hide(),t.abrupt("return",a);case 15:case"end":return t.stop()}},t,this)}));return function(n){return t.apply(this,arguments)}}()},{key:"getAnnotationWindows",value:function(){return this._annotationWindows}},{key:"getAnnotationWindowByLayer",value:function(t){h.debug("Grid#getAnnotationWindowByLayer layerId:",t,"windows:",this._annotationWindows);var n=!0,e=!1,r=void 0;try{for(var o,i=Object.values(this._annotationWindows)[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){var a=o.value;if(a.getCurrentLayerId()===t)return a}}catch(t){e=!0,r=t}finally{try{!n&&i.return&&i.return()}finally{if(e)throw r}}return null}},{key:"bindEvents",value:function(){var t=this;h.debug("Grid#bindEvents"),jQuery.subscribe("YM_ADD_WINDOW",function(n,e){t.addAnnotationWindow(e||{})}),jQuery.subscribe("YM_ADD_WINDOWS",function(n,e){h.debug("Received YM_ADD_WINDOWS config:",e),t.addAnnotationWindows(e)})}},{key:"_resizeWindows",value:function(){var t=Object.keys(this._annotationWindows),n=t.length,e=0;switch(n){case 1:e=20;break;case 2:e=25;break;default:e=100/(n+1)}var r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var s=a.value;this._setWidth(s,e)}}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}}},{key:"_setWidth",value:function(t,n){h.debug("Grid#_setWidth itemId:",t,"width:",n),this._layout.root.getItemsById(t)[0].parent.config.width=n,this._layout.updateSize()}},{key:"_pickLayer",value:function(){var t=(0,f.default)().getTransient("annotationLayers"),n=!0,e=!1,r=void 0;try{for(var o,i=t[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){var a=o.value["@id"],u=!0,s=!0,c=!1,l=void 0;try{for(var d,h=Object.values(this._annotationWindows)[Symbol.iterator]();!(s=(d=h.next()).done);s=!0)if(a===d.value.getCurrentLayerId()){u=!1;break}}catch(t){c=!0,l=t}finally{try{!s&&h.return&&h.return()}finally{if(c)throw l}}if(u)return a}}catch(t){e=!0,r=t}finally{try{!n&&i.return&&i.return()}finally{if(e)throw r}}return t[0]["@id"]}}]),t}();n.default=v},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),a=r(e(0)),u=r(e(3)),s=(0,a.default)(),c=(0,u.default)(),l=function(){function t(n){o(this,t),this.options=Object.assign({imageWindowId:null,layerIds:[],toc:null,tocTags:[]},n)}return i(t,[{key:"getWindowsConfig",value:function(){var t=this.options.annotationId,n=this.options.layerIds,e=this.options.tocTags;if(t){var r=this._findAnnotation(t);if(!r)return s.error("LayoutConfigParser#getWindowsConfig cannot find annotation",t),null;n=[r.layerId],this.options.toc&&(e=this.options.toc.getTagsFromAnnotationId(t)).length<1&&s.error("LayoutConfigParser#getWindowsConfig no toc tags for annotation",t)}var o={windows:[]};if(n instanceof Array&&n.length>0){var i=!0,a=!1,u=void 0;try{for(var c,l=n[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var f=c.value;o.windows.push({type:"ANNOTATION_WINDOW",miradorId:this.options.miradorId,imageWindowId:this.options.imageWindowId,layerId:f||null,annotationId:t||null,tocTags:e||[]})}}catch(t){a=!0,u=t}finally{try{!i&&l.return&&l.return()}finally{if(a)throw u}}}return o.windows.length>0?o:null}},{key:"_findAnnotation",value:function(t){var n=c.getWindowProxyById(this.options.imageWindowId).getAnnotationsList().filter(function(n){return n["@id"]===t});return n.length>0?n[0]:null}}]),t}();n.default=l},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),a=r(e(0)),u=r(e(37)),s=r(e(5)),c=((0,a.default)(),function(){function t(n,e){o(this,t),this._mirador=n,this._workspaceProxy=null,this._id=e,this._ignoredEvents=new Set}return i(t,[{key:"getId",value:function(){return this._id}},{key:"getWorkspaceProxy",value:function(){return this._workspaceProxy||(this._workspaceProxy=new u.default(this._mirador.viewer.workspace)),this._workspaceProxy}},{key:"getWindowProxies",value:function(){return this.getWorkspaceProxy().getWindowProxies()}},{key:"getWindowProxyById",value:function(t){return new s.default(this.getWindowById(t))}},{key:"getWindowById",value:function(t){return this.getWorkspaceProxy().getWindowById(t)}},{key:"publish",value:function(){var t=this._mirador.eventEmitter,n=Array.from(arguments);t.publish.apply(t,n)}},{key:"subscribe",value:function(t,n){this._mirador.eventEmitter.subscribe(t,n)}},{key:"unsubscribe",value:function(t,n){this._mirador.eventEmitter.unsubscribe(t,n)}},{key:"shouldIgnoreEvent",value:function(t){return this._ignoredEvents.has(t)}},{key:"markEventToBeIgnored",value:function(t){this._ignoredEvents.add(t)}},{key:"unmarkEventToBeIgnored",value:function(t){this._ignoredEvents.delete(t)}}]),t}());n.default=c},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),a=r(e(0)),u=r(e(5)),s=function(){function t(n){o(this,t),this.logger=(0,a.default)(),this.workspace=n}return i(t,[{key:"getWorkspace",value:function(){return this.workspace}},{key:"getWindowProxies",value:function(){return this.workspace.windows.map(function(t){return new u.default(t)})}},{key:"getWindowById",value:function(t){var n=this.workspace.windows.filter(function(n){return n.id===t}),e=n.length;return e>1&&this.logger.error("MiradorProxy#getWindowById: more than one ("+e+") found for id: "+t),e>0?n[0]:null}}]),t}();n.default=s},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t){return function(){var n=t.apply(this,arguments);return new Promise(function(t,e){function r(o,i){try{var a=n[o](i),u=a.value}catch(t){return void e(t)}if(!a.done)return Promise.resolve(u).then(function(t){r("next",t)},function(t){r("throw",t)});t(u)}return r("next")})}}function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),u=r(e(4)),s=r(e(0)),c=r(e(10)),l=r(e(3)),f=r(e(25)),d=e(39),h=(r(e(5)),(0,s.default)()),v=(0,l.default)(),g=function(){function t(n){i(this,t),h.debug("MiradorWrapper#constructor options:",n),this.options=Object.assign({grid:null,miradorOptions:null},n),this._miradorId=n.miradorOptions.miradorId,this._miradorConfig=this._buildMiradorConfig(n.miradorOptions),h.debug("MiradorWrapper#constructor miradorConfig:",this._miradorConfig),this._mirador=Mirador(this._miradorConfig),this._miradorProxy=this._addToMiradorProxy(this._miradorId,this._mirador),this._bindEvents(n.miradorOptions)}return a(t,[{key:"getMirador",value:function(){return this._mirador}},{key:"getMiradorProxy",value:function(){return this._miradorProxy}},{key:"getConfig",value:function(){return this._miradorConfig}},{key:"_buildMiradorConfig",value:function(t){return new f.default(t).buildConfig()}},{key:"_addToMiradorProxy",value:function(t,n){var e=v.addMirador(t,n);return e.subscribe("OPEN_ANNOTATION_SELECTOR",function(t,n,e){(0,d.openAnnotationSelector)(n).then(function(t){e.loadAnnotation(t)})}),e}},{key:"zoomToTags",value:function(){var t=o(regeneratorRuntime.mark(function t(n,e,r){var o,i,a,s,c,l,f,d=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return h.debug("MiradorWrapper#zoomToTags windowId:",n,"canvasId:",e,"tags:",r),o=(0,u.default)().getAnnotationTocCache(),t.next=4,o.getToc(e);case 4:return i=t.sent,a=this._miradorProxy.getWindowProxyById(n),s=a.getImageView(),c=i.getNodeFromTags(r),h.debug("tocNode:",c),l=c.canvasAnnotations[0],f=function(t){s.zoomToAnnotation(l),s.panToAnnotation(l),a.getDrawTool().updateHighlights(l)},t.abrupt("return",new Promise(function(t,r){e===a.getCurrentCanvasId()?(f(),t()):(d._miradorProxy.subscribe("annotationsRendered."+n,function e(r){h.debug("MiradorWrapper#zoomToTags:SUB:annotationsRendered"),f(),d._miradorProxy.unsubscribe("annotationsRendered."+n,e),t()}),a.setCurrentCanvasId(e))}));case 12:case"end":return t.stop()}},t,this)}));return function(n,e,r){return t.apply(this,arguments)}}()},{key:"_bindEvents",value:function(t){var n=this;h.debug("MiradorWrapper#_bindEvents options:",t);var e=v.getMiradorProxy(this._miradorId);e.subscribe("YM_CLICKED_OPEN_ANNO_WINDOW",function(){var t=o(regeneratorRuntime.mark(function t(r,o){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return h.debug("MiradorWrappe:SUB:YM_CLICKED_OPEN_ANNO_WINDOW imageWindowId:",o),t.next=3,(0,c.default)().show("Opening an annotation window...");case 3:return e.publish("YM_DISPLAY_ON"),t.next=6,n.options.grid.addAnnotationWindow({miradorId:n._miradorId,imageWindowId:o});case 6:i=t.sent,(0,c.default)().hide();case 8:case"end":return t.stop()}},t,n)}));return function(n,e){return t.apply(this,arguments)}}()),jQuery.subscribe("ANNOWIN_ANNOTATION_FOCUSED",function(t,e){h.debug("MiradorWrapper:SUB:ANNOWIN_ANNOTATION_FOCUSED, params:",e);var r=v.getMiradorProxy(n._miradorId).getWindowProxyById(e.imageWindowId).getSidePanelTabContentElement("ym-annotation-toc").data("AnnotationTableOfContent");r&&r.scrollToTags(e.annotation.tocTags)})}}]),t}();n.default=g},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t){return function(){var n=t.apply(this,arguments);return new Promise(function(t,e){function r(o,i){try{var a=n[o](i),u=a.value}catch(t){return void e(t)}if(!a.done)return Promise.resolve(u).then(function(t){r("next",t)},function(t){r("throw",t)});t(u)}return r("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),n.openAnnotationSelector=void 0;var i=function(){var t=o(regeneratorRuntime.mark(function t(n){var e,r,o,i,s,f;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=(0,c.default)().getWindowProxyById(n),(r=e.getSvgOverlay()).removeMouseTool(),o=e.getEndPoint(),i=(0,u.default)().getAnnotationSource(),s=new a.AnnotationExplorer({dataSource:i}),t.next=8,s.getLayers();case 8:return f=t.sent,t.abrupt("return",new Promise(function(t,n){new a.AnnotationExplorerDialog({appendTo:jQuery("body"),annotationExplorer:s,canvases:e.getCanvases(),defaultCanvasId:e.getCurrentCanvasId(),layers:f,onSelect:function(n){t(n)},logger:l}).open()}).then(function(t){return r.setMouseTool(),t}).catch(function(t){r.setMouseTool(),l.error("openAnnotationExplorer returned with error",t)}));case 10:case"end":return t.stop()}},t,this)}));return function(n){return t.apply(this,arguments)}}(),a=e(1),u=(r(e(8)),r(e(4))),s=r(e(0)),c=r(e(3)),l=(0,s.default)();n.openAnnotationSelector=i},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t){return function(){var n=t.apply(this,arguments);return new Promise(function(t,e){function r(o,i){try{var a=n[o](i),u=a.value}catch(t){return void e(t)}if(!a.done)return Promise.resolve(u).then(function(t){r("next",t)},function(t){r("throw",t)});t(u)}return r("next")})}}function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),u=r(e(41)),s=r(e(44)),c=e(1),l=r(e(4)),f=r(e(0)),d=r(e(2)),h=r(e(47)),v=(0,f.default)(),g=function(){function t(n){i(this,t),v.debug("AnnotationListWidget#constructor options:",n),this._annoWin=n.annotationWindow,this._annoPageRenderer=n.annotationPageRenderer,this._annoExplorer=n.annotationExplorer,this._canvases=n.canvases,this._state=n.state,this._isEditor=n.isEditor,this._continuousPages=n.continuousPages,this._dom=this._annoWin.getDomHelper(),this._rootElem=this._dom.getListContainer(),this._minContentRelativeHeight=1.5,this._maxContentRelativeHeight=5,this._state||(this._state=(0,d.default)()),this._annoPageRenderer||(this._annoPageRenderer=new s.default({annotationWindow:this._annoWin,annotationExplorer:this._annoExplorer})),this._tocSpec=this._state.getSetting("annotations","tocSpec")}return a(t,[{key:"getRootElement",value:function(){return this._rootElem}},{key:"getAnnotationElems",value:function(){return this._dom.getAllAnnotationCells()}},{key:"reload",value:function(t){this._layerId=t,this._nav=this._setupNavigation(),this._loading=!1,this._rootElem.empty(),this._createPageElements(),this._scrollHelper=new h.default({annotationWindow:this._annoWin,listWidget:this,listNavigator:this._nav,groupHeaderHeight:19,continuousPages:this._continuousPages}),this._unbindEvents(),this._bindEvents()}},{key:"_setupNavigation",value:function(){return new u.default({canvases:this._canvases})}},{key:"getNav",value:function(){return this._nav}},{key:"goToPage",value:function(){var t=o(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(v.debug("AnnotationListWidgetr#goToPage",n,"from",this._nav.getPage()),n===this._nav.getPage()){t.next=5;break}return this._nav.setPage(n),t.next=5,this._onNavSetPage(n).catch(function(t){throw"AnnotationListWidget#goToPage _onNavSetPage("+n+") failed: "+t});case 5:case"end":return t.stop()}},t,this)}));return function(n){return t.apply(this,arguments)}}()},{key:"goToPageByCanvas",value:function(){var t=o(regeneratorRuntime.mark(function t(n){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return v.debug("AnnotationListWidgetr#goToPageByCanvas canvasId:",n),e=this._nav.getPageNumForCanvas(n),t.next=4,this.goToPage(e).catch(function(t){throw"AnnotationListWidget#goToPageByCanvas: goToPage("+e+") failed: "+t});case 4:case"end":return t.stop()}},t,this)}));return function(n){return t.apply(this,arguments)}}()},{key:"goToPageByTags",value:function(){var t=o(regeneratorRuntime.mark(function t(n){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(v.debug("AnnotationListWidgetr#goToPageByTags",n),!((e=this._tocSpec.canvasMap[n[0]])instanceof Array&&e.length>0)){t.next=6;break}return t.next=5,this.goToPageByCanvas(e[0]);case 5:this._scrollHelper.scrollToTags(n);case 6:case"end":return t.stop()}},t,this)}));return function(n){return t.apply(this,arguments)}}()},{key:"goToAnnotation",value:function(){var t=o(regeneratorRuntime.mark(function t(n,e){var r,o,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(v.debug("AnnotationListWidget#goToAnnotation annoId",n,"canvasId:",e),r=this._nav,!((o=r.getPageNumForCanvas(e))>=0)){t.next=9;break}return t.next=6,this.goToPage(o);case 6:setTimeout(function(){i._scrollHelper.scrollToAnnotation(n),i.clearAnnotationHighlights(),i.highlightAnnotation(n,"SELECTED")},0),t.next=10;break;case 9:v.debug("AnnotationListWidget#goToAnnotation page not found for canvasId",e);case 10:case"end":return t.stop()}},t,this)}));return function(n,e){return t.apply(this,arguments)}}()},{key:"_onNavSetPage",value:function(){var t=o(regeneratorRuntime.mark(function t(n){var e,r,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(v.debug("AnnotationListWidget#_onNavSetPage pageNum:",n),e=this._nav.getCanvas(n),r=this._annoWin.getCurrentCanvasId(),o=e["@id"],this._nav.isLoaded(n)){t.next=8;break}return this._unloadAllPages(),t.next=8,this._loadPage(n).catch(function(t){throw"AnnotationListWidget#_onNavSetPage _loadPage("+n+") failed: "+t});case 8:if(!this._continuousPages){t.next=15;break}return t.next=11,this.loadPreviousPage();case 11:return t.next=13,this.loadNextPage();case 13:return t.next=15,this._scrollHelper.scrollToPage(n);case 15:r!==o&&this._annoWin.getImageWindowProxy().setCurrentCanvasId(o);case 16:case"end":return t.stop()}},t,this)}));return function(n){return t.apply(this,arguments)}}()},{key:"loadNextPage",value:function(){var t=o(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(v.debug("AnnotationListWidget#loadNextPage loading:",this._loading),t.prev=1,!this._loading){t.next=4;break}return t.abrupt("return");case 4:if(this._loading=!0,!((n=this._nav.getActiveRange().endPage+1)<this._nav.getNumPages())){t.next=10;break}return t.next=9,this._loadPage(n);case 9:this._scrollHelper.scrollDown(30);case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),v.error("AnnotationListWidget#loadNextPages failed",t.t0);case 15:return t.prev=15,this._loading=!1,t.finish(15);case 18:case"end":return t.stop()}},t,this,[[1,12,15,18]])}));return function(){return t.apply(this,arguments)}}()},{key:"loadPreviousPage",value:function(){var t=o(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(v.debug("AnnotationListWidget#loadPreviousPage loading:",this._loading),t.prev=1,!this._loading){t.next=4;break}return t.abrupt("return");case 4:if(this._loading=!0,!((n=this._nav.getActiveRange().startPage-1)>=0)){t.next=10;break}return t.next=9,this._loadPage(n);case 9:this._scrollHelper.scrollUp(30);case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),v.error("AnnotationListWidget#loadNextPages failed",t.t0);case 15:return t.prev=15,this._loading=!1,t.finish(15);case 18:case"end":return t.stop()}},t,this,[[1,12,15,18]])}));return function(){return t.apply(this,arguments)}}()},{key:"LoadNextPages",value:function(){var t=o(regeneratorRuntime.mark(function t(){var n,e,r,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(v.debug("AnnotationListWidget#loadNextPages loading:",this._loading),t.prev=1,!this._loading){t.next=4;break}return t.abrupt("return");case 4:this._loading=!0,n=this._rootElem.height()*this._minContentRelativeHeight,e=this._nav.getNumPages(),r=this._rootElem[0].scrollHeight,o=this._nav.getActiveRange().endPage+1;case 9:if(!(o<e&&r<n)){t.next=16;break}return v.debug("AnnotationListWidget#loadNextPages nextPage:",o,"numPages:",e,"scrollHeight:",r,"minHeight:",n),t.next=13,this._loadPage(o);case 13:r=this._rootElem[0].scrollHeight,++o,t.next=9;break;case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(1),v.error("AnnotationListWidget#loadNextPages failed",t.t0);case 21:return t.prev=21,this._loading=!1,t.finish(21);case 24:case"end":return t.stop()}},t,this,[[1,18,21,24]])}));return function(){return t.apply(this,arguments)}}()},{key:"loadPreviousPages",value:function(){var t=o(regeneratorRuntime.mark(function t(){var n,e,r,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(v.debug("AnnotationListWidget#loadPreviousPages",this._loading),t.prev=1,!this._loading){t.next=4;break}return t.abrupt("return");case 4:this._loading=!0,n=this._rootElem.height()*this._minContentRelativeHeight,e=this._nav.getNumPages(),r=this._rootElem[0].scrollHeight,o=this._nav.getActiveRange().startPage-1;case 9:if(!(o>=0&&r<n)){t.next=16;break}return v.debug("AnnotationListWidget#_loadPreviousPages nextPage:",o,"scrollHeight:",r,"minHeight:",n),t.next=13,this._loadPage(o);case 13:r=this._rootElem[0].scrollHeight,--o,t.next=9;break;case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(1),v.error("AnnotationListWidget#loadPreviousPages failed",t.t0);case 21:return t.prev=21,this._loading=!1,t.finish(21);case 24:case"end":return t.stop()}},t,this,[[1,18,21,24]])}));return function(){return t.apply(this,arguments)}}()},{key:"select",value:function(t){this.clearAnnotationHighlights(),this._nav.setPageByCanvasId(t.data("canvasId")),t.focus(),jQuery.publish("ANNOWIN_ANNOTATION_FOCUSED",[{annotationWindowId:this._annoWin.getId(),annotation:t.data("annotation"),canvasId:t.data("canvasId"),imageWindowId:this._annoWin.getImageWindowId(),offset:t.position().top-this._rootElem.scrollTop()}])}},{key:"clearAnnotationHighlights",value:function(){var t=!0,n=!1,e=void 0;try{for(var r,o=this._dom.getAllAnnotationCells()[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;jQuery(i).removeClass("ym_anno_selected")}}catch(t){n=!0,e=t}finally{try{!t&&o.return&&o.return()}finally{if(n)throw e}}}},{key:"highlightAnnotations",value:function(t,n){v.debug("AnnotationListWidget#highlightAnnotations annotations:",t,"flag:",n),this.clearAnnotationHighlights();var e=!0,r=!1,o=void 0;try{for(var i,a=this._dom.getAllAnnotationCells()[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var u=i.value,s=jQuery(u),c=s.data("annotationId"),l=!0,f=!1,d=void 0;try{for(var h,g=t[Symbol.iterator]();!(l=(h=g.next()).done);l=!0)h.value["@id"]===c&&this.highlightAnnotationElem(s,n)}catch(t){f=!0,d=t}finally{try{!l&&g.return&&g.return()}finally{if(f)throw d}}}}catch(t){r=!0,o=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw o}}}},{key:"highlightAnnotation",value:function(t,n){var e=!0,r=!1,o=void 0;try{for(var i,a=this._dom.getAllAnnotationCells()[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var u=i.value,s=jQuery(u);s.data("annotationId")===t&&this.highlightAnnotationElem(s,n)}}catch(t){r=!0,o=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw o}}}},{key:"highlightAnnotationElem",value:function(t,n){v.debug("AnnotationListWidget#highlightAnnotationElem annoElem:",t,"flag:",n,"annoId:",t.data("annotationId"));var e="TARGETING"===n?"ym_anno_targeting":"TARGETED"===n?"ym_anno_targeted":"ym_anno_selected";t.addClass(e)}},{key:"_createPageElements",value:function(){v.debug("AnnotationListWidget#_createPageElements");for(var t=this._nav,n=this._annoPageRenderer,e=0;e<this._canvases.length;++e){var r=t.getCanvas(e),o=n.createPageElement({pageNum:e,canvasId:r["@id"],canvasLabel:r.label,layerId:this._layerId});this._rootElem.append(o),o.hide(),t.setPageElement(e,o)}}},{key:"_activateMorePagesForward",value:function(){var t=o(regeneratorRuntime.mark(function t(n,e){var r,o,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:v.debug("AnnotationListWidget#_activateMorePagesForward",n,e),r=this._rootElem,o=n;case 3:if(!(o<e)){t.next=13;break}return v.debug("AnnotationListWidget#_activateMorePagesForward nextPage:",o,"numPages:",e,"scroll height:",r[0].scrollHeight,"element height:",r.height()),i=o,t.next=8,this._activatePageForward(i);case 8:if(!((o=t.sent)===i||r[0].scrollHeight>r.height())){t.next=11;break}return t.abrupt("break",13);case 11:t.next=3;break;case 13:return t.abrupt("return",o);case 14:case"end":return t.stop()}},t,this)}));return function(n,e){return t.apply(this,arguments)}}()},{key:"_activateMorePagesBackward",value:function(){var t=o(regeneratorRuntime.mark(function t(n){var e,r,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:v.debug("AnnotationListWidget#_activateMorePagesBackward",n),e=this._rootElem,r=n;case 3:if(!(r>=0)){t.next=13;break}return v.debug("AnnotationListWidget#_activateMorePagesBackward nextPage:",r,"scroll height:",e[0].scrollHeight,"element height:",e.height()),o=r,t.next=8,this._activatePageBackward(o);case 8:if(!((r=t.sent)===o||e[0].scrollHeight>e.height())){t.next=11;break}return t.abrupt("break",13);case 11:t.next=3;break;case 13:return t.abrupt("return",r);case 14:case"end":return t.stop()}},t,this)}));return function(n){return t.apply(this,arguments)}}()},{key:"_deactivatePage",value:function(t){v.debug("AnnotationListWidget#_deactivatePage",t),this._nav.getPageElement(t).hide(),this._nav.unload(t)}},{key:"_loadPage",value:function(){var t=o(regeneratorRuntime.mark(function t(n){var e,r,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(v.debug("AnnotationListWidget#_loadPage pageNum:",n),!this._nav.isLoaded(n)){t.next=4;break}return v.debug("AnnotationListWidget#_loadPage alread loaded; page:",n),t.abrupt("return");case 4:return t.next=6,this._getAnnotationsForPage(n);case 6:return e=t.sent,t.next=9,this._getTocForPage(n);case 9:r=t.sent,o=this._nav.getPageElement(n),this._nav.load(n,e,r),this._annoPageRenderer.render(o,{annotations:e,annotationToc:r,isEditor:this._isEditor,pageNum:n}),o.show();case 14:case"end":return t.stop()}},t,this)}));return function(n){return t.apply(this,arguments)}}()},{key:"_unloadAllPages",value:function(){var t=!0,n=!1,e=void 0;try{for(var r,o=this._nav.getPageElements()[Symbol.iterator]();!(t=(r=o.next()).done);t=!0)r.value.hide()}catch(t){n=!0,e=t}finally{try{!t&&o.return&&o.return()}finally{if(n)throw e}}this._nav.unloadAll()}},{key:"_unloadNextPages",value:function(){v.debug("AnnotationListWidget#_unloadNextPages");for(var t=this._nav,n=this._rootElem,e=n.height(),r=this._maxContentRelativeHeight*e,o=t.getActiveRange().endPage;o>t.getPage()+1&&n[0].scrollHeight-e>r;--o)v.debug("AnnotationListWidget#_deactivatePagesBackward nextPage:",o,"scroll height:",n[0].scrollHeight,"maxHeight:",r),t.getPageElement(o).hide()}},{key:"_unloadPreviousPages",value:function(){v.debug("AnnotationListWidget#_unloadPreviousPages");for(var t=this._rootElem,n=t.height(),e=this._maxContentRelativeHeight*n,r=0;r<this._currentPageNum-1&&t[0].scrollHeight-n>e;++r)v.debug("AnnotationListWidget#_unloadPreviousPages nextPage:",r,"scroll height:",t[0].scrollHeight,"maxHeight:",e),nav.getPageElement(r).hide()}},{key:"_getTocForPage",value:function(){var t=o(regeneratorRuntime.mark(function t(n){var e,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this._nav.getCanvas(n),!(r=(0,l.default)().getAnnotationTocCache())){t.next=8;break}return t.next=5,r.getToc(e["@id"]);case 5:t.t0=t.sent,t.next=9;break;case 8:t.t0=null;case 9:return t.abrupt("return",t.t0);case 10:case"end":return t.stop()}},t,this)}));return function(n){return t.apply(this,arguments)}}()},{key:"_getAnnotationsForPage",value:function(){var t=o(regeneratorRuntime.mark(function t(n){var e,r,o=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this._nav.getCanvas(n)["@id"],t.next=3,this._annoExplorer.getAnnotations({canvasId:e});case 3:return r=t.sent,t.abrupt("return",r.filter(function(t){return t.layerId===o._layerId}));case 5:case"end":return t.stop()}},t,this)}));return function(n){return t.apply(this,arguments)}}()},{key:"clearHighlights",value:function(){var t=!0,n=!1,e=void 0;try{for(var r,o=this._dom.getAllAnnotationCells()[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;jQuery(i).removeClass("annowin_targeted").removeClass("ym_anno_selected ym_anno_targeting ym_anno_targeted")}}catch(t){n=!0,e=t}finally{try{!t&&o.return&&o.return()}finally{if(n)throw e}}}},{key:"getTocSiblingElems",value:function(t,n,e,r){v.debug("AnnotationListWidget#getTocSiblingElems annotation:",t,"annotations:",n,"layerId:",e,"toc:",r);var o=[],i=c.annoUtil.findTocSiblings(t,n,e,r),a=!0,u=!1,s=void 0;try{for(var l,f=this._dom.getAllAnnotationCells()[Symbol.iterator]();!(a=(l=f.next()).done);a=!0){var d=l.value,h=jQuery(d),g=h.data("annotationId"),p=!0,y=!1,m=void 0;try{for(var _,b=i[Symbol.iterator]();!(p=(_=b.next()).done);p=!0)_.value["@id"]===g&&o.push(h)}catch(t){y=!0,m=t}finally{try{!p&&b.return&&b.return()}finally{if(y)throw m}}}}catch(t){u=!0,s=t}finally{try{!a&&f.return&&f.return()}finally{if(u)throw s}}return o}},{key:"_focusNextAnnotation",value:function(){var t=o(regeneratorRuntime.mark(function t(){var n,e,r,o,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(n=this._nav,e=jQuery(this._rootElem.find(".annowin_anno:focus")),r=e.next();r.size()>0&&!r.hasClass("annowin_anno");)r=r.next();if(!(r.size()>0)){t.next=8;break}this.select(r),t.next=17;break;case 8:if(!this._continuousPages){t.next=17;break}if(!((o=n.getPage()+1)<n.getNumPages())){t.next=17;break}if(n.isLoaded(o)){t.next=14;break}return t.next=14,this.loadNextPage();case 14:i=n.getPageElement(o),(r=i.find(".annowin_anno").first())&&(this.select(r),n.setPage(o));case 17:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"_focusPrevAnnotation",value:function(){var t=o(regeneratorRuntime.mark(function t(){var n,e,r,o,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(n=this._nav,e=jQuery(this._rootElem.find(".annowin_anno:focus")),r=e.prev();r.size()>0&&!r.hasClass("annowin_anno");)r=r.prev();if(!(r.size()>0)){t.next=8;break}this.select(r),t.next=17;break;case 8:if(!this._continuousPages){t.next=17;break}if(!((o=n.getPage()-1)>=0)){t.next=17;break}if(n.isLoaded(o)){t.next=14;break}return t.next=14,this.loadPreviousPage();case 14:i=n.getPageElement(o),(r=i.find(".annowin_anno").last())&&(this.select(r),n.setPage(o));case 17:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"scrollToElem",value:function(t,n){this._scrollHelper.scrollToElem(t,n)}},{key:"scrollToAnnotation",value:function(t,n){this._scrollHelper.scrollToAnnotation(t,n)}},{key:"_bindEvents",value:function(){var t=this;this._scrollHelper.bindScrollEvent(),this._rootElem.keydown(function(n){switch(n.preventDefault(),n.key){case"ArrowDown":t._focusNextAnnotation();break;case"ArrowUp":t._focusPrevAnnotation()}})}},{key:"_unbindEvents",value:function(){this._scrollHelper.unbindScrollEvent(),this._rootElem.off("keydown")}}]),t}();n.default=g},function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),i=(0,function(t){return t&&t.__esModule?t:{default:t}}(e(0)).default)(),a=function(){function t(n){r(this,t),this.options=Object.assign({canvases:[]},n),this._pageNum=-1,this._numPages=this.options.canvases.length,this._activeRange={startPage:-1,endPage:-1},this._pageStateList=this._createPageStateList()}return o(t,[{key:"getPage",value:function(){return this._pageNum}},{key:"setPage",value:function(t){if(!(t>=0&&t<this._numPages))throw"AnnotationNav#setPage invalid pageNum "+t;this._pageNum=t}},{key:"setPageByCanvasId",value:function(t){for(var n=0;n<this._pageStateList.length;++n)if(this._pageStateList[n].canvas["@id"]===t)return void this.setPage(n);i.error("AnnotationNav#setPageByCanvasId page not found for canvas",t)}},{key:"getNumPages",value:function(){return this._numPages}},{key:"getPageElements",value:function(){return this._pageStateList.map(function(t){return t.element})}},{key:"getPageElement",value:function(t){return this._pageStateList[t].element}},{key:"setPageElement",value:function(t,n){this._pageStateList[t].element=n}},{key:"getCanvas",value:function(t){return this._pageStateList[t].canvas}},{key:"isLoaded",value:function(t){return this._pageStateList[t].loaded}},{key:"setLoaded",value:function(t){this._pageStateList[t].loaded=!0}},{key:"load",value:function(t,n,e){var r=this._pageStateList[t];r.annotations=n,r.toc=e,r.loaded=!0,this._addToActiveRange(t)}},{key:"unload",value:function(t){var n=this._pageStateList[t];this._unloadPageItem(n),this._removeFromActiveRange(t)}},{key:"_unloadPageItem",value:function(t){delete t.annotations,delete t.toc,t.loaded=!1}},{key:"unloadAll",value:function(){var t=!0,n=!1,e=void 0;try{for(var r,o=this._pageStateList[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;this._unloadPageItem(i)}}catch(t){n=!0,e=t}finally{try{!t&&o.return&&o.return()}finally{if(n)throw e}}this._activeRange.startPage=-1,this._activeRange.endPage=-1}},{key:"getActiveRange",value:function(){return i.debug("AnnotationNav get activeRange",this._activeRange.startPage,this._activeRange.endPage),this._activeRange}},{key:"_addToActiveRange",value:function(t){i.debug("AnnotationNav#_addToActiveRange",t,this._activeRange.startPage,this._activeRange.endPage);var n=this._activeRange;(-1===n.startPage||t<n.startPage)&&(n.startPage=t),(-1===n.endPage||t>n.endPage)&&(n.endPage=t)}},{key:"_removeFromActiveRange",value:function(t){i.debug("AnnotationNav#_removeFromActiveRange",t,this._activeRange.startPage,this._activeRange.endPage);var n=this._activeRange;t===n.startPage&&(++n.startPage,n.startPage>=this._numPages&&(n.startPage=-1,n.endPage=-1)),t===n.endPage&&(--n.endtPage,-1===n.endPage&&(n.startPage=-1))}},{key:"getPageNumForCanvas",value:function(t){for(var n=0;n<this._pageStateList.length;++n)if(this._pageStateList[n].canvas["@id"]===t)return n;return-1}},{key:"_createPageStateList",value:function(){var t=[],n=!0,e=!1,r=void 0;try{for(var o,i=this.options.canvases[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){var a=o.value;t.push({toc:null,canvas:a,loaded:!1,annotations:[],element:null})}}catch(t){e=!0,r=t}finally{try{!n&&i.return&&i.return()}finally{if(e)throw r}}return t}}]),t}();n.default=a},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t){return function(){var n=t.apply(this,arguments);return new Promise(function(t,e){function r(o,i){try{var a=n[o](i),u=a.value}catch(t){return void e(t)}if(!a.done)return Promise.resolve(u).then(function(t){r("next",t)},function(t){r("throw",t)});t(u)}return r("next")})}}function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,n){var e=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return e}return function(n,e){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return t(n,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),s=e(1),c=r(e(40)),l=r(e(43)),f=r(e(11)),d=r(e(4)),h=r(e(0)),v=r(e(3)),g=r(e(2)),p=r(e(49)),y=r(e(15)),m=r(e(6)),_=(r(e(5)),(0,h.default)()),b=function(){function t(n){i(this,t),_.debug("AnnotationWindow#constructor options:",n),this._id=n.id,this._miradorId=n.miradorId,this._imageWindowId=n.canvasWindowId,this._appendTo=n.appendTo,this._listWidget=n.annotationListWidget,this._explorer=n.explorer,this._initialLayerId=n.initialLayerId||null,this._initialTocTags=n.initialTocTags||[],this._annotationId=n.annotationId,this._state=n.appState,this._miradorProxy=(0,v.default)().getMiradorProxy(this._miradorId),this._tocSpec=(0,g.default)().getSetting("annotations","tocSpec"),this._annotationTocCache=(0,d.default)().getAnnotationTocCache(),this._id||(this._id=Mirador.genUUID()),this._imageWindow=this._miradorProxy.getWindowProxyById(this._imageWindowId),this._dom=new l.default(this._appendTo,this._state.getSetting("ui","annotationWindow","enableDirectionToggle")),this._orderConfirm=this._dom.getOrderConfirm(),this._continuousPages=this._state.getSetting("ui","annotationWindow","continuousPages"),this._jQuerySubscribed={},this._miradorSubscribed={},this._setDirty(!1),this._flexDirection="column",this._ignoredEvents={}}return u(t,[{key:"getId",value:function(){return this._id}},{key:"init",value:function(){var t=o(regeneratorRuntime.mark(function t(){var n,e,r,o,i,a,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this._imageWindow.getCurrentCanvasId(),e=this._imageWindow.getAnnotationsList(),!this._tocSpec){t.next=8;break}return t.next=5,(0,d.default)().getAnnotationTocCache().getToc(n);case 5:t.t0=t.sent,t.next=9;break;case 8:t.t0=null;case 9:return r=t.t0,o=this._processDataParams({annotationId:this._annotationId,annotationList:e,layerId:this._initialLayerId,toc:r,tocTags:this._initialTocTags}),i=o.targetAnno,a=o.layerId,u=o.tocTags,_.debug("AnnotationWindow#init targetAnno:",i),this.initLayerSelector(),this.placeHolder=this._dom.getPlaceHolder(),this.placeHolder.text("Loading...").show(),this._setupAnnotationListWidget(),t.next=18,this.reload().catch(function(t){throw"AnnotationWindow#init reload failed - "+t});case 18:return this._annotationId?(this._listWidget.highlightAnnotations([i],"SELECTED"),this._listWidget.goToAnnotation(this._annotationId,n)):this._initialTocTags.length>0?this._listWidget.goToPageByTags(u):this._listWidget.goToPageByCanvas(n),this.bindEvents(),t.abrupt("return",this);case 21:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"ignoreEvent",value:function(t,n){this._ignoredEvents[t]=(new Date).valueOf()+n}},{key:"_shouldIgnoreEvent",value:function(t){var n=this._ignoredEvents[t];if("number"==typeof n){if((new Date).valueOf()<n)return!0;delete this._ignoredEvents[t]}return!1}},{key:"_processDataParams",value:function(t){_.debug("AnnotationWindow#_processDataParams params:",t);var n=null,e=t.layerId,r=t.tocTags;return t.annotationId&&(n=s.annoUtil.findAnnotationFromListById(t.annotationId,t.annotationList))&&(e=n.layerId,t.toc&&(r=t.toc.getTagsFromAnnotationId(t.annotationId))),{targetAnno:n,layerId:e,tocTags:r}}},{key:"_getTargetAnnoWithToc",value:function(t,n,e,r){var o=t.filter(function(t){return t.layerId==n}).filter(function(t){return e.matchHierarchy(t,r.slice(0,1))}).filter(function(t){return e.matchHierarchy(t,r)});o.length>0&&!targetAnno&&(targetAnno=o[0])}},{key:"_processAnnotationId",value:function(t){var n=s.annoUtil.findAnnotationFromListById(t.annotationId,t.annotationList)[0],e=t.layerId,r=[];return n&&(e=n.layerId,t.toc&&(r=toc.getTagsFromAnnotationId(t.annotationId))),{targetAnno:n,layerId:e,tocTags:r}}},{key:"_processLayerId",value:function(t,n,e,r){var o=this,i=n.filter(function(t){return t.layerId==o._initialLayerId});if(e&&r.length>0){var a=(i=i.filter(function(t){return e.matchHierarchy(t,r.slice(0,1))})).filter(function(t){return e.matchHierarchy(t,r)});a.length>0&&!targetAnno&&(targetAnno=a[0])}}},{key:"getDomHelper",value:function(){return this._dom}},{key:"getMiradorProxy",value:function(){return this._miradorProxy}},{key:"getImageWindowId",value:function(){return this._imageWindowId}},{key:"getImageWindowProxy",value:function(){var t=this.getImageWindowId();return(0,v.default)().getWindowProxyById(t)}},{key:"_setupAnnotationListWidget",value:function(){if(!this._listWidget){var t=(0,v.default)().getWindowProxyById(this._imageWindowId).getManifest().getCanvases();this._listWidget=new c.default({annotationWindow:this,canvases:t,tocTags:this._initialTocTags,annotationExplorer:this._explorer,state:(0,g.default)(),isEditor:m.default.isEditor(),continuousPages:this._continuousPages}),this._listWidget.reload(this._initialLayerId)}}},{key:"destroy",value:function(){_.debug("AnnotationWindow#destroy"),this._unsubscribeAll()}},{key:"getAnnoListNav",value:function(){return this._listWidget.getNav()}},{key:"initMenuTagSelector",value:function(){var t=this;_.debug("AnnotationWindow#initMenuTagSelector"),this.menuTagSelector&&this.menuTagSelector.destroy(),this.menuTagSelector=new p.default({parent:this._dom.getTocTagSelector(),tocSpec:(0,g.default)().getSetting("annotations","tocSpec"),annotationExplorer:this._explorer,initialTags:this._initialTocTags,changeCallback:function(){var n=o(regeneratorRuntime.mark(function n(e,r){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return _.debug("Change from TOC selector: ",e),n.next=3,t._listWidget.goToPageByTags([e]);case 3:case"end":return n.stop()}},n,t)}));return function(t,e){return n.apply(this,arguments)}}()})}},{key:"initLayerSelector",value:function(){var t=this;this._setCurrentLayerId(this._initialLayerId),this.layerSelector=new y.default({parent:this._dom.getLayerSelectorContainer(),annotationExplorer:this._explorer,initialLayerId:this._initialLayerId,changeCallback:function(n,e){_.debug("Change from Layer selector: ",n),t._setCurrentLayerId(n),t.updateList()}})}},{key:"_toggleDirection",value:function(){var t=this._dom.getRoot();t.hasClass("row-reverse")?t.toggleClass("row-reverse",!1):t.toggleClass("row-reverse",!0),this._dom.updateDirection()}},{key:"getCurrentLayerId",value:function(){return this._currentLayerId}},{key:"_setCurrentLayerId",value:function(t){_.debug("AnnotationWindow#_setCurrentLayerId layerId:",t),this._currentLayerId=t}},{key:"show",value:function(){this._dom.getRoot().show()}},{key:"hide",value:function(){this._dom.getRoot().hide()}},{key:"_isDirty",value:function(){return this._dirty}},{key:"_setDirty",value:function(t){this._dirty=t}},{key:"reload",value:function(){var t=this;_.debug("AnnotationWindow#reload"),this.hide();var n=this;(0,g.default)();this.placeHolder.hide();this.getCurrentCanvas();var e=new Promise(function(t,e){n._explorer.getLayers().then(function(r){r.length>0?n.layerSelector.isLoaded()?t():n.layerSelector.init(r).then(function(e){n._setCurrentLayerId(e.val()),t()}).catch(function(t){e("layerSelector.init failed - "+t)}):e("No layers from annotation explorer")})}),r=new Promise(function(t,e){n._explorer.getAnnotationToc()?n.menuTagSelector.reload().then(function(){t()}).catch(function(t){e("menuTagSelector.reload failed - "+t)}):t()});return Promise.all([e,r]).then(o(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.updateList().catch(function(t){throw"AnnotationWindow#updateList failed: "+t});case 2:return t._dom.updateDirection(),t.show(),n.abrupt("return",t);case 5:case"end":return n.stop()}},n,t)})))}},{key:"reloadIfDirty",value:function(){_.debug("AnnotationWindow#reloadIfDirty dirty:",this._dirty),this._isDirty()&&(this._setDirty(!1),this.reload())}},{key:"updateList",value:function(){var t=o(regeneratorRuntime.mark(function t(){var n,e,r,o,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=this._listWidget,e=(0,g.default)(),r=this._imageWindow.getCurrentCanvasId(),_.debug("AnnotationWindow#updateList canvasId:",r),t.next=6,n.reload(this.layerSelector.val());case 6:if(o=0,!(this._initialTocTags.length>0)){t.next=14;break}return t.next=10,n.goToPageByTags(this._initialTocTags).catch(function(t){throw"listWidget#goToPageByTags failed: "+t+"(tags: "+i._initialTocTags+")"});case 10:o=t.sent,this._annotationId&&n.scrollToAnnotation(this._annotationId),t.next=17;break;case 14:return t.next=16,n.goToPageByCanvas(r).catch(function(t){throw"listWidget#goToPageByCanvas failed: "+t});case 16:o=t.sent;case 17:0===o?this.placeHolder.text("No annotations found.").show():this.placeHolder.hide();case 18:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"getCurrentCanvasId",value:function(){return this._imageWindow.getCurrentCanvasId()}},{key:"getCurrentCanvas",value:function(){var t=this.getCurrentCanvasId(),n=this._imageWindow.getManifest().getCanvases().filter(function(n){return n["@id"]===t});if(!(n.length<1))return n[0];(0,f.default)("Could not find the requested canvas: "+t)}},{key:"select",value:function(t){this._listWidget.select(t)}},{key:"scrollToAnnotation",value:function(t){this._listWidget.scrollToAnnotation(t)}},{key:"goToAnnotation",value:function(){var t=o(regeneratorRuntime.mark(function t(n,e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return _.debug("AnnotationWindow#goToAnnotation annoId:",n,"canvasId:",e),t.abrupt("return",this._listWidget.goToAnnotation(n,e));case 2:case"end":return t.stop()}},t,this)}));return function(n,e){return t.apply(this,arguments)}}()},{key:"createInfoDiv",value:function(t,n){var e=t.on.full,r='<a target="_blank" href="'+e+'">'+e+"</a>";return jQuery(infoTemplate({on:r}))}},{key:"hasOpenEditor",value:function(){var t=!0,n=!1,e=void 0;try{for(var r,o=this._dom.getAllAnnotationCells()[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;if(!0===jQuery(i).data("editing"))return!0}}catch(t){n=!0,e=t}finally{try{!t&&o.return&&o.return()}finally{if(n)throw e}}return!1}},{key:"fadeUp",value:function(t,n){t.transition({animation:"fade up",duration:"0.3s",onComplete:n})}},{key:"fadeDown",value:function(t,n){t.transition({animation:"fade down",duration:"0.3s",onComplete:n})}},{key:"clearAnnotationHighlights",value:function(){this._listWidget.clearAnnotationHighlights()}},{key:"highlightAnnotationElem",value:function(t,n){this._listWidget.highlightAnnotationElem(t,n)}},{key:"showSaveOrderConfirmation",value:function(t){this._reorderedPageElem=t,this._dom.getOrderConfirm().show()}},{key:"_saveAnnotationsOrder",value:function(t){var n=this,e=t.find(".annowin_anno"),r=[],o=t.data("canvasId"),i=t.data("layerId");return e.each(function(t,n){var e=jQuery(n).data("annotationId");r.push(e)}),_.debug("AnnotationWindow#_saveAnnotationsOrder canvasId:",o,"layerId:",i,"annoIds:",r),this._explorer.updateAnnotationListOrder(o,i,r).catch(function(t){throw n._dom.getOrderConfirm().hide(),"AnnotationWindow#_saveAnnotationsOrder updateAnnotationListOrder failed: "+t})}},{key:"bindEvents",value:function(){var t=this;_.debug("AnnotationWindow#bindEvents"),this._dom.getCreateWindowButton().click(function(n){t._miradorProxy.publish("YM_DISPLAY_ON"),jQuery.publish("YM_ADD_WINDOW",{miradorId:t._miradorId,imageWindowId:t._imageWindowId})});var n=this._dom.getToggleDirectionButton();n&&n.click(function(n){t._toggleDirection()}),this._dom.getSaveOrderButton().click(function(n){t._saveAnnotationsOrder(t._reorderedPageElem),t._dom.getOrderConfirm().hide()}),this._dom.getCancelOrderButton().click(function(n){t._dom.getOrderConfirm().hide()}),this._subscribe(this._miradorProxy,"ANNOTATIONS_LIST_UPDATED",function(n,e){_.debug("AnnotationWindow:SUB:ANNOTATIONS_LIST_UPDATED, params:",e),e.windowId!==t.getImageWindowId()||t._shouldIgnoreEvent("ANNOTATIONS_LIST_UPDATED")||(t.hasOpenEditor()?t._setDirty(!0):t.reload())}),this._subscribe(jQuery,"ANNOWIN_ANNOTATION_FOCUSED",function(){var n=o(regeneratorRuntime.mark(function n(e,r){var o,i,a,u,c,l,f,h,v,p,y,m,b,w,x,A,S,k,T,P,E,I,C;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(_.debug("AnnotationWindow:SUB:ANNOWIN_ANNOTATION_FOCUSED annotation window id:",t._id,"params:",r,"layer:",t.getCurrentLayerId()),o=(0,s.Anno)(r.annotation),i=t._listWidget,a=null,r.annotationWindowId!==t._id){n.next=6;break}return n.abrupt("return");case 6:if(i.clearHighlights(),u=t._imageWindow.getAnnotationsList(),c=t.getCurrentLayerId(),!(l=(0,g.default)().getSetting("annotations","tocSpec"))){n.next=40;break}return n.next=13,(0,d.default)().getAnnotationTocCache().getToc(r.canvasId);case 13:for(f=n.sent,h=i.getTocSiblingElems(r.annotation,u,c,f),i.clearHighlights(),v=!0,p=!1,y=void 0,n.prev=19,m=h[Symbol.iterator]();!(v=(b=m.next()).done);v=!0)w=b.value,i.highlightAnnotationElem(w);n.next=27;break;case 23:n.prev=23,n.t0=n.catch(19),p=!0,y=n.t0;case 27:n.prev=27,n.prev=28,!v&&m.return&&m.return();case 30:if(n.prev=30,!p){n.next=33;break}throw y;case 33:return n.finish(30);case 34:return n.finish(27);case 35:if(!(h.length>0)){n.next=39;break}return n.next=38,i.goToPageByCanvas(r.canvasId);case 38:i.scrollToElem(h[0],-r.offset);case 39:return n.abrupt("return");case 40:return n.next=42,i.goToPageByCanvas(r.canvasId);case 42:for(x={},A=!0,S=!1,k=void 0,n.prev=46,T=u[Symbol.iterator]();!(A=(P=T.next()).done);A=!0)E=P.value,x[E["@id"]]=E;n.next=54;break;case 50:n.prev=50,n.t1=n.catch(46),S=!0,k=n.t1;case 54:n.prev=54,n.prev=55,!A&&T.return&&T.return();case 57:if(n.prev=57,!S){n.next=60;break}throw k;case 60:return n.finish(57);case 61:return n.finish(54);case 62:if(I=s.annoUtil.findTransitiveTargetingAnnotations(r.annotation,x),!((I=I.filter(function(n){return n.layerId===t.getCurrentLayerId()})).length>0)){n.next=69;break}return i.highlightAnnotations(I,"TARGETING"),a=t._dom.findAnnoElemByAnnoId(I[0]["@id"]),i.scrollToElem(a,-r.offset),n.abrupt("return");case 69:if(!((C=s.annoUtil.findTransitiveTargetAnnotations(r.annotation,x).filter(function(n){return n.layerId===t.getCurrentLayerId()})).length>0)){n.next=75;break}return i.highlightAnnotations(C,"TARGET"),a=t._dom.findAnnoElemByAnnoId(C[0]["@id"]),i.scrollToElem(a,-r.offset),n.abrupt("return");case 75:case"end":return n.stop()}},n,t,[[19,23,27,35],[28,,30,34],[46,50,54,62],[55,,57,61]])}));return function(t,e){return n.apply(this,arguments)}}()),this._subscribe(jQuery,"YM_ANNOTATION_TOC_TAGS_SELECTED",function(n,e,r,o){_.debug("AnnotationWindow:SUB:YM_ANNOTATION_TOC_TAGS_SELECTED imageWindow:",e,"canvasId:",r,"tags:",o),t._listWidget.goToPageByTags(o)}),this._subscribe(this._miradorProxy,"YM_IMAGE_WINDOW_TOOLTIP_ANNO_CLICKED",function(){var n=o(regeneratorRuntime.mark(function n(e,r,o){var i,a,u,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(_.debug("AnnotationWindow:SUB:YM_IMAGE_WINDOW_TOOLTIP_ANNO_CLICKED windowId:",r,"annoId:",o,"annoWin:",t.id),i=t._miradorProxy.getWindowProxyById(r),a=i.getCurrentCanvasId(),!t._continuousPages){n.next=11;break}return n.next=6,t._annotationTocCache.getToc(a);case 6:u=n.sent,(s=u.annotations.filter(function(t){return t["@id"]===o})[0])&&t._listWidget.goToPageByTags(s.tocTags),n.next=12;break;case 11:t._listWidget.goToAnnotation(o,a);case 12:case"end":return n.stop()}},n,t)}));return function(t,e,r){return n.apply(this,arguments)}}())}},{key:"_subscribe",value:function(t,n,e){var r=void 0;if(t===jQuery)r=this._jQuerySubscribed;else{if(t!==this._miradorProxy){var o="AnnotationWindow#_subscribe invalid context ";throw _.error(o,t),o+t}r=this._miradorSubscribed}r[n]instanceof Array||(r[n]=[]),r[n].push(e),t.subscribe(n,e)}},{key:"_unsubscribeAll",value:function(){for(var t=[jQuery,this._miradorProxy],n=0;n<t.length;n++){var e=t[n],r=e===jQuery?this._jQuerySubscribed:this._miradorSubscribed,o=!0,i=!1,u=void 0;try{for(var s,c=Object.entries(r)[Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var l=a(s.value,2),f=l[0],d=l[1],h=!0,v=!1,g=void 0;try{for(var p,y=d[Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var m=p.value;console.log("UNSUB",f,m),e.unsubscribe(f,m)}}catch(t){v=!0,g=t}finally{try{!h&&y.return&&y.return()}finally{if(v)throw g}}}}catch(t){i=!0,u=t}finally{try{!o&&c.return&&c.return()}finally{if(i)throw u}}}}}]),t}();n.default=b},function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),i=(0,function(t){return t&&t.__esModule?t:{default:t}}(e(0)).default)(),a=function(){function t(n,e){r(this,t),this._root=jQuery(u({})),n.append(this._root),this._header=this._findOne(this._root,".header"),this._placeHolder=this._findOne(this._root,".placeholder"),this._layerSelectorContainer=this._findOne(this._root,".layer-selector-container"),this._tocTagSelector=this._findOne(this._root,".toc-tag-selector-container"),this._orderConfirm=this._findOne(this._root,".order-confirm"),this._saveOrderButton=this._findOne(this._orderConfirm,".ym_button.save"),this._cancelOrderButton=this._findOne(this._orderConfirm,".ym_button.cancel"),this._toggleDirectionButton=e?this._addToggleDirectionButton():null,this._createWindowButton=this._addCreateWindowButton(),this._listContainer=this._findOne(this._root,".list-container"),this._orderConfirm.hide()}return o(t,[{key:"getRoot",value:function(){return this._root}},{key:"getHeader",value:function(){return this._header}},{key:"getPlaceHolder",value:function(){return this._placeHolder}},{key:"getLayerSelectorContainer",value:function(){return this._layerSelectorContainer}},{key:"getTocTagSelector",value:function(){return this._tocTagSelector}},{key:"getOrderConfirm",value:function(){return this._orderConfirm}},{key:"getSaveOrderButton",value:function(){return this._saveOrderButton}},{key:"getCancelOrderButton",value:function(){return this._cancelOrderButton}},{key:"getCreateWindowButton",value:function(){return this._createWindowButton}},{key:"getToggleDirectionButton",value:function(){return this._toggleDirectionButton}},{key:"getListContainer",value:function(){return this._listContainer}},{key:"getAllAnnotationCells",value:function(){return this.getListContainer().find(".annowin_anno").toArray()}},{key:"_findOne",value:function(t,n){var e=t.find(n);return e.length>0?jQuery(e[0]):null}},{key:"findAnnoListElem",value:function(t){return t.find(".annowin_list")}},{key:"isAnnotationCell",value:function(t){return t.hasClass("annowin_anno")}},{key:"findAnnoElemByAnnoId",value:function(t){var n=!0,e=!1,r=void 0;try{for(var o,i=this.getAllAnnotationCells()[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){var a=o.value,u=jQuery(a);if(u.data("annotationId")===t)return u}}catch(t){e=!0,r=t}finally{try{!n&&i.return&&i.return()}finally{if(e)throw r}}return null}},{key:"updateDirection",value:function(){var t=this._root.hasClass("row-reverse");i.debug("DomHelper#updateDirection rowReverse:",t),t?(this._root.find(".fa-arrows-h").hide(),this._root.find(".fa-arrows-v").show(),this._root.find(".order-down").attr("class","order-down caret left icon"),this._root.find(".order-up").attr("class","order-up caret right icon")):(this._root.find(".fa-arrows-h").show(),this._root.find(".fa-arrows-v").hide(),this._root.find(".order-down").attr("class","order-down caret down icon"),this._root.find(".order-up").attr("class","order-up caret up icon"))}},{key:"_addCreateWindowButton",value:function(){var t=this._root.find(".annowin_layer_row .right"),n=jQuery("<div/>").addClass("ym_create_window_button").append(jQuery('<i class="fa fa-plus fa-lg fa-fw"></i>'));return t.append(n),n}},{key:"_addToggleDirectionButton",value:function(){var t=this._root.find(".annowin_layer_row .right"),n=jQuery("<div/>").addClass("ym_toggle_direction_button").append(jQuery('<i class="fa fa-arrows-h fa-lg fa-fw"></i>')).append(jQuery('<i class="fa fa-arrows-v fa-lg fa-fw"></i>'));return t.append(n),n.find(".fa-arrows-v").hide(),n}}]),t}();n.default=a;var u=Handlebars.compile(['<div class="ym_annotation_window">','  <div class="header">','    <div class="annowin_layer_row">','      <span class="layer-selector-container"></span>','      <div class="right"></div>',"    </div>",'    <div class="annowin_menu_tag_row">','      <span class="toc-tag-selector-container"></span>',"    </div>",'  <div class="order-confirm">','    <span class="ui small orange button ym_button save">Save new order</span>','    <span class="ui small orange button ym_button cancel">Cancel</span>',"  </div>","  </div>",'  <div class="placeholder"></div>','  <div class="list-container" tabindex="-1">',"  </div>","</div>"].join(""))},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),a=r(e(45)),u=r(e(46)),s=r(e(0)),c=r(e(2)),l=(0,s.default)(),f=function(){function t(n){o(this,t),this._annoWin=n.annotationWindow,this._annoRenderer=n.annotationRenderer,this._annoExplorer=n.annotationExplorer,this._state=n.state,this._state||(this._state=(0,c.default)()),this._annoRenderer||(this._annoRenderer=new a.default({annotationWindow:this._annoWin,state:this._state}))}return i(t,[{key:"createPageElement",value:function(t){var n=d({pageNum:t.pageNum}),e=jQuery(n);return e.data("canvasId",t.canvasId),e.data("layerId",t.layerId),e.find(".page-header").text(t.canvasLabel),e}},{key:"render",value:function(t,n){n.annotationToc?this._renderToc(t,n):this._renderDefault(t,n)}},{key:"unload",value:function(t){t.find(".annowin_group_header, .annowin_anno").remove()}},{key:"_renderDefault",value:function(t,n){l.debug("AnnotationPageRenderer#_renderDefault options:",n);var e=t.data("canvasId"),r=t.data("layerId"),o=0,i=!0,a=!1,u=void 0;try{for(var s,c=n.annotations[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var f=s.value;try{if(f.layerId===r){++o;var d=this._annoRenderer.createAnnoElem(f,{pageElem:t,canvasId:e,isEditor:n.isEditor});t.append(d)}}catch(t){throw l.error("ERROR AnnotationPageRenderer#_renderDefault",t),t}}}catch(t){a=!0,u=t}finally{try{!i&&c.return&&c.return()}finally{if(a)throw u}}return o}},{key:"_renderToc",value:function(t,n){return l.debug("AnnotationPageRenderer#_renderToc options:",n),new u.default({container:t,canvasId:t.data("canvasId"),layerId:t.data("layerId"),toc:n.annotationToc,annotationRenderer:this._annoRenderer}).render()}}]),t}();n.default=f;var d=Handlebars.compile(['<div class="ym-annotation-page page-{{pageNum}}">','  <div class="page-header">{{text}}',"  </div>","</div>"].join(""))},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),a=e(1),u=r(e(14)),s=r(e(0)),c=r(e(7)),l=(0,s.default)(),f=function(){function t(n){o(this,t),this._annoWin=n.annotationWindow,this._state=n.state,this.layerIndexMap=this._state.getTransient("layerIndexMap"),this.hideTags=this._state.getSetting("ui","annotationWindow","hideTags"),this._miradorProxy=this._annoWin.getMiradorProxy()}return i(t,[{key:"createAnnoElem",value:function(t,n){var e=(0,a.Anno)(t),r=e.bodyText,o=e.tags,i=this.getTagsHtml(o),u=(e.bodyStyle,d({content:r,tags:i,isEditor:n.isEditor,orderable:n.isEditor})),s=jQuery(u),c=(s.find(".content"),s.find(".menu_bar"));s.data("annotationId",t["@id"]),s.data("canvasId",n.canvasId),s.data("pageElem",n.pageElem);var l=s.find(".ui.dropdown");l.dropdown({direction:"downward"}),l.click(function(t){t.stopPropagation()});var f=this.layerIndexMap[t.layerId];return c.addClass("layer_"+f%10),"oa:Annotation"==t.on["@type"]?c.addClass("targeting_anno"):c.removeClass("targeting_anno"),this.hideTags&&s.find(".tags").hide(),this.bindAnnotationItemEvents(s,t,n),s}},{key:"getTagsHtml",value:function(t){var n="";return jQuery.each(t,function(t,e){n+='<span class="tag">'+e+"</span>"}),n}},{key:"bindAnnotationItemEvents",value:function(t,n,e){var r=this,o=this._annoWin;o.getAnnoListNav();t.data("annotation",n),t.click(function(t){o.select(jQuery(this))}),t.find(".annotate").click(function(t){var e=o.getImageWindowProxy(),i=jQuery("#ym_annotation_dialog"),a=new u.default({parent:i,windowId:o.getImageWindowId(),mode:"create",targetAnnotation:n,endpoint:o.endpoint,saveCallback:function(t){try{i.dialog("close"),e.getAnnotationsList().push(t),r._miradorProxy.publish("ANNOTATIONS_LIST_UPDATED",{windowId:e.getWindowId(),annotationsList:e.getAnnotationsList()})}catch(t){l.error('AnnotationRenderer saving from "annotate" failed:',t),o.reloadIfDirty()}},cancelCallback:function(){i.dialog("close"),annoWind.reloadIfDirty()}});i.dialog({title:"Create annotation",modal:!0,draggable:!0,dialogClass:"no_close",width:400}),a.show()}),t.find(".edit").click(function(e){r._annoWin.getDomHelper();var i=new u.default({parent:t,windowId:o.getImageWindowId(),mode:"update",endpoint:o.endpoint,annotation:n,saveCallback:function(n,e){if(o.getCurrentLayerId()===n.layerId){var r=t.find(".normal_view"),i=r.find(".content");i.html(e),c.default.setTextDirectionClass(i,(0,a.Anno)(n).bodyStyle),r.show(),t.data("editing",!1)}else t.remove();o.reloadIfDirty()},cancelCallback:function(n){t.find(".normal_view").show(),t.data("editing",!1),o.reloadIfDirty()}});t.data("editing",!0),t.find(".normal_view").hide(),i.show()}),t.find(".delete").click(function(t){window.confirm("Do you really want to delete the annotation?")&&r._miradorProxy.publish("annotationDeleted."+o.getImageWindowProxy().getWindowId(),[n["@id"]])}),t.find(".order-up").click(function(n){n.stopPropagation();var e=t.prev();e.length>0&&e.hasClass("annowin_anno")&&o.fadeDown(t,function(){t.after(e),o.fadeUp(t,function(){o.showSaveOrderConfirmation(t.data("pageElem"))})})}),t.find(".order-down").click(function(n){n.stopPropagation();var e=t.next();e.length>0&&e.hasClass("annowin_anno")&&o.fadeUp(t,function(){t.before(e),o.fadeDown(t,function(){o.showSaveOrderConfirmation(t.data("pageElem"))})})})}}]),t}();n.default=f;var d=Handlebars.compile(['<div class="annowin_anno" tabindex="-1">','  <div class="normal_view">',"    {{#if isEditor}}",'      <div class="menu_bar">','        <div class="ui text menu">','          <div class="ui dropdown item">','            <i class="fa fa-bars fa-fw"></i>','            <div class="menu">','              <div class="annotate item"><i class="fa fa-hand-o-left fa-fw"></i> Annotate</div>','              <div class="edit item"><i class="fa fa-edit fa-fw"></i> {{t "edit"}}</div>','              <div class="delete item"><i class="fa fa-times fa-fw"></i> {{t "delete"}}</div>',"            </div>","          </div>","          {{#if orderable}}",'            <div class="right menu">','              <i class="order-down caret down icon"></i>','              <i class="order-up caret up icon"></i>',"            </div>","          {{/if}}","        </div>","      </div>","    {{/if}}",'    <div class="content">{{{content}}}</div>','    <div class="tags">{{{tags}}}</div>',"  </div>","</div>"].join(""))},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function i(t,n){var e=!0,r=!1,o=void 0;try{for(var a,u=t.annotations[Symbol.iterator]();!(e=(a=u.next()).done);e=!0)if(a.value.layerId===n)return!0}catch(t){r=!0,o=t}finally{try{!e&&u.return&&u.return()}finally{if(r)throw o}}var s=!0,c=!1,l=void 0;try{for(var f,d=Object.values(t.childNodes)[Symbol.iterator]();!(s=(f=d.next()).done);s=!0)if(i(f.value,n))return!0}catch(t){c=!0,l=t}finally{try{!s&&d.return&&d.return()}finally{if(c)throw l}}return!1}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),u=r(e(0)),s=r(e(6)),c=(0,u.default)(),l=function(){function t(n){o(this,t),this.options=Object.assign({container:null,canvasId:null,layerId:null,toc:null,annotationRenderer:null},n),c.debug("AnnotationTocRenderer#constructor options:",n),this._isEditor=s.default.isEditor()}return a(t,[{key:"render",value:function(){var t=this;c.debug("AnnotationTocRenderer#render"),this.options.toc.walk(function(n,e){n.isRoot||(e<2&&!n.isDummy&&t.appendHeader(n),t.appendAnnotations(n))}),this.appendUnattachedAnnotations()}},{key:"appendHeader",value:function(t){if(i(t,this.options.layerId)){var n=this.createHeaderElem(t);this.options.container.append(n)}}},{key:"appendAnnotations",value:function(t){var n=this.options.annotationRenderer,e=this.options.container,r=!0,o=!1,i=void 0;try{for(var a,u=t.annotations[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var s=a.value;if(s.layerId===this.options.layerId){var c=n.createAnnoElem(s,{pageElem:e,canvasId:e.data("canvasId"),isEditor:this._isEditor});e.append(c)}}}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}}},{key:"appendUnattachedAnnotations",value:function(){this.options.annotationRenderer;if(this.options.toc.numUnassigned()>0){var t=!0,n=!1,e=void 0;try{for(var r,o=this.options.toc.unassigned()[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;c.error("AnnotationTocRenderer#appendUnattachedAnnotations unassigned:",i)}}catch(t){n=!0,e=t}finally{try{!t&&o.return&&o.return()}finally{if(n)throw e}}}}},{key:"createHeaderElem",value:function(t){var n=f({text:t.label}),e=jQuery(n).addClass("header-level-"+t.tags.length);return t.tags instanceof Array&&t.tags.length>0||c.error("AnnotationTocRenderer#createHeaderElem invalid tags for node:",t),e.data("tags",t.tags),e}}]),t}();n.default=l;var f=Handlebars.compile(['<div class="annowin_group_header">{{text}}',"</div>"].join(""))},function(t,n,e){"use strict";function r(t){return function(){var n=t.apply(this,arguments);return new Promise(function(t,e){function r(o,i){try{var a=n[o](i),u=a.value}catch(t){return void e(t)}if(!a.done)return Promise.resolve(u).then(function(t){r("next",t)},function(t){r("throw",t)});t(u)}return r("next")})}}function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),a=(0,function(t){return t&&t.__esModule?t:{default:t}}(e(0)).default)(),u=function(){function t(n){o(this,t),this._annoWin=n.annotationWindow,this._listWidget=n.listWidget,this._groupHeaderHeight=n.groupHeaderHeight,this._continousPages=n.continuousPages,this._rootElem=this._listWidget.getRootElement(),this._nav=this._listWidget.getNav(),this._annoWinDom=this._annoWin.getDomHelper()}return i(t,[{key:"scrollToPage",value:function(t){var n=this,e=this._nav.getPageElement(t).find(".page-header");return this.unbindScrollEvent(),new Promise(function(t,r){n._rootElem.scrollTo(e,{onAfter:function(){n.bindScrollEvent(),t()}})})}},{key:"scrollToTags",value:function(t){a.debug("ScrollHelper#scrollToTags targetTags:",t);var n=null,e=null;this._rootElem.find(".annowin_group_header").each(function(e,r){var o=jQuery(r),i=o.data("tags");if(i instanceof Array&&i.length>0||(a.error("ScrollHelper#scrollToTags invalid tags",i,"for header elem",o[0].outerHTML),i=[]),1===t.length){if(i[0]===t[0])return n=o,!1}else if(i[0]===t[0]&&i[1]===t[1])return n=o,!1}),a.debug("ScrollHelper#scrollToTags targetHeaderElem:",n),n?(e=this._getNextAnnoElem(n))&&this._rootElem.scrollTo(e,{offset:{top:-this._groupHeaderHeight}}):a.warning("ScrollHelper#scrollToTags Header element not found for",t)}},{key:"_getNextAnnoElem",value:function(t){for(var n=t;n.size()>0&&!this._annoWinDom.isAnnotationCell(n);)n=n.next();return n.size()>0?n:null}},{key:"scrollToElem",value:function(t,n){var e=this,r=this._calcOffset(t,n);return this.unbindScrollEvent(),new Promise(function(n,o){e._rootElem.scrollTo(t,{offset:{top:r},onAfter:function(){e.bindScrollEvent(),n()}})})}},{key:"_calcOffset",value:function(t,n){if(void 0===n)return-this._groupHeaderHeight;var e=t.height()-this._rootElem.height();return n<e?e:n}},{key:"scrollToAnnotation",value:function(t,n){a.debug("AnnotationListWidget#scrollToAnnotation annotationId:",t,"yOffset:",n);var e=!0,r=!1,o=void 0;try{for(var i,u=this._listWidget.getAnnotationElems()[Symbol.iterator]();!(e=(i=u.next()).done);e=!0){var s=i.value,c=jQuery(s);if(c.data("annotationId")===t)return this.scrollToElem(c,n)}}catch(t){r=!0,o=t}finally{try{!e&&u.return&&u.return()}finally{if(r)throw o}}}},{key:"scrollDown",value:function(t){this._rootElem.scrollTo("+="+t)}},{key:"scrollUp",value:function(t){this._rootElem.scrollTo("-="+t)}},{key:"_windBack",value:function(){var t=this._rootElem,n=t.scrollTop();0===t[0].scrollHeight-t.scrollTop()-t.height()&&(a.debug("Winding back"),this.unbindScrollEvent(),t.scrollTop(n-5),this.bindScrollEvent())}},{key:"_windForward",value:function(){a.debug("_windForward");var t=this._rootElem,n=t.scrollTop();0===n&&(a.debug("Winding forward"),this.unbindScrollEvent(),t.scrollTop(n+5),this.bindScrollEvent())}},{key:"bindScrollEvent",value:function(){var t=this;this._continousPages&&this._rootElem.scroll(function(){var n=r(regeneratorRuntime.mark(function n(e){var r,o,i,a,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t._listWidget,o=jQuery(this),i=o.scrollTop(),a=i+o.height(),u=this.scrollHeight,!(i<20)){n.next=8;break}return n.next=8,r.loadPreviousPage();case 8:if(!(u-a<20)){n.next=11;break}return n.next=11,r.loadNextPage();case 11:case"end":return n.stop()}},n,this)}));return function(t){return n.apply(this,arguments)}}())}},{key:"unbindScrollEvent",value:function(){this._continousPages&&this._rootElem.off("scroll")}}]),t}();n.default=u},function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}();n.default=function(){if(!a){var t="ym_error_dialog",n=jQuery("#"+t);0===n.length&&(n=jQuery("<div/>").attr("id",t).addClass("ui modal ym_modal").appendTo(jQuery("body"))),a=new i(n)}return a};var i=function(){function t(n){r(this,t),this.elem=n,n.modal({onHidden:function(){n.modal("hide dimmer")}}),this.messageMap={layers:"<p>Sorry, there was a problem retrieving the annotation layers.</p>"+s,annotations:"<p>Sorry, there was a problem retrieving the annotations.</p>"+s,authz_create:"<p>Sorry, you are not authorized to create annotations.</p>",authz_update:"<p>Sorry, you are not authorized to update data.</p>",authz_delete:"<p>Sorry, you are not authorized to delete data.</p>"}}return o(t,[{key:"show",value:function(t){var n=this.messageMap[t]||"Undefined error.";this.elem.html(u({message:n})),this.elem.modal("show")}},{key:"hide",value:function(){this.elem.modal("hide")}}]),t}(),a=null,u=Handlebars.compile(['<div class="header">Error</div>','<div class="content">','  <div class="description">',"    {{{message}}}","  </div>","</div>",'<div class="actions">','  <div class="ui cancel button">Dismiss</div>',"</div>"].join("")),s="<p>Please try again by reloading the page, or if problem persists, contact the site administrator.</p>"},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),a=r(e(0)),u=r(e(16)),s=r(e(7)),c=(0,a.default)(),l=function(){function t(n){o(this,t),c.debug("MenuTagSelector#constructor options:",n),this.options=Object.assign({selector:null,parent:null,tocSpec:null,annotationExplorer:null,changeCallback:null,initialTags:null,depth:1},n),this.init()}return i(t,[{key:"init",value:function(){var t=this;return this.options.initialTags&&(this.options.initialTags=this.options.initialTags.slice(0,this.options.depth)),this.options.selector=new u.default({appendTo:this.options.parent,changeCallback:function(n,e){c.debug("MenuTagSelector select value:",n,"text:",e),"function"==typeof t.options.changeCallback&&t.options.changeCallback(n,e)}}),this.reload()}},{key:"reload",value:function(){var t=this,n=this.options.tocSpec;return new Promise(function(e,r){t.options.selector.empty();var o=t.buildMenu(n,null,0);c.debug("MenuTagSelector menu:",o),t.options.selector.setItems(o);var i=n.generator[0].tag.prefix+"1";setTimeout(function(){var n=t.options.initialTags&&t.options.initialTags.length>0?t.options.initialTags.join("|"):i;c.debug("MenuTagSelector#reload initially setting value to",n),t.options.selector.val(n,!0),e()},0)})}},{key:"val",value:function(t,n){return c.debug("MenuTagSelector#val value:",t,"skipNotify:",n),this.options.selector.val(t,n)}},{key:"buildMenu",value:function(t){for(var n=t.generator[0],e=[],r=1;r<=n.max;++r)e.push({label:n.label.prefix+r,value:n.tag.prefix+r,children:[]});return e}},{key:"buildMenu_old",value:function(t,n,e){if(c.debug("MenuTagSelector#buildMenu node:",t,"parentItem:",n,"currentDepth:",e),e>this.options.depth)return null;var r=this,o=s.default.getValues(t.childNodes).sort(function(t,n){return t.weight-n.weight}),i={children:[]};if(!t.isRoot){var a=n?n.label+", "+t.spec.label:t.spec.label,u=n?n.value+"|"+t.spec.tag:t.spec.tag;i.label=a,i.value=u}return o.length>0&&jQuery.each(o,function(n,o){var a=r.buildMenu(o,t.isRoot?null:i,e+1);a&&i.children.push(a)}),t.isRoot?[{label:"All",value:"all",children:[]}].concat(i.children):i}},{key:"destroy",value:function(){this.options.selector.destroy()}}]),t}();n.default=l},function(t,n){!function(t){function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var e={};n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=3)}([function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}();n.default=function(t){return new i(t)};var i=function(){function t(n){r(this,t),this.oaAnnotation=n}return o(t,[{key:"addTag",value:function(t){var n=this._makeArray(this.oaAnnotation.resource);n.push(this._createTag(t)),this.oaAnnotation.resource=n}},{key:"addTarget",value:function(t){var n=this.oaAnnotation;n.on=this._makeArray(n.on),n.on.push(t)}},{key:"addInverseTarget",value:function(t){var n=this.oaAnnotation;n.targetedBy=this._makeArray(n.targetedBy),n.targetedBy.push(t)}},{key:"_makeArray",value:function(t){return"null"==typeof t||void 0===t?[]:t instanceof Array?t:[t]}},{key:"_getTextResource",value:function(){var t=this._makeArray(this.oaAnnotation.resource).filter(function(t){return"dctypes:Text"===t["@type"]});return t.length>0?(t.length>1&&console.log("WARNING Annotation#_getTextResource too many text items:",t.length),t[0]):null}},{key:"_createTag",value:function(t){return{"@type":"oa:Tag",chars:t}}},{key:"id",get:function(){return this.oaAnnotation["@id"]}},{key:"layerId",get:function(){return this.oaAnnotation.layerId}},{key:"layers",get:function(){return this.oaAnnotation.layers}},{key:"bodyText",get:function(){var t=this._getTextResource();return t?t.chars:null},set:function(t){var n=this._getTextResource();return!!n&&(n.chars=t,!0)}},{key:"bodyStyle",get:function(){var t=this._getTextResource();return t?t.style:null}},{key:"tags",get:function(){var t=this._makeArray(this.oaAnnotation.resource),n=[],e=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var u=i.value;"oa:Tag"===u["@type"]&&n.push(u.chars)}}catch(t){r=!0,o=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw o}}return n}},{key:"targets",get:function(){return this._makeArray(this.oaAnnotation.on)}},{key:"targetedBy",get:function(){return this._makeArray(this.oaAnnotation.targetedBy)}}]),t}()},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(t){return t&&t.__esModule?t:{default:t}}(e(0));n.default={logger:{debug:function(){},info:function(){},warning:function(){},error:function(){}},setLogger:function(t){this.logger=t},targetIsAnnotationOnCanvas:function(t){return"oa:Annotation"!==t["@type"]},hasTargetOnCanvas:function(t){var n=!0,e=!1,r=void 0;try{for(var i,a=(0,o.default)(t).targets[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var u=i.value;if(this.targetIsAnnotationOnCanvas(u))return!0}}catch(t){e=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(e)throw r}}return!1},findAnnotationFromListById:function(t,n){var e=n.filter(function(n){return n&&"object"===(void 0===n?"undefined":r(n))?n["@id"]===t:(logger.error("AnnotationUtil#findAnnotationFromListById invalid annotation",n),!1)});return e.length>1&&logger.error("AnnotationUtil#findAnnotationFromListById duplicate IDs",e),e[0]},findTransitiveTargetAnnotations:function(t,n){var e=(0,o.default)(t).targets.map(function(t){var e=t.full;return n[e]}).filter(function(t){return void 0!==t&&null!==t});if(0===e.length)return[];var r=e,i=!0,a=!1,u=void 0;try{for(var s,c=e[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var l=s.value,f=this.findTransitiveTargetAnnotations(l,n);r=r.concat(f)}}catch(t){a=!0,u=t}finally{try{!i&&c.return&&c.return()}finally{if(a)throw u}}return r},findTransitiveTargetingAnnotations:function(t,n){var e=(0,o.default)(t).targetedBy;if(0===(e=e.filter(function(t){var e=n[t["@id"]];return void 0!==e&&null!==e})).length)return[];var r=e,i=!0,a=!1,u=void 0;try{for(var s,c=e[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var l=s.value,f=this.findTransitiveTargetingAnnotations(l,n);r=r.concat(f)}}catch(t){a=!0,u=t}finally{try{!i&&c.return&&c.return()}finally{if(a)throw u}}return r},findTargetAnnotationsOnCanvas:function(t,n){var e=this;return this.findTransitiveTargetAnnotations(t,n).filter(function(t){var n=!0,r=!1,i=void 0;try{for(var a,u=(0,o.default)(t).targets[Symbol.iterator]();!(n=(a=u.next()).done);n=!0){var s=a.value;if(e.targetIsAnnotationOnCanvas(s))return!0}}catch(t){r=!0,i=t}finally{try{!n&&u.return&&u.return()}finally{if(r)throw i}}return!1})},findTocSiblings:function(t,n,e,r){var o=r.findNodeForAnnotation(t);return o?n.filter(function(t){return t.layerId===e&&r.findNodeForAnnotation(t)===o}):[]},findAllAnnotationsForTocNode:function(t){var n=[].concat(t.annotations),e=!0,r=!1,o=void 0;try{for(var i,a=Object.values(t.childNodes)[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var u=i.value;n=n.concat(this.findAllAnnotationsForTocNode(u))}}catch(t){r=!0,o=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw o}}return n},mergeTargetsOld:function(t,n){var e=t.on,r=e.full,o=n.full;if(e instanceof Array){var i=e.filter(function(t){return t.full===o});if(1===i.length){var a=i[0];a.selector.value=svgUtil.mergeSvgs(a.selector.value,n.selector.value)}else{if(0!==i.length)throw"multiple targets on same canvas";t.on.push(n)}}else{e.full;r===o?e.selector.value=svgUtil.mergeSvgs(e.selector.value,n.selector.value):t.on=[e,n]}}}},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,n){var e=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return e}return function(n,e){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return t(n,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),u=r(e(0)),s=r(e(1)),c={debug:function(){return null},info:function(){return null},warning:function(){return null},error:function(){return null}},l=function(){function t(n,e,r){o(this,t),this.options=Object.assign({logger:null},r||{}),this.options.logger&&(c=this.options.logger),this.spec=n,this.annotations=e,this._annoMap={};var i=!0,a=!1,u=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var f=s.value;this._annoMap[f["@id"]]=f}}catch(t){a=!0,u=t}finally{try{!i&&l.return&&l.return()}finally{if(a)throw u}}this._root=null,this._unassigned=[],this.annoToNodeMap={},this.init()}return a(t,[{key:"init",value:function(t){c.debug("AnnotationToc#init spec: ",this.spec),this._root=this._newNode(null,null),this.parse(this.annotations)}},{key:"getNode",value:function(){var t=Array.from(arguments),n=this._root,e=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var u=i.value;if(!n)break;n=n.childNodes[u]}}catch(t){r=!0,o=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw o}}return n===this._root?null:n}},{key:"findNodeForAnnotation",value:function(t){return this.getNode.apply(this,t.tocTags)}},{key:"getNodeFromTags",value:function(t){return this.getNode.apply(this,t)}},{key:"getTagsFromAnnotationId",value:function(t){var n=[];return this.walk(function(e){var r=!0,o=!1,i=void 0;try{for(var a,u=e.annotations[Symbol.iterator]();!(r=(a=u.next()).done);r=!0)if(a.value["@id"]===t)return n=e.tags,!0}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}}),n}},{key:"matchHierarchy",value:function(t,n){var e=this.getNodeFromTags(n);return!!e&&this.matchNode(t,e)}},{key:"matchNode",value:function(t,n){var e=n.canvasAnnotations.filter(function(n){return n["@id"]===t["@id"]});if(e.length>0)return!0;if((e=n.annotations.filter(function(n){return n["@id"]===t["@id"]})).length>0)return!0;var r=!0,o=!1,i=void 0;try{for(var a,u=Object.values(n.childNodes)[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var s=a.value;if(this.matchNode(t,s))return!0}}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return!1}},{key:"unassigned",value:function(){return this._unassigned}},{key:"numUnassigned",value:function(){return this._unassigned.length}},{key:"walk",value:function(t){this._visit(this._root,t,0)}},{key:"_visit",value:function(t,n,e){var r=Object.values(t.childNodes).sort(function(t,n){return t.weight-n.weight}),o=!0,i=!1,a=void 0;try{for(var u,s=r[Symbol.iterator]();!(o=(u=s.next()).done);o=!0){var c=u.value;n(c,e)||this._visit(c,n,e+1)}}catch(t){i=!0,a=t}finally{try{!o&&s.return&&s.return()}finally{if(i)throw a}}}},{key:"parse",value:function(){this._buildTocTree(this.annotations),this._setNodeOrders(this._root)}},{key:"_setNodeOrders",value:function(t){if(0!==t.childNodes.length)for(var n=/\d+$/,e=Object.keys(t.childNodes).sort(function(t,e){return Number(t.substring(t.match(n).index))-Number(e.substring(e.match(n).index))}),r=0;r<e.length;++r){var o=e[r],i=t.childNodes[o];i.weight=r,this._setNodeOrders(i)}}},{key:"_buildTocTree",value:function(t){var n=!0,e=!1,r=void 0;try{for(var o,i=t[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){var a=o.value,s=(0,u.default)(a).tags;this._buildChildNodes(a,s,0,this._root)||this._unassigned.push(a)}}catch(t){e=!0,r=t}finally{try{!n&&i.return&&i.return()}finally{if(e)throw r}}}},{key:"_buildChildNodes",value:function(t,n,e,r){var o=null;if(e>=this.spec.generator.length)return!r.isRoot&&(t.tocTags=r.tags,s.default.hasTargetOnCanvas(t)&&r.canvasAnnotations.push(t),r.annotations.push(t),this.annoToNodeMap[t["@id"]]=r,!0);var a=this._getTagForLevel(n,e),u=i(a,2),c=u[0],l=u[1];return c?(r.childNodes[c]||(r.childNodes[c]=this._newNode(c,r,l)),o=r.childNodes[c],r.isRoot?o.label=this._extractTagNumber(c):o.label=r.label+"."+this._extractTagNumber(c),this._buildChildNodes(t,n,e+1,o)):!r.isRoot&&(t.tocTags=r.tags,s.default.hasTargetOnCanvas(t)&&r.canvasAnnotations.push(t),r.annotations.push(t),this.annoToNodeMap[t["@id"]]=r,!0)}},{key:"_getTagForLevel",value:function(t,n){var e=this.spec.generator[n].tag.prefix,r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var s=a.value,c=s.match("^"+e+"(\\d+)$");if(c)return[s,"0"===c[1]]}}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return[null,null]}},{key:"_extractTagNumber",value:function(t){return t.match(/\d+$/)[0]}},{key:"_newNode",value:function(t,n,e){return n?{annotations:[],canvasAnnotations:[],tags:n.isRoot?[t]:n.tags.concat([t]),label:"",childNodes:{},weight:0,isDummy:e}:{isRoot:!0,childNodes:{}}}},{key:"print",value:function(){var t=function(t){for(var n="",e=0;e<t;++e)n+="  ";return n},n=function(t,n,e){return t.length>n&&(t=e?"... "+t.substring(t.length-n+4):t.substring(0,n-4)+" ..."),t},e="";this.walk(function(r,o){e+=t(o)+"- [n] ",e+=String(r.tags),e+="\n";var i=!0,a=!1,s=void 0;try{for(var c,l=r.annotations[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var f=c.value;e+=t(o+1)+"- [a] ";var d=(0,u.default)(f).bodyText||"";e+=n(d,60)+"\n";var h=f.layerId||"";e+=t(o+1)+"      "+n(h,60,!0)+"\n"}}catch(t){a=!0,s=t}finally{try{!i&&l.return&&l.return()}finally{if(a)throw s}}}),console.log("TOC:\n"+e)}}]),t}();n.default=l},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=r(e(0)),i=r(e(4)),a=r(e(2)),u=r(e(1));window.joosugi={AnnotationExplorer:i.default,AnnotationToc:a.default,AnnotationWrapper:o.default,annotationUtil:u.default}},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),a=r(e(0)),u=r(e(2)),s=(r(e(1)),null),c=function(){function t(n){o(this,t),this.options=jQuery.extend({dataSource:null,tocSpec:null,logger:{debug:function(){return null},info:function(){return null},error:function(){return null}}},n),(s=this.options.logger).debug("AnnotationExplorer#constructor options:",n),this.AnnotationToc=null}return i(t,[{key:"getLayers",value:function(){return this.options.dataSource.getLayers()}},{key:"getAnnotations",value:function(t){var n=this;return t.canvasId?this.options.dataSource.getAnnotations(t).catch(function(t){throw"ERROR AnnotationExplorer#getAnnotations dataSource.getAnnotations failed: "+t}).then(function(t){return s.debug("AnnotationExplorer#getAnnotations annotations:",t),n._generateInverseTargets(t),t}):(s.error("AnnotationExplorer#getAnnotations missing options.canvasId"),Promise.resolve([]))}},{key:"createAnnotation",value:function(t){return this.options.dataSource.createAnnotation(t)}},{key:"updateAnnotation",value:function(t){return this.options.dataSource.updateAnnotation(t)}},{key:"deleteAnnotation",value:function(t){return s.debug("AnnotationExplorer#deleteAnnotation annotationId:",t),this.options.dataSource.deleteAnnotation(t)}},{key:"updateAnnotationListOrder",value:function(t,n,e){return s.debug("AnnotationExplorer#updateAnnotationListOrder"),this.options.dataSource.updateAnnotationListOrder(t,n,e)}},{key:"getAnnotationToc",value:function(){return this.annotationToc}},{key:"reloadAnnotationToc",value:function(t,n){this.annotationToc=new u.default(t,n),s.debug("AnnotationExplorer#reloadAnnotationToc toc:",this.annotationToc.annoHierarchy)}},{key:"_generateInverseTargets",value:function(t){var n={},e=!0,r=!1,o=void 0;try{for(var i,u=t[Symbol.iterator]();!(e=(i=u.next()).done);e=!0){var s=i.value;n[s["@id"]]=(0,a.default)(s)}}catch(t){r=!0,o=t}finally{try{!e&&u.return&&u.return()}finally{if(r)throw o}}var c=!0,l=!1,f=void 0;try{for(var d,h=t[Symbol.iterator]();!(c=(d=h.next()).done);c=!0){var v=d.value,g=!0,p=!1,y=void 0;try{for(var m,_=(0,a.default)(v).targets[Symbol.iterator]();!(g=(m=_.next()).done);g=!0){var b=m.value.full;n[b]&&n[b].addInverseTarget(v)}}catch(t){p=!0,y=t}finally{try{!g&&_.return&&_.return()}finally{if(p)throw y}}}}catch(t){l=!0,f=t}finally{try{!c&&h.return&&h.return()}finally{if(l)throw f}}}}]),t}();n.default=c}]),t.exports=joosugi},function(t,n){!function(t){function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var e={};n.m=t,n.c=e,n.i=function(t){return t},n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=14)}([function(t,n,e){"use strict";var r=function(t){return t&&t.__esModule?t:{default:t}}(e(8));e(13),window.joosugiUI={AnnotationExplorerDialog:r.default}},function(t,n,e){"use strict";function r(t){var n=t.length;if(n%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[n-2]?2:"="===t[n-1]?1:0}function o(t){return a[t>>18&63]+a[t>>12&63]+a[t>>6&63]+a[63&t]}function i(t,n,e){for(var r,i=[],a=n;a<e;a+=3)r=(t[a]<<16)+(t[a+1]<<8)+t[a+2],i.push(o(r));return i.join("")}n.byteLength=function(t){return 3*t.length/4-r(t)},n.toByteArray=function(t){var n,e,o,i,a,c,l=t.length;a=r(t),c=new s(3*l/4-a),o=a>0?l-4:l;var f=0;for(n=0,e=0;n<o;n+=4,e+=3)i=u[t.charCodeAt(n)]<<18|u[t.charCodeAt(n+1)]<<12|u[t.charCodeAt(n+2)]<<6|u[t.charCodeAt(n+3)],c[f++]=i>>16&255,c[f++]=i>>8&255,c[f++]=255&i;return 2===a?(i=u[t.charCodeAt(n)]<<2|u[t.charCodeAt(n+1)]>>4,c[f++]=255&i):1===a&&(i=u[t.charCodeAt(n)]<<10|u[t.charCodeAt(n+1)]<<4|u[t.charCodeAt(n+2)]>>2,c[f++]=i>>8&255,c[f++]=255&i),c},n.fromByteArray=function(t){for(var n,e=t.length,r=e%3,o="",u=[],s=0,c=e-r;s<c;s+=16383)u.push(i(t,s,s+16383>c?c:s+16383));return 1===r?(n=t[e-1],o+=a[n>>2],o+=a[n<<4&63],o+="=="):2===r&&(n=(t[e-2]<<8)+t[e-1],o+=a[n>>10],o+=a[n>>4&63],o+=a[n<<2&63],o+="="),u.push(o),u.join("")};for(var a=[],u=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,f=c.length;l<f;++l)a[l]=c[l],u[c.charCodeAt(l)]=l;u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63},function(t,n,e){"use strict";(function(t){function r(){return i.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(t,n){if(r()<n)throw new RangeError("Invalid typed array length");return i.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(n)).__proto__=i.prototype:(null===t&&(t=new i(n)),t.length=n),t}function i(t,n,e){if(!(i.TYPED_ARRAY_SUPPORT||this instanceof i))return new i(t,n,e);if("number"==typeof t){if("string"==typeof n)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return a(this,t,n,e)}function a(t,n,e,r){if("number"==typeof n)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer?d(t,n,e,r):"string"==typeof n?l(t,n,e):h(t,n)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function s(t,n,e,r){return u(n),n<=0?o(t,n):void 0!==e?"string"==typeof r?o(t,n).fill(e,r):o(t,n).fill(e):o(t,n)}function c(t,n){if(u(n),t=o(t,n<0?0:0|v(n)),!i.TYPED_ARRAY_SUPPORT)for(var e=0;e<n;++e)t[e]=0;return t}function l(t,n,e){if("string"==typeof e&&""!==e||(e="utf8"),!i.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var r=0|g(n,e),a=(t=o(t,r)).write(n,e);return a!==r&&(t=t.slice(0,a)),t}function f(t,n){var e=n.length<0?0:0|v(n.length);t=o(t,e);for(var r=0;r<e;r+=1)t[r]=255&n[r];return t}function d(t,n,e,r){if(n.byteLength,e<0||n.byteLength<e)throw new RangeError("'offset' is out of bounds");if(n.byteLength<e+(r||0))throw new RangeError("'length' is out of bounds");return n=void 0===e&&void 0===r?new Uint8Array(n):void 0===r?new Uint8Array(n,e):new Uint8Array(n,e,r),i.TYPED_ARRAY_SUPPORT?(t=n).__proto__=i.prototype:t=f(t,n),t}function h(t,n){if(i.isBuffer(n)){var e=0|v(n.length);return 0===(t=o(t,e)).length?t:(n.copy(t,0,0,e),t)}if(n){if("undefined"!=typeof ArrayBuffer&&n.buffer instanceof ArrayBuffer||"length"in n)return"number"!=typeof n.length||q(n.length)?o(t,0):f(t,n);if("Buffer"===n.type&&$(n.data))return f(t,n.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function v(t){if(t>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|t}function g(t,n){if(i.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var e=t.length;if(0===e)return 0;for(var r=!1;;)switch(n){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":case void 0:return Q(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*e;case"hex":return e>>>1;case"base64":return V(t).length;default:if(r)return Q(t).length;n=(""+n).toLowerCase(),r=!0}}function p(t,n,e){var r=!1;if((void 0===n||n<0)&&(n=0),n>this.length)return"";if((void 0===e||e>this.length)&&(e=this.length),e<=0)return"";if(e>>>=0,n>>>=0,e<=n)return"";for(t||(t="utf8");;)switch(t){case"hex":return O(this,n,e);case"utf8":case"utf-8":return P(this,n,e);case"ascii":return I(this,n,e);case"latin1":case"binary":return C(this,n,e);case"base64":return T(this,n,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,n,e);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function y(t,n,e){var r=t[n];t[n]=t[e],t[e]=r}function m(t,n,e,r,o){if(0===t.length)return-1;if("string"==typeof e?(r=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,isNaN(e)&&(e=o?0:t.length-1),e<0&&(e=t.length+e),e>=t.length){if(o)return-1;e=t.length-1}else if(e<0){if(!o)return-1;e=0}if("string"==typeof n&&(n=i.from(n,r)),i.isBuffer(n))return 0===n.length?-1:_(t,n,e,r,o);if("number"==typeof n)return n&=255,i.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,n,e):Uint8Array.prototype.lastIndexOf.call(t,n,e):_(t,[n],e,r,o);throw new TypeError("val must be string, number or Buffer")}function _(t,n,e,r,o){function i(t,n){return 1===a?t[n]:t.readUInt16BE(n*a)}var a=1,u=t.length,s=n.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||n.length<2)return-1;a=2,u/=2,s/=2,e/=2}var c;if(o){var l=-1;for(c=e;c<u;c++)if(i(t,c)===i(n,-1===l?0:c-l)){if(-1===l&&(l=c),c-l+1===s)return l*a}else-1!==l&&(c-=c-l),l=-1}else for(e+s>u&&(e=u-s),c=e;c>=0;c--){for(var f=!0,d=0;d<s;d++)if(i(t,c+d)!==i(n,d)){f=!1;break}if(f)return c}return-1}function b(t,n,e,r){e=Number(e)||0;var o=t.length-e;r?(r=Number(r))>o&&(r=o):r=o;var i=n.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var u=parseInt(n.substr(2*a,2),16);if(isNaN(u))return a;t[e+a]=u}return a}function w(t,n,e,r){return G(Q(n,t.length-e),t,e,r)}function x(t,n,e,r){return G(Y(n),t,e,r)}function A(t,n,e,r){return x(t,n,e,r)}function S(t,n,e,r){return G(V(n),t,e,r)}function k(t,n,e,r){return G(z(n,t.length-e),t,e,r)}function T(t,n,e){return 0===n&&e===t.length?K.fromByteArray(t):K.fromByteArray(t.slice(n,e))}function P(t,n,e){e=Math.min(t.length,e);for(var r=[],o=n;o<e;){var i=t[o],a=null,u=i>239?4:i>223?3:i>191?2:1;if(o+u<=e){var s,c,l,f;switch(u){case 1:i<128&&(a=i);break;case 2:128==(192&(s=t[o+1]))&&(f=(31&i)<<6|63&s)>127&&(a=f);break;case 3:s=t[o+1],c=t[o+2],128==(192&s)&&128==(192&c)&&(f=(15&i)<<12|(63&s)<<6|63&c)>2047&&(f<55296||f>57343)&&(a=f);break;case 4:s=t[o+1],c=t[o+2],l=t[o+3],128==(192&s)&&128==(192&c)&&128==(192&l)&&(f=(15&i)<<18|(63&s)<<12|(63&c)<<6|63&l)>65535&&f<1114112&&(a=f)}}null===a?(a=65533,u=1):a>65535&&(a-=65536,r.push(a>>>10&1023|55296),a=56320|1023&a),r.push(a),o+=u}return E(r)}function E(t){var n=t.length;if(n<=X)return String.fromCharCode.apply(String,t);for(var e="",r=0;r<n;)e+=String.fromCharCode.apply(String,t.slice(r,r+=X));return e}function I(t,n,e){var r="";e=Math.min(t.length,e);for(var o=n;o<e;++o)r+=String.fromCharCode(127&t[o]);return r}function C(t,n,e){var r="";e=Math.min(t.length,e);for(var o=n;o<e;++o)r+=String.fromCharCode(t[o]);return r}function O(t,n,e){var r=t.length;(!n||n<0)&&(n=0),(!e||e<0||e>r)&&(e=r);for(var o="",i=n;i<e;++i)o+=H(t[i]);return o}function M(t,n,e){for(var r=t.slice(n,e),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function j(t,n,e){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+n>e)throw new RangeError("Trying to access beyond buffer length")}function R(t,n,e,r,o,a){if(!i.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>o||n<a)throw new RangeError('"value" argument is out of bounds');if(e+r>t.length)throw new RangeError("Index out of range")}function L(t,n,e,r){n<0&&(n=65535+n+1);for(var o=0,i=Math.min(t.length-e,2);o<i;++o)t[e+o]=(n&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function N(t,n,e,r){n<0&&(n=4294967295+n+1);for(var o=0,i=Math.min(t.length-e,4);o<i;++o)t[e+o]=n>>>8*(r?o:3-o)&255}function W(t,n,e,r,o,i){if(e+r>t.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function D(t,n,e,r,o){return o||W(t,n,e,4,3.4028234663852886e38,-3.4028234663852886e38),J.write(t,n,e,r,23,4),e+4}function B(t,n,e,r,o){return o||W(t,n,e,8,1.7976931348623157e308,-1.7976931348623157e308),J.write(t,n,e,r,52,8),e+8}function F(t){if((t=U(t).replace(Z,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function U(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function H(t){return t<16?"0"+t.toString(16):t.toString(16)}function Q(t,n){n=n||1/0;for(var e,r=t.length,o=null,i=[],a=0;a<r;++a){if((e=t.charCodeAt(a))>55295&&e<57344){if(!o){if(e>56319){(n-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(n-=3)>-1&&i.push(239,191,189);continue}o=e;continue}if(e<56320){(n-=3)>-1&&i.push(239,191,189),o=e;continue}e=65536+(o-55296<<10|e-56320)}else o&&(n-=3)>-1&&i.push(239,191,189);if(o=null,e<128){if((n-=1)<0)break;i.push(e)}else if(e<2048){if((n-=2)<0)break;i.push(e>>6|192,63&e|128)}else if(e<65536){if((n-=3)<0)break;i.push(e>>12|224,e>>6&63|128,63&e|128)}else{if(!(e<1114112))throw new Error("Invalid code point");if((n-=4)<0)break;i.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}}return i}function Y(t){for(var n=[],e=0;e<t.length;++e)n.push(255&t.charCodeAt(e));return n}function z(t,n){for(var e,r,o,i=[],a=0;a<t.length&&!((n-=2)<0);++a)r=(e=t.charCodeAt(a))>>8,o=e%256,i.push(o),i.push(r);return i}function V(t){return K.toByteArray(F(t))}function G(t,n,e,r){for(var o=0;o<r&&!(o+e>=n.length||o>=t.length);++o)n[o+e]=t[o];return o}function q(t){return t!=t}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var K=e(1),J=e(4),$=e(5);n.Buffer=i,n.SlowBuffer=function(t){return+t!=t&&(t=0),i.alloc(+t)},n.INSPECT_MAX_BYTES=50,i.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),n.kMaxLength=r(),i.poolSize=8192,i._augment=function(t){return t.__proto__=i.prototype,t},i.from=function(t,n,e){return a(null,t,n,e)},i.TYPED_ARRAY_SUPPORT&&(i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&i[Symbol.species]===i&&Object.defineProperty(i,Symbol.species,{value:null,configurable:!0})),i.alloc=function(t,n,e){return s(null,t,n,e)},i.allocUnsafe=function(t){return c(null,t)},i.allocUnsafeSlow=function(t){return c(null,t)},i.isBuffer=function(t){return!(null==t||!t._isBuffer)},i.compare=function(t,n){if(!i.isBuffer(t)||!i.isBuffer(n))throw new TypeError("Arguments must be Buffers");if(t===n)return 0;for(var e=t.length,r=n.length,o=0,a=Math.min(e,r);o<a;++o)if(t[o]!==n[o]){e=t[o],r=n[o];break}return e<r?-1:r<e?1:0},i.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(t,n){if(!$(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return i.alloc(0);var e;if(void 0===n)for(n=0,e=0;e<t.length;++e)n+=t[e].length;var r=i.allocUnsafe(n),o=0;for(e=0;e<t.length;++e){var a=t[e];if(!i.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,o),o+=a.length}return r},i.byteLength=g,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var n=0;n<t;n+=2)y(this,n,n+1);return this},i.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var n=0;n<t;n+=4)y(this,n,n+3),y(this,n+1,n+2);return this},i.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var n=0;n<t;n+=8)y(this,n,n+7),y(this,n+1,n+6),y(this,n+2,n+5),y(this,n+3,n+4);return this},i.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?P(this,0,t):p.apply(this,arguments)},i.prototype.equals=function(t){if(!i.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===i.compare(this,t)},i.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},i.prototype.compare=function(t,n,e,r,o){if(!i.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===n&&(n=0),void 0===e&&(e=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),n<0||e>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&n>=e)return 0;if(r>=o)return-1;if(n>=e)return 1;if(n>>>=0,e>>>=0,r>>>=0,o>>>=0,this===t)return 0;for(var a=o-r,u=e-n,s=Math.min(a,u),c=this.slice(r,o),l=t.slice(n,e),f=0;f<s;++f)if(c[f]!==l[f]){a=c[f],u=l[f];break}return a<u?-1:u<a?1:0},i.prototype.includes=function(t,n,e){return-1!==this.indexOf(t,n,e)},i.prototype.indexOf=function(t,n,e){return m(this,t,n,e,!0)},i.prototype.lastIndexOf=function(t,n,e){return m(this,t,n,e,!1)},i.prototype.write=function(t,n,e,r){if(void 0===n)r="utf8",e=this.length,n=0;else if(void 0===e&&"string"==typeof n)r=n,e=this.length,n=0;else{if(!isFinite(n))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");n|=0,isFinite(e)?(e|=0,void 0===r&&(r="utf8")):(r=e,e=void 0)}var o=this.length-n;if((void 0===e||e>o)&&(e=o),t.length>0&&(e<0||n<0)||n>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return b(this,t,n,e);case"utf8":case"utf-8":return w(this,t,n,e);case"ascii":return x(this,t,n,e);case"latin1":case"binary":return A(this,t,n,e);case"base64":return S(this,t,n,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,n,e);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var X=4096;i.prototype.slice=function(t,n){var e=this.length;t=~~t,n=void 0===n?e:~~n,t<0?(t+=e)<0&&(t=0):t>e&&(t=e),n<0?(n+=e)<0&&(n=0):n>e&&(n=e),n<t&&(n=t);var r;if(i.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,n)).__proto__=i.prototype;else{var o=n-t;r=new i(o,void 0);for(var a=0;a<o;++a)r[a]=this[a+t]}return r},i.prototype.readUIntLE=function(t,n,e){t|=0,n|=0,e||j(t,n,this.length);for(var r=this[t],o=1,i=0;++i<n&&(o*=256);)r+=this[t+i]*o;return r},i.prototype.readUIntBE=function(t,n,e){t|=0,n|=0,e||j(t,n,this.length);for(var r=this[t+--n],o=1;n>0&&(o*=256);)r+=this[t+--n]*o;return r},i.prototype.readUInt8=function(t,n){return n||j(t,1,this.length),this[t]},i.prototype.readUInt16LE=function(t,n){return n||j(t,2,this.length),this[t]|this[t+1]<<8},i.prototype.readUInt16BE=function(t,n){return n||j(t,2,this.length),this[t]<<8|this[t+1]},i.prototype.readUInt32LE=function(t,n){return n||j(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},i.prototype.readUInt32BE=function(t,n){return n||j(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},i.prototype.readIntLE=function(t,n,e){t|=0,n|=0,e||j(t,n,this.length);for(var r=this[t],o=1,i=0;++i<n&&(o*=256);)r+=this[t+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*n)),r},i.prototype.readIntBE=function(t,n,e){t|=0,n|=0,e||j(t,n,this.length);for(var r=n,o=1,i=this[t+--r];r>0&&(o*=256);)i+=this[t+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*n)),i},i.prototype.readInt8=function(t,n){return n||j(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},i.prototype.readInt16LE=function(t,n){n||j(t,2,this.length);var e=this[t]|this[t+1]<<8;return 32768&e?4294901760|e:e},i.prototype.readInt16BE=function(t,n){n||j(t,2,this.length);var e=this[t+1]|this[t]<<8;return 32768&e?4294901760|e:e},i.prototype.readInt32LE=function(t,n){return n||j(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},i.prototype.readInt32BE=function(t,n){return n||j(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},i.prototype.readFloatLE=function(t,n){return n||j(t,4,this.length),J.read(this,t,!0,23,4)},i.prototype.readFloatBE=function(t,n){return n||j(t,4,this.length),J.read(this,t,!1,23,4)},i.prototype.readDoubleLE=function(t,n){return n||j(t,8,this.length),J.read(this,t,!0,52,8)},i.prototype.readDoubleBE=function(t,n){return n||j(t,8,this.length),J.read(this,t,!1,52,8)},i.prototype.writeUIntLE=function(t,n,e,r){t=+t,n|=0,e|=0,r||R(this,t,n,e,Math.pow(2,8*e)-1,0);var o=1,i=0;for(this[n]=255&t;++i<e&&(o*=256);)this[n+i]=t/o&255;return n+e},i.prototype.writeUIntBE=function(t,n,e,r){t=+t,n|=0,e|=0,r||R(this,t,n,e,Math.pow(2,8*e)-1,0);var o=e-1,i=1;for(this[n+o]=255&t;--o>=0&&(i*=256);)this[n+o]=t/i&255;return n+e},i.prototype.writeUInt8=function(t,n,e){return t=+t,n|=0,e||R(this,t,n,1,255,0),i.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[n]=255&t,n+1},i.prototype.writeUInt16LE=function(t,n,e){return t=+t,n|=0,e||R(this,t,n,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):L(this,t,n,!0),n+2},i.prototype.writeUInt16BE=function(t,n,e){return t=+t,n|=0,e||R(this,t,n,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):L(this,t,n,!1),n+2},i.prototype.writeUInt32LE=function(t,n,e){return t=+t,n|=0,e||R(this,t,n,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[n+3]=t>>>24,this[n+2]=t>>>16,this[n+1]=t>>>8,this[n]=255&t):N(this,t,n,!0),n+4},i.prototype.writeUInt32BE=function(t,n,e){return t=+t,n|=0,e||R(this,t,n,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):N(this,t,n,!1),n+4},i.prototype.writeIntLE=function(t,n,e,r){if(t=+t,n|=0,!r){var o=Math.pow(2,8*e-1);R(this,t,n,e,o-1,-o)}var i=0,a=1,u=0;for(this[n]=255&t;++i<e&&(a*=256);)t<0&&0===u&&0!==this[n+i-1]&&(u=1),this[n+i]=(t/a>>0)-u&255;return n+e},i.prototype.writeIntBE=function(t,n,e,r){if(t=+t,n|=0,!r){var o=Math.pow(2,8*e-1);R(this,t,n,e,o-1,-o)}var i=e-1,a=1,u=0;for(this[n+i]=255&t;--i>=0&&(a*=256);)t<0&&0===u&&0!==this[n+i+1]&&(u=1),this[n+i]=(t/a>>0)-u&255;return n+e},i.prototype.writeInt8=function(t,n,e){return t=+t,n|=0,e||R(this,t,n,1,127,-128),i.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[n]=255&t,n+1},i.prototype.writeInt16LE=function(t,n,e){return t=+t,n|=0,e||R(this,t,n,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):L(this,t,n,!0),n+2},i.prototype.writeInt16BE=function(t,n,e){return t=+t,n|=0,e||R(this,t,n,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):L(this,t,n,!1),n+2},i.prototype.writeInt32LE=function(t,n,e){return t=+t,n|=0,e||R(this,t,n,4,2147483647,-2147483648),i.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8,this[n+2]=t>>>16,this[n+3]=t>>>24):N(this,t,n,!0),n+4},i.prototype.writeInt32BE=function(t,n,e){return t=+t,n|=0,e||R(this,t,n,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),i.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):N(this,t,n,!1),n+4},i.prototype.writeFloatLE=function(t,n,e){return D(this,t,n,!0,e)},i.prototype.writeFloatBE=function(t,n,e){return D(this,t,n,!1,e)},i.prototype.writeDoubleLE=function(t,n,e){return B(this,t,n,!0,e)},i.prototype.writeDoubleBE=function(t,n,e){return B(this,t,n,!1,e)},i.prototype.copy=function(t,n,e,r){if(e||(e=0),r||0===r||(r=this.length),n>=t.length&&(n=t.length),n||(n=0),r>0&&r<e&&(r=e),r===e)return 0;if(0===t.length||0===this.length)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(e<0||e>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-n<r-e&&(r=t.length-n+e);var o,a=r-e;if(this===t&&e<n&&n<r)for(o=a-1;o>=0;--o)t[o+n]=this[o+e];else if(a<1e3||!i.TYPED_ARRAY_SUPPORT)for(o=0;o<a;++o)t[o+n]=this[o+e];else Uint8Array.prototype.set.call(t,this.subarray(e,e+a),n);return a},i.prototype.fill=function(t,n,e,r){if("string"==typeof t){if("string"==typeof n?(r=n,n=0,e=this.length):"string"==typeof e&&(r=e,e=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!i.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(n<0||this.length<n||this.length<e)throw new RangeError("Out of range index");if(e<=n)return this;n>>>=0,e=void 0===e?this.length:e>>>0,t||(t=0);var a;if("number"==typeof t)for(a=n;a<e;++a)this[a]=t;else{var u=i.isBuffer(t)?t:Q(new i(t,r).toString()),s=u.length;for(a=0;a<e-n;++a)this[a+n]=u[a%s]}return this};var Z=/[^+\/0-9A-Za-z-_]/g}).call(n,e(7))},function(t,n,e){"use strict";(function(n){function e(t,n){var e=t[1]||"",o=t[3];if(!o)return e;if(n){var i=r(o),a=o.sources.map(function(t){return"/*# sourceURL="+o.sourceRoot+t+" */"});return[e].concat(a).concat([i]).join("\n")}return[e].join("\n")}function r(t){return"/*# "+("sourceMappingURL=data:application/json;charset=utf-8;base64,"+new n(JSON.stringify(t)).toString("base64"))+" */"}t.exports=function(t){var n=[];return n.toString=function(){return this.map(function(n){var r=e(n,t);return n[2]?"@media "+n[2]+"{"+r+"}":r}).join("")},n.i=function(t,e){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<t.length;o++){var a=t[o];"number"==typeof a[0]&&r[a[0]]||(e&&!a[2]?a[2]=e:e&&(a[2]="("+a[2]+") and ("+e+")"),n.push(a))}},n}}).call(n,e(2).Buffer)},function(t,n,e){"use strict";n.read=function(t,n,e,r,o){var i,a,u=8*o-r-1,s=(1<<u)-1,c=s>>1,l=-7,f=e?o-1:0,d=e?-1:1,h=t[n+f];for(f+=d,i=h&(1<<-l)-1,h>>=-l,l+=u;l>0;i=256*i+t[n+f],f+=d,l-=8);for(a=i&(1<<-l)-1,i>>=-l,l+=r;l>0;a=256*a+t[n+f],f+=d,l-=8);if(0===i)i=1-c;else{if(i===s)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,r),i-=c}return(h?-1:1)*a*Math.pow(2,i-r)},n.write=function(t,n,e,r,o,i){var a,u,s,c=8*i-o-1,l=(1<<c)-1,f=l>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:i-1,v=r?1:-1,g=n<0||0===n&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(u=isNaN(n)?1:0,a=l):(a=Math.floor(Math.log(n)/Math.LN2),n*(s=Math.pow(2,-a))<1&&(a--,s*=2),(n+=a+f>=1?d/s:d*Math.pow(2,1-f))*s>=2&&(a++,s/=2),a+f>=l?(u=0,a=l):a+f>=1?(u=(n*s-1)*Math.pow(2,o),a+=f):(u=n*Math.pow(2,f-1)*Math.pow(2,o),a=0));o>=8;t[e+h]=255&u,h+=v,u/=256,o-=8);for(a=a<<o|u,c+=o;c>0;t[e+h]=255&a,h+=v,a/=256,c-=8);t[e+h-v]|=128*g}},function(t,n,e){"use strict";var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},function(t,n,e){"use strict";t.exports=function(t){var n="undefined"!=typeof window&&window.location;if(!n)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var e=n.protocol+"//"+n.host,r=e+n.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,n){var o=n.trim().replace(/^"(.*)"$/,function(t,n){return n}).replace(/^'(.*)'$/,function(t,n){return n});if(/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(o))return t;var i;return i=0===o.indexOf("//")?o:0===o.indexOf("/")?e+o:r+o.replace(/^\.\//,""),"url("+JSON.stringify(i)+")"})}},function(t,n,e){"use strict";var r,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"===("undefined"==typeof window?"undefined":o(window))&&(r=window)}t.exports=r},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t){return function(){var n=t.apply(this,arguments);return new Promise(function(t,e){function r(o,i){try{var a=n[o](i),u=a.value}catch(t){return void e(t)}if(!a.done)return Promise.resolve(u).then(function(t){r("next",t)},function(t){r("throw",t)});t(u)}return r("next")})}}function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),u=r(e(10)),s=r(e(9)),c=null,l=function(){function t(n){var e=this;i(this,t),this.options=Object.assign({appendTo:null,annotationExplorer:null,canvases:[],defaultCanvasId:null,layers:[],defaultLayerId:null,onSelect:null,logger:{debug:function(){return null},info:function(){return null},error:function(){return null}}},n),(c=this.options.logger).debug("AnnotationExplorerDialog#constructor this.options:",this.options),this.id="joosugi_anno_explorer_dialog",this.elem=this.createElem(this.id),this.annosPanel=new s.default({appendTo:this.elem.find(".column.annos"),onChange:function(t){e.selectedAnnotation=t,e.okButton.removeClass("disabled")}}),this.okButton=this.elem.find(".ok"),this.cancelButton=this.elem.find(".cancel"),this.elem.modal({observeChanges:!0,onApprove:function(t){e.options.onSelect(e.selectedAnnotation)},onDeny:function(t){},onHidden:function(t){}}),this.canvasSelector=this.setupCanvasSelector(),this.layerSelector=this.setupLayerSelector();var r=this.options.defaultCanvasId||this.options.canvases[0]["@id"];this.canvasSelector.setValue(r),setTimeout(function(){e.canvasSelector.scrollToValue(r)},0);var o=this.options.defaultLayerId||this.options.layers[0]["@id"];this.layerSelector.setValue(o),this.layerSelector.scrollToValue(o),this.setupActions()}return a(t,[{key:"open",value:function(){this.elem.modal("show")}},{key:"createElem",value:function(t){var n=jQuery("#"+t);return n.length>0&&n.remove(),jQuery("<div/>").addClass("ui modal").attr("id",t).html(f()).appendTo(this.options.appendTo)}},{key:"setupCanvasSelector",value:function(){var t=this;return new u.default({appendTo:this.elem.find("#facets"),title:"Canvas",items:this.options.canvases,parseItem:function(t){return{label:t.label,value:t["@id"]}},isLeaf:function(t){return"sc:Range"!==t["@type"]},getChildren:function(t){return(t.canvases instanceof Array?t.canvases:[]).concat(t.members instanceof Array?t.members:[])},onChange:function(n){c.debug("AnnotationExplorerDialog canvas selected:",n),t.refresh()},logger:c})}},{key:"setupLayerSelector",value:function(){var t=this;return new u.default({appendTo:this.elem.find("#facets"),title:"Layer",items:this.options.layers,parseItem:function(t){return{label:t.label,value:t["@id"]}},onChange:function(n){c.debug("AnnotationExplorerDialog layer selected:",n),t.refresh()},logger:c})}},{key:"refresh",value:function(){var t=o(regeneratorRuntime.mark(function t(){var n,e,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.canvasSelector.value(),e=this.layerSelector.value(),c.debug("AnnotationExplorerDialog#refresh",n,e),n&&e){t.next=6;break}return c.debug("AnnotationExplorerDialog#refresh skipping..."),t.abrupt("return");case 6:return this.annosPanel.showPlaceHolderText("Retrieving annotations..."),t.next=9,this.options.annotationExplorer.getAnnotations({canvasId:n,layerId:e});case 9:r=t.sent,this.annosPanel.reload(r);case 11:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"setDimensions",value:function(){var t=jQuery(window).height(),n=.82*(t-180);this.elem.css("margin-top",-.45*t),this.contentGrid.css("height",n),this.canvasesPanel.css("height",.46*n),this.layersPanel.css("height",.46*n)}},{key:"scrollToCurrentCanvas",value:function(){var t=this,n=this.canvasesPanel.find(".canvas"),e=null;c.debug("AnnotationExplorerDialog scrollToCurrentCanvas",n.length),n.each(function(n,r){var o=$(r);if(o.data("canvasId")===t.currentCanvasId)return e=o,!1}),e&&this.canvasesPanel.scrollTop(e.position().top+this.canvasesPanel.scrollTop()-18)}},{key:"setupActions",value:function(){var t=this;this.okButton.addClass("disabled"),this.okButton.click(function(){}),this.cancelButton.click(function(){t.elem.modal("hide")})}}]),t}();n.default=l;var f=Handlebars.compile(['<div class="header">Find Annotation',"</div>",'<div class="content">','  <div class="ui grid">','    <div id="facets" class="six wide column facets">',"    </div>",'    <div class="ten wide column annos">',"    </div>","  </div>","</div>",'<div class="actions">','  <div class="ui ok button">Select</div>','  <div class="ui cancel button">Cancel</div>',"</div>"].join(""));Handlebars.compile(['<a href="#">{{label}}</a>'].join("")),Handlebars.compile(['<a href="#">{{label}}</a>'].join("")),Handlebars.compile(["<div>{{{content}}}</div>"].join(""))},function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),i=joosugi.annotationUtil,a=null,u=function(){function t(n){r(this,t),this.options=Object.assign({appendTo:null,onChange:null,logger:{debug:function(){return null},info:function(){return null},error:function(){return null}}},n),a=this.options.logger,this.elem=jQuery("<div/>").addClass("joosugi_anno_panel").html(s()).appendTo(this.options.appendTo),this.placeHolder=this.elem.find(".place-holder"),this.content=this.elem.find(".content")}return o(t,[{key:"value",value:function(){return this._value}},{key:"setValue",value:function(t){this.findItemByValue(t)?this._value!==t&&(this._value=t,this.refresh(),this.options.onChange(t)):console.log("AnnotationPanel#setValue failed for value: "+t)}},{key:"findItemByValue",value:function(t){var n=!0,e=!1,r=void 0;try{for(var o,i=this.content.find(".item")[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){var a=o.value;if(console.log("00: "+t["@id"]),console.log("01: "+jQuery(a).data("item")["@id"]),jQuery(a).data("item")===t)return!0}}catch(t){e=!0,r=t}finally{try{!n&&i.return&&i.return()}finally{if(e)throw r}}return!1}},{key:"showPlaceHolderText",value:function(t){this.placeHolder.text(t),this.placeHolder.show()}},{key:"hidePlaceHolderText",value:function(){this.placeHolder.hide()}},{key:"reload",value:function(t){a.debug("AnnotationPanel#reload",t),this.content.empty();var n=!0,e=!1,r=void 0;try{for(var o,i=t[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){var u=o.value;this.content.append(this.createItem(u))}}catch(t){e=!0,r=t}finally{try{!n&&i.return&&i.return()}finally{if(e)throw r}}t.length>0?this.hidePlaceHolderText():this.showPlaceHolderText("No annotations found")}},{key:"refresh",value:function(){var t=!0,n=!1,e=void 0;try{for(var r,o=this.content.find(".item")[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value,a=jQuery(i);a.data("item")["@id"]===this._value["@id"]?a.addClass("selected"):a.removeClass("selected")}}catch(t){n=!0,e=t}finally{try{!t&&o.return&&o.return()}finally{if(n)throw e}}}},{key:"createItem",value:function(t){var n=this,e=jQuery("<div/>").addClass("item").html(i.getText(t));return e.data("item",t),e.click(function(){n.setValue(t)}),e}}]),t}();n.default=u;var s=Handlebars.compile(['<span class="place-holder"></span>','<div class="content"></div>'].join(""))},function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),i=null,a=function(){function t(n){r(this,t),this.options=Object.assign({appendTo:null,title:null,items:[],parseItem:null,isLeaf:function(){return!0},getChildren:null,onChange:function(){return null},logger:{debug:function(){return null},info:function(){return null},error:function(){return null}}},n),i=this.options.logger,this.elem=jQuery("<div/>").addClass("ui accordion").html(u).appendTo(this.options.appendTo),this.elem.find(".title").text(this.options.title),this.content=this.elem.find(".content");var e=!0,o=!1,a=void 0;try{for(var s,c=this.options.items[Symbol.iterator]();!(e=(s=c.next()).done);e=!0){var l=s.value;this.addItem(l,this.content)}}catch(t){o=!0,a=t}finally{try{!e&&c.return&&c.return()}finally{if(o)throw a}}this.elem.accordion({collapsible:!1,animateChildren:!1,duration:0,on:"none"}),this.elem.accordion("open",0),this._value=null}return o(t,[{key:"value",value:function(){return this._value}},{key:"setValue",value:function(t){i.debug("FacetSelector#setValue",t),this.findItemByValue(t)?this._value!==t&&(this._value=t,this.refresh(),this.options.onChange(t)):i.error("FacetSelector#setValue failed for value",t)}},{key:"findItemByValue",value:function(t){var n=!0,e=!1,r=void 0;try{for(var o,i=this.content.find(".item")[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){var a=o.value;if(jQuery(a).data("item").value===t)return!0}}catch(t){e=!0,r=t}finally{try{!n&&i.return&&i.return()}finally{if(e)throw r}}return!1}},{key:"refresh",value:function(){var t=!0,n=!1,e=void 0;try{for(var r,o=this.content.find(".item")[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value,a=jQuery(i);a.data("item").value===this._value?a.addClass("selected"):a.removeClass("selected")}}catch(t){n=!0,e=t}finally{try{!t&&o.return&&o.return()}finally{if(n)throw e}}}},{key:"addLeaf",value:function(t,n){var e=this,r=this.options.parseItem?this.options.parseItem(t):t,o=jQuery("<div/>").addClass("item").html(s({label:r.label}));o.data("item",r),o.click(function(){var t=jQuery(this).data("item");t.value!==e.value&&e.setValue(t.value)}),n.append(o)}},{key:"addItem",value:function(t,n){if(this.options.isLeaf(t))this.addLeaf(t,n);else{var e=!0,r=!1,o=void 0;try{for(var i,a=this.options.getChildren(t)[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var u=i.value;this.addItem(u,n)}}catch(t){r=!0,o=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw o}}}}},{key:"scrollToValue",value:function(t){i.debug("FacetSelector scrollToValue",t);var n=this.content.find(".item"),e=null,r=!0,o=!1,a=void 0;try{for(var u,s=n[Symbol.iterator]();!(r=(u=s.next()).done);r=!0){var c=u.value,l=jQuery(c);if(l.data("item").value===t){e=l;break}}}catch(t){o=!0,a=t}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}e&&(console.log("SCROLL TO",e[0].outerHTML),e[0].scrollIntoView())}}]),t}();n.default=a;var u=Handlebars.compile(['<div class="title"></div>','<div class="content">',"</div>"].join("")),s=Handlebars.compile(['<a href="#">{{label}}</a>'].join(""))},function(t,n,e){(t.exports=e(3)(void 0)).push([t.i,"#joosugi_anno_explorer_dialog {\n  height: 80%;\n}\n#joosugi_anno_explorer_dialog .content {\n  height: 72%;\n}\n#joosugi_anno_explorer_dialog .content .grid {\n  height: 100%;\n}\n#joosugi_anno_explorer_dialog .column.facets {\n  height: 100%;\n  overflow-y: scroll;\n}\n#joosugi_anno_explorer_dialog .item.selected {\n  background-color: orange;\n}\n#joosugi_anno_explorer_dialog .item {\n  padding: 5px;\n  background-color: #eee;\n  border-radius: 5px;\n  margin: 2px;\n}\n#joosugi_anno_explorer_dialog .ui.accordion .content {\n  height: 120px;\n  overflow-y: scroll;\n}\n.joosugi_anno_panel {\n  height: 100%;\n  overflow-y: scroll;\n  border: solid 1px #bbb;\n  border-radius: 5px;\n  padding: 5px;\n  text-align: center;\n}\n.joosugi_anno_panel .place-holder {\n  display: inline-block;\n  vertical-align: middle;\n}\n.joosugi_anno_panel .item {\n  text-align: left;\n}\n",""])},function(t,n,e){function r(t,n){for(var e=0;e<t.length;e++){var r=t[e],o=v[r.id];if(o){o.refs++;for(a=0;a<o.parts.length;a++)o.parts[a](r.parts[a]);for(;a<r.parts.length;a++)o.parts.push(l(r.parts[a],n))}else{for(var i=[],a=0;a<r.parts.length;a++)i.push(l(r.parts[a],n));v[r.id]={id:r.id,refs:1,parts:i}}}}function o(t){for(var n=[],e={},r=0;r<t.length;r++){var o=t[r],i=o[0],a={css:o[1],media:o[2],sourceMap:o[3]};e[i]?e[i].parts.push(a):n.push(e[i]={id:i,parts:[a]})}return n}function i(t,n){var e=p(t.insertInto);if(!e)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=_[_.length-1];if("top"===t.insertAt)r?r.nextSibling?e.insertBefore(n,r.nextSibling):e.appendChild(n):e.insertBefore(n,e.firstChild),_.push(n);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");e.appendChild(n)}}function a(t){t.parentNode.removeChild(t);var n=_.indexOf(t);n>=0&&_.splice(n,1)}function u(t){var n=document.createElement("style");return t.attrs.type="text/css",c(n,t.attrs),i(t,n),n}function s(t){var n=document.createElement("link");return t.attrs.type="text/css",t.attrs.rel="stylesheet",c(n,t.attrs),i(t,n),n}function c(t,n){Object.keys(n).forEach(function(e){t.setAttribute(e,n[e])})}function l(t,n){var e,r,o;if(n.singleton){var i=m++;e=y||(y=u(n)),r=f.bind(null,e,i,!1),o=f.bind(null,e,i,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(e=s(n),r=h.bind(null,e,n),o=function(){a(e),e.href&&URL.revokeObjectURL(e.href)}):(e=u(n),r=d.bind(null,e),o=function(){a(e)});return r(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;r(t=n)}else o()}}function f(t,n,e,r){var o=e?"":r.css;if(t.styleSheet)t.styleSheet.cssText=w(n,o);else{var i=document.createTextNode(o),a=t.childNodes;a[n]&&t.removeChild(a[n]),a.length?t.insertBefore(i,a[n]):t.appendChild(i)}}function d(t,n){var e=n.css,r=n.media;if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}function h(t,n,e){var r=e.css,o=e.sourceMap,i=void 0===n.convertToAbsoluteUrls&&o;(n.convertToAbsoluteUrls||i)&&(r=b(r)),o&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var a=new Blob([r],{type:"text/css"}),u=t.href;t.href=URL.createObjectURL(a),u&&URL.revokeObjectURL(u)}var v={},g=function(t){var n;return function(){return void 0===n&&(n=t.apply(this,arguments)),n}}(function(){return window&&document&&document.all&&!window.atob}),p=function(t){var n={};return function(e){return void 0===n[e]&&(n[e]=t.call(this,e)),n[e]}}(function(t){return document.querySelector(t)}),y=null,m=0,_=[],b=e(6);t.exports=function(t,n){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(n=n||{}).attrs="object"==typeof n.attrs?n.attrs:{},void 0===n.singleton&&(n.singleton=g()),void 0===n.insertInto&&(n.insertInto="head"),void 0===n.insertAt&&(n.insertAt="bottom");var e=o(t);return r(e,n),function(t){for(var i=[],a=0;a<e.length;a++){var u=e[a];(s=v[u.id]).refs--,i.push(s)}t&&r(o(t),n);for(a=0;a<i.length;a++){var s=i[a];if(0===s.refs){for(var c=0;c<s.parts.length;c++)s.parts[c]();delete v[s.id]}}}};var w=function(){var t=[];return function(n,e){return t[n]=e,t.filter(Boolean).join("\n")}}()},function(t,n,e){var r=e(11);"string"==typeof r&&(r=[[t.i,r,""]]);e(12)(r,{});r.locals&&(t.exports=r.locals)},function(t,n,e){t.exports=e(0)}]),t.exports=joosugiUI},function(t,n){},function(t,n){var e;e=function(){return this}();try{e=e||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(e=window)}t.exports=e},function(t,n,e){e(18),e(4),t.exports=e(17)}]);
//# sourceMappingURL=yale-mirador.bundle.js.map